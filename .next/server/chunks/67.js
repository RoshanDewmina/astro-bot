exports.id=67,exports.ids=[67],exports.modules={805:(e,t,r)=>{r(6636).config(Object.assign({},r(8808),r(2019)(process.argv)))},2019:e=>{let t=/^dotenv_config_(encoding|path|debug|override|DOTENV_KEY)=(.+)$/;e.exports=function(e){return e.reduce(function(e,r){let n=r.match(t);return n&&(e[n[1]]=n[2]),e},{})}},8808:e=>{let t={};null!=process.env.DOTENV_CONFIG_ENCODING&&(t.encoding=process.env.DOTENV_CONFIG_ENCODING),null!=process.env.DOTENV_CONFIG_PATH&&(t.path=process.env.DOTENV_CONFIG_PATH),null!=process.env.DOTENV_CONFIG_DEBUG&&(t.debug=process.env.DOTENV_CONFIG_DEBUG),null!=process.env.DOTENV_CONFIG_OVERRIDE&&(t.override=process.env.DOTENV_CONFIG_OVERRIDE),null!=process.env.DOTENV_CONFIG_DOTENV_KEY&&(t.DOTENV_KEY=process.env.DOTENV_CONFIG_DOTENV_KEY),e.exports=t},6636:(e,t,r)=>{let n=r(7147),s=r(1017),i=r(2037),a=r(6113),o=r(1564).version,l=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function u(e){console.log(`[dotenv@${o}][DEBUG] ${e}`)}function c(e){return e&&e.DOTENV_KEY&&e.DOTENV_KEY.length>0?e.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function d(e){let t=null;if(e&&e.path&&e.path.length>0){if(Array.isArray(e.path))for(let r of e.path)n.existsSync(r)&&(t=r.endsWith(".vault")?r:`${r}.vault`);else t=e.path.endsWith(".vault")?e.path:`${e.path}.vault`}else t=s.resolve(process.cwd(),".env.vault");return n.existsSync(t)?t:null}function p(e){return"~"===e[0]?s.join(i.homedir(),e.slice(1)):e}let m={configDotenv:function(e){let t;let r=s.resolve(process.cwd(),".env"),i="utf8",a=!!(e&&e.debug);e&&e.encoding?i=e.encoding:a&&u("No encoding is specified. UTF-8 is used by default");let o=[r];if(e&&e.path){if(Array.isArray(e.path))for(let t of(o=[],e.path))o.push(p(t));else o=[p(e.path)]}let l={};for(let r of o)try{let t=m.parse(n.readFileSync(r,{encoding:i}));m.populate(l,t,e)}catch(e){a&&u(`Failed to load ${r} ${e.message}`),t=e}let c=process.env;return(e&&null!=e.processEnv&&(c=e.processEnv),m.populate(c,l,e),t)?{parsed:l,error:t}:{parsed:l}},_configVault:function(e){console.log(`[dotenv@${o}][INFO] Loading env from encrypted .env.vault`);let t=m._parseVault(e),r=process.env;return e&&null!=e.processEnv&&(r=e.processEnv),m.populate(r,t,e),{parsed:t}},_parseVault:function(e){let t;let r=d(e),n=m.configDotenv({path:r});if(!n.parsed){let e=Error(`MISSING_DATA: Cannot parse ${r} for an unknown reason`);throw e.code="MISSING_DATA",e}let s=c(e).split(","),i=s.length;for(let e=0;e<i;e++)try{let r=s[e].trim(),i=function(e,t){let r;try{r=new URL(t)}catch(e){if("ERR_INVALID_URL"===e.code){let e=Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw e.code="INVALID_DOTENV_KEY",e}throw e}let n=r.password;if(!n){let e=Error("INVALID_DOTENV_KEY: Missing key part");throw e.code="INVALID_DOTENV_KEY",e}let s=r.searchParams.get("environment");if(!s){let e=Error("INVALID_DOTENV_KEY: Missing environment part");throw e.code="INVALID_DOTENV_KEY",e}let i=`DOTENV_VAULT_${s.toUpperCase()}`,a=e.parsed[i];if(!a){let e=Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${i} in your .env.vault file.`);throw e.code="NOT_FOUND_DOTENV_ENVIRONMENT",e}return{ciphertext:a,key:n}}(n,r);t=m.decrypt(i.ciphertext,i.key);break}catch(t){if(e+1>=i)throw t}return m.parse(t)},config:function(e){if(0===c(e).length)return m.configDotenv(e);let t=d(e);if(!t){var r;return r=`You set DOTENV_KEY but you are missing a .env.vault file at ${t}. Did you forget to build it?`,console.log(`[dotenv@${o}][WARN] ${r}`),m.configDotenv(e)}return m._configVault(e)},decrypt:function(e,t){let r=Buffer.from(t.slice(-64),"hex"),n=Buffer.from(e,"base64"),s=n.subarray(0,12),i=n.subarray(-16);n=n.subarray(12,-16);try{let e=a.createDecipheriv("aes-256-gcm",r,s);return e.setAuthTag(i),`${e.update(n)}${e.final()}`}catch(n){let e=n instanceof RangeError,t="Invalid key length"===n.message,r="Unsupported state or unable to authenticate data"===n.message;if(e||t){let e=Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw e.code="INVALID_DOTENV_KEY",e}if(r){let e=Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw e.code="DECRYPTION_FAILED",e}throw n}},parse:function(e){let t;let r={},n=e.toString();for(n=n.replace(/\r\n?/mg,"\n");null!=(t=l.exec(n));){let e=t[1],n=t[2]||"",s=(n=n.trim())[0];n=n.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),'"'===s&&(n=(n=n.replace(/\\n/g,"\n")).replace(/\\r/g,"\r")),r[e]=n}return r},populate:function(e,t,r={}){let n=!!(r&&r.debug),s=!!(r&&r.override);if("object"!=typeof t){let e=Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw e.code="OBJECT_REQUIRED",e}for(let r of Object.keys(t))Object.prototype.hasOwnProperty.call(e,r)?(!0===s&&(e[r]=t[r]),n&&(!0===s?u(`"${r}" is already defined and WAS overwritten`):u(`"${r}" is already defined and was NOT overwritten`))):e[r]=t[r]}};e.exports.configDotenv=m.configDotenv,e.exports._configVault=m._configVault,e.exports._parseVault=m._parseVault,e.exports.config=m.config,e.exports.decrypt=m.decrypt,e.exports.parse=m.parse,e.exports.populate=m.populate,e.exports=m},618:(e,t)=>{"use strict";function r(e){for(let t=0;t<e.length;t++){let r=e[t];if("function"!=typeof r)throw Error(`A "use server" file can only export async functions, found ${typeof r}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`)}}Object.defineProperty(t,"h",{enumerable:!0,get:function(){return r}})},4330:(e,t,r)=>{"use strict";Object.defineProperty(t,"j",{enumerable:!0,get:function(){return s}});let n=r(1749);function s(e,t){return(0,n.registerServerReference)(t,e,null)}},7971:(e,t,r)=>{"use strict";var n=r(7049),s={stream:!0},i=new Map;function a(e){var t=globalThis.__next_require__(e);return"function"!=typeof t.then||"fulfilled"===t.status?null:(t.then(function(e){t.status="fulfilled",t.value=e},function(e){t.status="rejected",t.reason=e}),t)}function o(){}var l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Dispatcher,u=Symbol.for("react.element"),c=Symbol.for("react.lazy"),d=Symbol.iterator,p=Array.isArray,m=Object.getPrototypeOf,f=Object.prototype,h=new WeakMap;function g(e,t,r,n){var s=1,i=0,a=null;e=JSON.stringify(e,function e(o,l){if(null===l)return null;if("object"==typeof l){if("function"==typeof l.then){null===a&&(a=new FormData),i++;var u,c,g=s++;return l.then(function(n){n=JSON.stringify(n,e);var s=a;s.append(t+g,n),0==--i&&r(s)},function(e){n(e)}),"$@"+g.toString(16)}if(p(l))return l;if(l instanceof FormData){null===a&&(a=new FormData);var y=a,v=t+(o=s++)+"_";return l.forEach(function(e,t){y.append(v+t,e)}),"$K"+o.toString(16)}if(l instanceof Map)return l=JSON.stringify(Array.from(l),e),null===a&&(a=new FormData),o=s++,a.append(t+o,l),"$Q"+o.toString(16);if(l instanceof Set)return l=JSON.stringify(Array.from(l),e),null===a&&(a=new FormData),o=s++,a.append(t+o,l),"$W"+o.toString(16);if(null===(c=l)||"object"!=typeof c?null:"function"==typeof(c=d&&c[d]||c["@@iterator"])?c:null)return Array.from(l);if((o=m(l))!==f&&(null===o||null!==m(o)))throw Error("Only plain objects, and a few built-ins, can be passed to Server Actions. Classes or null prototypes are not supported.");return l}if("string"==typeof l)return"Z"===l[l.length-1]&&this[o]instanceof Date?"$D"+l:l="$"===l[0]?"$"+l:l;if("boolean"==typeof l)return l;if("number"==typeof l)return Number.isFinite(u=l)?0===u&&-1/0==1/u?"$-0":u:1/0===u?"$Infinity":-1/0===u?"$-Infinity":"$NaN";if(void 0===l)return"$undefined";if("function"==typeof l){if(void 0!==(l=h.get(l)))return l=JSON.stringify(l,e),null===a&&(a=new FormData),o=s++,a.set(t+o,l),"$F"+o.toString(16);throw Error("Client Functions cannot be passed directly to Server Functions. Only Functions passed from the Server can be passed back again.")}if("symbol"==typeof l){if(Symbol.for(o=l.description)!==l)throw Error("Only global symbols received from Symbol.for(...) can be passed to Server Functions. The symbol Symbol.for("+l.description+") cannot be found among global symbols.");return"$S"+o}if("bigint"==typeof l)return"$n"+l.toString(10);throw Error("Type "+typeof l+" is not supported as an argument to a Server Function.")}),null===a?r(e):(a.set(t+"0",e),0===i&&r(a))}var y=new WeakMap;function v(e){var t=h.get(this);if(!t)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var r=null;if(null!==t.bound){if((r=y.get(t))||(n=t,a=new Promise(function(e,t){s=e,i=t}),g(n,"",function(e){if("string"==typeof e){var t=new FormData;t.append("0",e),e=t}a.status="fulfilled",a.value=e,s(e)},function(e){a.status="rejected",a.reason=e,i(e)}),r=a,y.set(t,r)),"rejected"===r.status)throw r.reason;if("fulfilled"!==r.status)throw r;t=r.value;var n,s,i,a,o=new FormData;t.forEach(function(t,r){o.append("$ACTION_"+e+":"+r,t)}),r=o,t="$ACTION_REF_"+e}else t="$ACTION_ID_"+t.id;return{name:t,method:"POST",encType:"multipart/form-data",data:r}}function b(e,t){var r=h.get(this);if(!r)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");if(r.id!==e)return!1;var n=r.bound;if(null===n)return 0===t;switch(n.status){case"fulfilled":return n.value.length===t;case"pending":throw n;case"rejected":throw n.reason;default:throw"string"!=typeof n.status&&(n.status="pending",n.then(function(e){n.status="fulfilled",n.value=e},function(e){n.status="rejected",n.reason=e})),n}}function _(e,t,r){Object.defineProperties(e,{$$FORM_ACTION:{value:void 0===r?v:function(){var e=h.get(this);if(!e)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var t=e.bound;return null===t&&(t=Promise.resolve([])),r(e.id,t)}},$$IS_SIGNATURE_EQUAL:{value:b},bind:{value:x}}),h.set(e,t)}var w=Function.prototype.bind,S=Array.prototype.slice;function x(){var e=w.apply(this,arguments),t=h.get(this);if(t){var r=S.call(arguments,1),n=null;n=null!==t.bound?Promise.resolve(t.bound).then(function(e){return e.concat(r)}):Promise.resolve(r),Object.defineProperties(e,{$$FORM_ACTION:{value:this.$$FORM_ACTION},$$IS_SIGNATURE_EQUAL:{value:b},bind:{value:x}}),h.set(e,{id:t.id,bound:n})}return e}function T(e,t,r,n){this.status=e,this.value=t,this.reason=r,this._response=n}function k(e){switch(e.status){case"resolved_model":I(e);break;case"resolved_module":C(e)}switch(e.status){case"fulfilled":return e.value;case"pending":case"blocked":case"cyclic":throw e;default:throw e.reason}}function E(e,t){for(var r=0;r<e.length;r++)(0,e[r])(t)}function N(e,t,r){switch(e.status){case"fulfilled":E(t,e.value);break;case"pending":case"blocked":case"cyclic":e.value=t,e.reason=r;break;case"rejected":r&&E(r,e.reason)}}function A(e,t){if("pending"===e.status||"blocked"===e.status){var r=e.reason;e.status="rejected",e.reason=t,null!==r&&E(r,t)}}function O(e,t){if("pending"===e.status||"blocked"===e.status){var r=e.value,n=e.reason;e.status="resolved_module",e.value=t,null!==r&&(C(e),N(e,r,n))}}T.prototype=Object.create(Promise.prototype),T.prototype.then=function(e,t){switch(this.status){case"resolved_model":I(this);break;case"resolved_module":C(this)}switch(this.status){case"fulfilled":e(this.value);break;case"pending":case"blocked":case"cyclic":e&&(null===this.value&&(this.value=[]),this.value.push(e)),t&&(null===this.reason&&(this.reason=[]),this.reason.push(t));break;default:t(this.reason)}};var j=null,$=null;function I(e){var t=j,r=$;j=e,$=null;var n=e.value;e.status="cyclic",e.value=null,e.reason=null;try{var s=JSON.parse(n,e._response._fromJSON);if(null!==$&&0<$.deps)$.value=s,e.status="blocked",e.value=null,e.reason=null;else{var i=e.value;e.status="fulfilled",e.value=s,null!==i&&E(i,s)}}catch(t){e.status="rejected",e.reason=t}finally{j=t,$=r}}function C(e){try{var t=e.value,r=globalThis.__next_require__(t[0]);if(4===t.length&&"function"==typeof r.then){if("fulfilled"===r.status)r=r.value;else throw r.reason}var n="*"===t[2]?r:""===t[2]?r.__esModule?r.default:r:r[t[2]];e.status="fulfilled",e.value=n}catch(t){e.status="rejected",e.reason=t}}function P(e,t){e._chunks.forEach(function(e){"pending"===e.status&&A(e,t)})}function z(e,t){var r=e._chunks,n=r.get(t);return n||(n=new T("pending",null,null,e),r.set(t,n)),n}function D(e,t){if("resolved_model"===(e=z(e,t)).status&&I(e),"fulfilled"===e.status)return e.value;throw e.reason}function R(){throw Error('Trying to call a function from "use server" but the callServer option was not implemented in your router runtime.')}function M(){throw Error("Server Functions cannot be called during initial render. This would create a fetch waterfall. Try to use a Server Component to pass data to Client Components instead.")}function q(e){var t,r=e.ssrManifest.moduleMap;return(r={_bundlerConfig:r,_moduleLoading:e.ssrManifest.moduleLoading,_callServer:void 0!==M?M:R,_encodeFormAction:e.encodeFormAction,_nonce:e="string"==typeof e.nonce?e.nonce:void 0,_chunks:new Map,_stringDecoder:new TextDecoder,_fromJSON:null,_rowState:0,_rowID:0,_rowTag:0,_rowLength:0,_buffer:[]})._fromJSON=(t=r,function(e,r){return"string"==typeof r?function(e,t,r,n){if("$"===n[0]){if("$"===n)return u;switch(n[1]){case"$":return n.slice(1);case"L":return{$$typeof:c,_payload:e=z(e,t=parseInt(n.slice(2),16)),_init:k};case"@":if(2===n.length)return new Promise(function(){});return z(e,t=parseInt(n.slice(2),16));case"S":return Symbol.for(n.slice(2));case"F":return t=D(e,t=parseInt(n.slice(2),16)),function(e,t){function r(){var e=Array.prototype.slice.call(arguments),r=t.bound;return r?"fulfilled"===r.status?n(t.id,r.value.concat(e)):Promise.resolve(r).then(function(r){return n(t.id,r.concat(e))}):n(t.id,e)}var n=e._callServer;return _(r,t,e._encodeFormAction),r}(e,t);case"Q":return new Map(e=D(e,t=parseInt(n.slice(2),16)));case"W":return new Set(e=D(e,t=parseInt(n.slice(2),16)));case"I":return 1/0;case"-":return"$-0"===n?-0:-1/0;case"N":return NaN;case"u":return;case"D":return new Date(Date.parse(n.slice(2)));case"n":return BigInt(n.slice(2));default:switch((e=z(e,n=parseInt(n.slice(1),16))).status){case"resolved_model":I(e);break;case"resolved_module":C(e)}switch(e.status){case"fulfilled":return e.value;case"pending":case"blocked":case"cyclic":var s;return n=j,e.then(function(e,t,r,n){if($){var s=$;n||s.deps++}else s=$={deps:n?0:1,value:null};return function(n){t[r]=n,s.deps--,0===s.deps&&"blocked"===e.status&&(n=e.value,e.status="fulfilled",e.value=s.value,null!==n&&E(n,s.value))}}(n,t,r,"cyclic"===e.status),(s=n,function(e){return A(s,e)})),null;default:throw e.reason}}}return n}(t,this,e,r):"object"==typeof r&&null!==r?e=r[0]===u?{$$typeof:u,type:r[1],key:r[2],ref:null,props:r[3],_owner:null}:r:r}),r}function L(e,t){function n(t){P(e,t)}var u=t.getReader();u.read().then(function t(c){var d=c.value;if(c.done)P(e,Error("Connection closed."));else{var p=0,m=e._rowState,f=e._rowID,h=e._rowTag,g=e._rowLength;c=e._buffer;for(var y=d.length;p<y;){var v=-1;switch(m){case 0:58===(v=d[p++])?m=1:f=f<<4|(96<v?v-87:v-48);continue;case 1:84===(m=d[p])?(h=m,m=2,p++):64<m&&91>m?(h=m,m=3,p++):(h=0,m=3);continue;case 2:44===(v=d[p++])?m=4:g=g<<4|(96<v?v-87:v-48);continue;case 3:v=d.indexOf(10,p);break;case 4:(v=p+g)>d.length&&(v=-1)}var b=d.byteOffset+p;if(-1<v){p=new Uint8Array(d.buffer,b,v-p),g=e,b=h;var _=g._stringDecoder;h="";for(var w=0;w<c.length;w++)h+=_.decode(c[w],s);switch(h+=_.decode(p),b){case 73:!function(e,t,n){var s=e._chunks,u=s.get(t);n=JSON.parse(n,e._fromJSON);var c=function(e,t){if(e){var r=e[t[0]];if(e=r[t[2]])r=e.name;else{if(!(e=r["*"]))throw Error('Could not find the module "'+t[0]+'" in the React SSR Manifest. This is probably a bug in the React Server Components bundler.');r=t[2]}return 4===t.length?[e.id,e.chunks,r,1]:[e.id,e.chunks,r]}return t}(e._bundlerConfig,n);if(function(e,t,r){if(null!==e)for(var n=1;n<t.length;n+=2){var s=l.current;if(s){var i=s.preinitScript,a=e.prefix+t[n],o=e.crossOrigin;o="string"==typeof o?"use-credentials"===o?o:"":void 0,i.call(s,a,{crossOrigin:o,nonce:r})}}}(e._moduleLoading,n[1],e._nonce),n=function(e){for(var t=e[1],n=[],s=0;s<t.length;){var l=t[s++];t[s++];var u=i.get(l);if(void 0===u){u=r.e(l),n.push(u);var c=i.set.bind(i,l,null);u.then(c,o),i.set(l,u)}else null!==u&&n.push(u)}return 4===e.length?0===n.length?a(e[0]):Promise.all(n).then(function(){return a(e[0])}):0<n.length?Promise.all(n):null}(c)){if(u){var d=u;d.status="blocked"}else d=new T("blocked",null,null,e),s.set(t,d);n.then(function(){return O(d,c)},function(e){return A(d,e)})}else u?O(u,c):s.set(t,new T("resolved_module",c,null,e))}(g,f,h);break;case 72:if(f=h[0],g=JSON.parse(h=h.slice(1),g._fromJSON),h=l.current)switch(f){case"D":h.prefetchDNS(g);break;case"C":"string"==typeof g?h.preconnect(g):h.preconnect(g[0],g[1]);break;case"L":f=g[0],p=g[1],3===g.length?h.preload(f,p,g[2]):h.preload(f,p);break;case"m":"string"==typeof g?h.preloadModule(g):h.preloadModule(g[0],g[1]);break;case"S":"string"==typeof g?h.preinitStyle(g):h.preinitStyle(g[0],0===g[1]?void 0:g[1],3===g.length?g[2]:void 0);break;case"X":"string"==typeof g?h.preinitScript(g):h.preinitScript(g[0],g[1]);break;case"M":"string"==typeof g?h.preinitModuleScript(g):h.preinitModuleScript(g[0],g[1])}break;case 69:p=(h=JSON.parse(h)).digest,(h=Error("An error occurred in the Server Components render. The specific message is omitted in production builds to avoid leaking sensitive details. A digest property is included on this error instance which may provide additional details about the nature of the error.")).stack="Error: "+h.message,h.digest=p,(b=(p=g._chunks).get(f))?A(b,h):p.set(f,new T("rejected",null,h,g));break;case 84:g._chunks.set(f,new T("fulfilled",h,null,g));break;case 68:case 87:throw Error("Failed to read a RSC payload created by a development version of React on the server while using a production version on the client. Always use matching versions on the server and the client.");default:(b=(p=g._chunks).get(f))?(g=b,f=h,"pending"===g.status&&(h=g.value,p=g.reason,g.status="resolved_model",g.value=f,null!==h&&(I(g),N(g,h,p)))):p.set(f,new T("resolved_model",h,null,g))}p=v,3===m&&p++,g=f=h=m=0,c.length=0}else{d=new Uint8Array(d.buffer,b,d.byteLength-p),c.push(d),g-=d.byteLength;break}}return e._rowState=m,e._rowID=f,e._rowTag=h,e._rowLength=g,u.read().then(t).catch(n)}}).catch(n)}t.createFromFetch=function(e,t){var r=q(t);return e.then(function(e){L(r,e.body)},function(e){P(r,e)}),z(r,0)},t.createFromReadableStream=function(e,t){return L(t=q(t),e),z(t,0)},t.createServerReference=function(e){return function(e,t,r){function n(){var r=Array.prototype.slice.call(arguments);return t(e,r)}return _(n,{id:e,bound:null},r),n}(e,M)},t.encodeReply=function(e){return new Promise(function(t,r){g(e,"",t,r)})}},561:(e,t,r)=>{"use strict";e.exports=r(7971)},8769:()=>{},4672:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DetachedPromise",{enumerable:!0,get:function(){return r}});class r{constructor(){let e,t;this.promise=new Promise((r,n)=>{e=r,t=n}),this.resolve=e,this.reject=t}}},1890:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{atLeastOneTask:function(){return s},scheduleImmediate:function(){return n},scheduleOnNextTick:function(){return r}});let r=e=>{Promise.resolve().then(()=>{process.nextTick(e)})},n=e=>{setImmediate(e)};function s(){return new Promise(e=>n(e))}},9702:(e,t)=>{"use strict";let r,n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{arrayBufferToString:function(){return i},decrypt:function(){return l},encrypt:function(){return o},generateEncryptionKeyBase64:function(){return u},getActionEncryptionKey:function(){return f},getClientReferenceManifestSingleton:function(){return m},getServerModuleMap:function(){return p},setReferenceManifestsSingleton:function(){return d},stringToUint8Array:function(){return a}});let s=null;function i(e){let t=new Uint8Array(e),r=t.byteLength;if(r<65535)return String.fromCharCode.apply(null,t);let n="";for(let e=0;e<r;e++)n+=String.fromCharCode(t[e]);return n}function a(e){let t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r}function o(e,t,r){return crypto.subtle.encrypt({name:"AES-GCM",iv:t},e,r)}function l(e,t,r){return crypto.subtle.decrypt({name:"AES-GCM",iv:t},e,r)}async function u(e){if(e&&void 0!==n)return n;s||(s=new Promise(async(e,t)=>{try{let t=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),r=await crypto.subtle.exportKey("raw",t),n=btoa(i(r));e([t,n])}catch(e){t(e)}}));let[t,a]=await s;return r=t,e&&(n=a),a}let c=Symbol.for("next.server.action-manifests");function d({clientReferenceManifest:e,serverActionsManifest:t,serverModuleMap:r}){globalThis[c]={clientReferenceManifest:e,serverActionsManifest:t,serverModuleMap:r}}function p(){let e=globalThis[c];if(!e)throw Error("Missing manifest for Server Actions. This is a bug in Next.js");return e.serverModuleMap}function m(){let e=globalThis[c];if(!e)throw Error("Missing manifest for Server Actions. This is a bug in Next.js");return e.clientReferenceManifest}async function f(){if(r)return r;let e=globalThis[c];if(!e)throw Error("Missing manifest for Server Actions. This is a bug in Next.js");let t=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||e.serverActionsManifest.encryptionKey;if(void 0===t)throw Error("Missing encryption key for Server Actions");return r=await crypto.subtle.importKey("raw",a(atob(t)),"AES-GCM",!0,["encrypt","decrypt"])}},166:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{decryptActionBoundArgs:function(){return p},encryptActionBoundArgs:function(){return d}}),r(8769);let n=r(1749),s=r(561),i=r(8175),a=r(9702),o=new TextEncoder,l=new TextDecoder;async function u(e,t){let r=await (0,a.getActionEncryptionKey)();if(void 0===r)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=atob(t),s=n.slice(0,16),i=n.slice(16),o=l.decode(await (0,a.decrypt)(r,(0,a.stringToUint8Array)(s),(0,a.stringToUint8Array)(i)));if(!o.startsWith(e))throw Error("Invalid Server Action payload: failed to decrypt.");return o.slice(e.length)}async function c(e,t){let r=await (0,a.getActionEncryptionKey)();if(void 0===r)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=new Uint8Array(16);crypto.getRandomValues(n);let s=(0,a.arrayBufferToString)(n.buffer),i=await (0,a.encrypt)(r,n,o.encode(e+t));return btoa(s+(0,a.arrayBufferToString)(i))}async function d(e,t){let r=(0,a.getClientReferenceManifestSingleton)(),s=await (0,i.streamToString)((0,n.renderToReadableStream)(t,r.clientModules));return await c(e,s)}async function p(e,t){let r=await u(e,await t),i=await (0,s.createFromReadableStream)(new ReadableStream({start(e){e.enqueue(o.encode(r)),e.close()}}),{ssrManifest:{moduleLoading:{},moduleMap:{}}}),l=(0,a.getServerModuleMap)();return await (0,n.decodeReply)(await (0,s.encodeReply)(i),l)}},7049:(e,t,r)=>{"use strict";e.exports=r(3191).vendored["react-rsc"].ReactDOM},1749:(e,t,r)=>{"use strict";e.exports=r(3191).vendored["react-rsc"].ReactServerDOMWebpackServerEdge},9303:(e,t,r)=>{"use strict";e.exports=r(517)},3502:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ENCODED_TAGS",{enumerable:!0,get:function(){return r}});let r={OPENING:{HTML:new Uint8Array([60,104,116,109,108]),BODY:new Uint8Array([60,98,111,100,121])},CLOSED:{HEAD:new Uint8Array([60,47,104,101,97,100,62]),BODY:new Uint8Array([60,47,98,111,100,121,62]),HTML:new Uint8Array([60,47,104,116,109,108,62]),BODY_AND_HTML:new Uint8Array([60,47,98,111,100,121,62,60,47,104,116,109,108,62])}}},8175:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{chainStreams:function(){return d},continueDynamicDataResume:function(){return T},continueDynamicHTMLResume:function(){return x},continueDynamicPrerender:function(){return w},continueFizzStream:function(){return _},continueStaticPrerender:function(){return S},createBufferedTransformStream:function(){return f},createRootLayoutValidatorStream:function(){return b},renderToInitialFizzStream:function(){return h},streamFromString:function(){return p},streamToString:function(){return m}});let n=r(4994),s=r(1376),i=r(4672),a=r(1890),o=r(3502),l=r(5893);function u(){}let c=new TextEncoder;function d(...e){if(0===e.length)throw Error("Invariant: chainStreams requires at least one stream");if(1===e.length)return e[0];let{readable:t,writable:r}=new TransformStream,n=e[0].pipeTo(r,{preventClose:!0}),s=1;for(;s<e.length-1;s++){let t=e[s];n=n.then(()=>t.pipeTo(r,{preventClose:!0}))}let i=e[s];return(n=n.then(()=>i.pipeTo(r))).catch(u),t}function p(e){return new ReadableStream({start(t){t.enqueue(c.encode(e)),t.close()}})}async function m(e){let t=new TextDecoder("utf-8",{fatal:!0}),r="";for await(let n of e)r+=t.decode(n,{stream:!0});return r+t.decode()}function f(){let e,t=[],r=0,n=n=>{if(e)return;let s=new i.DetachedPromise;e=s,(0,a.scheduleImmediate)(()=>{try{let e=new Uint8Array(r),s=0;for(let r=0;r<t.length;r++){let n=t[r];e.set(n,s),s+=n.byteLength}t.length=0,r=0,n.enqueue(e)}catch{}finally{e=void 0,s.resolve()}})};return new TransformStream({transform(e,s){t.push(e),r+=e.byteLength,n(s)},flush(){if(e)return e.promise}})}function h({ReactDOMServer:e,element:t,streamOptions:r}){return(0,n.getTracer)().trace(s.AppRenderSpan.renderToReadableStream,async()=>e.renderToReadableStream(t,r))}function g(e){let t=!1,r=!1,n=!1;return new TransformStream({async transform(s,i){if(n=!0,r){i.enqueue(s);return}let u=await e();if(t){if(u){let e=c.encode(u);i.enqueue(e)}i.enqueue(s),r=!0}else{let e=(0,l.indexOfUint8Array)(s,o.ENCODED_TAGS.CLOSED.HEAD);if(-1!==e){if(u){let t=c.encode(u),r=new Uint8Array(s.length+t.length);r.set(s.slice(0,e)),r.set(t,e),r.set(s.slice(e),e+t.length),i.enqueue(r)}else i.enqueue(s);r=!0,t=!0}}t?(0,a.scheduleImmediate)(()=>{r=!1}):i.enqueue(s)},async flush(t){if(n){let r=await e();r&&t.enqueue(c.encode(r))}}})}function y(e){let t=null,r=!1;async function n(n){if(t)return;let s=e.getReader();await (0,a.atLeastOneTask)();try{for(;;){let{done:e,value:t}=await s.read();if(e){r=!0;return}n.enqueue(t)}}catch(e){n.error(e)}}return new TransformStream({transform(e,r){r.enqueue(e),t||(t=n(r))},flush(e){if(!r)return t||n(e)}})}function v(e){let t=!1,r=c.encode(e);return new TransformStream({transform(n,s){if(t)return s.enqueue(n);let i=(0,l.indexOfUint8Array)(n,r);if(i>-1){if(t=!0,n.length===e.length)return;let r=n.slice(0,i);if(s.enqueue(r),n.length>e.length+i){let t=n.slice(i+e.length);s.enqueue(t)}}else s.enqueue(n)},flush(e){e.enqueue(r)}})}function b(){let e=!1,t=!1;return new TransformStream({async transform(r,n){!e&&(0,l.indexOfUint8Array)(r,o.ENCODED_TAGS.OPENING.HTML)>-1&&(e=!0),!t&&(0,l.indexOfUint8Array)(r,o.ENCODED_TAGS.OPENING.BODY)>-1&&(t=!0),n.enqueue(r)},flush(r){let n=[];e||n.push("html"),t||n.push("body"),n.length&&r.enqueue(c.encode(`<script>self.__next_root_layout_missing_tags=${JSON.stringify(n)}</script>`))}})}async function _(e,{suffix:t,inlinedDataStream:r,isStaticGeneration:n,getServerInsertedHTML:s,serverInsertedHTMLToHead:o,validateRootLayout:l}){let u="</body></html>",d=t?t.split(u,1)[0]:null;return n&&"allReady"in e&&await e.allReady,function(e,t){let r=e;for(let e of t)e&&(r=r.pipeThrough(e));return r}(e,[f(),s&&!o?new TransformStream({transform:async(e,t)=>{let r=await s();r&&t.enqueue(c.encode(r)),t.enqueue(e)}}):null,null!=d&&d.length>0?function(e){let t,r=!1,n=r=>{let n=new i.DetachedPromise;t=n,(0,a.scheduleImmediate)(()=>{try{r.enqueue(c.encode(e))}catch{}finally{t=void 0,n.resolve()}})};return new TransformStream({transform(e,t){t.enqueue(e),r||(r=!0,n(t))},flush(n){if(t)return t.promise;r||n.enqueue(c.encode(e))}})}(d):null,r?y(r):null,l?b():null,v(u),s&&o?g(s):null])}async function w(e,{getServerInsertedHTML:t}){return e.pipeThrough(f()).pipeThrough(new TransformStream({transform(e,t){(0,l.isEquivalentUint8Arrays)(e,o.ENCODED_TAGS.CLOSED.BODY_AND_HTML)||(0,l.isEquivalentUint8Arrays)(e,o.ENCODED_TAGS.CLOSED.BODY)||(0,l.isEquivalentUint8Arrays)(e,o.ENCODED_TAGS.CLOSED.HTML)||(e=(0,l.removeFromUint8Array)(e,o.ENCODED_TAGS.CLOSED.BODY),e=(0,l.removeFromUint8Array)(e,o.ENCODED_TAGS.CLOSED.HTML),t.enqueue(e))}})).pipeThrough(g(t))}async function S(e,{inlinedDataStream:t,getServerInsertedHTML:r}){return e.pipeThrough(f()).pipeThrough(g(r)).pipeThrough(y(t)).pipeThrough(v("</body></html>"))}async function x(e,{inlinedDataStream:t,getServerInsertedHTML:r}){return e.pipeThrough(f()).pipeThrough(g(r)).pipeThrough(y(t)).pipeThrough(v("</body></html>"))}async function T(e,{inlinedDataStream:t}){return e.pipeThrough(y(t)).pipeThrough(v("</body></html>"))}},5893:(e,t)=>{"use strict";function r(e,t){if(0===t.length)return 0;if(0===e.length||t.length>e.length)return -1;for(let r=0;r<=e.length-t.length;r++){let n=!0;for(let s=0;s<t.length;s++)if(e[r+s]!==t[s]){n=!1;break}if(n)return r}return -1}function n(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function s(e,t){let n=r(e,t);if(0===n)return e.subarray(t.length);if(!(n>-1))return e;{let r=new Uint8Array(e.length-t.length);return r.set(e.slice(0,n)),r.set(e.slice(n+t.length),n),r}}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{indexOfUint8Array:function(){return r},isEquivalentUint8Arrays:function(){return n},removeFromUint8Array:function(){return s}})},5762:e=>{"use strict";let t="undefined"!=typeof Buffer,r=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function s(e,s,a){null==a&&null!==s&&"object"==typeof s&&(a=s,s=void 0),t&&Buffer.isBuffer(e)&&(e=e.toString()),e&&65279===e.charCodeAt(0)&&(e=e.slice(1));let o=JSON.parse(e,s);if(null===o||"object"!=typeof o)return o;let l=a&&a.protoAction||"error",u=a&&a.constructorAction||"error";if("ignore"===l&&"ignore"===u)return o;if("ignore"!==l&&"ignore"!==u){if(!1===r.test(e)&&!1===n.test(e))return o}else if("ignore"!==l&&"ignore"===u){if(!1===r.test(e))return o}else if(!1===n.test(e))return o;return i(o,{protoAction:l,constructorAction:u,safe:a&&a.safe})}function i(e,{protoAction:t="error",constructorAction:r="error",safe:n}={}){let s=[e];for(;s.length;){let e=s;for(let i of(s=[],e)){if("ignore"!==t&&Object.prototype.hasOwnProperty.call(i,"__proto__")){if(!0===n)return null;if("error"===t)throw SyntaxError("Object contains forbidden prototype property");delete i.__proto__}if("ignore"!==r&&Object.prototype.hasOwnProperty.call(i,"constructor")&&Object.prototype.hasOwnProperty.call(i.constructor,"prototype")){if(!0===n)return null;if("error"===r)throw SyntaxError("Object contains forbidden prototype property");delete i.constructor}for(let e in i){let t=i[e];t&&"object"==typeof t&&s.push(t)}}}return e}function a(e,t,r){let n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return s(e,t,r)}finally{Error.stackTraceLimit=n}}e.exports=a,e.exports.default=a,e.exports.parse=a,e.exports.safeParse=function(e,t){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return s(e,t,{safe:!0})}catch(e){return null}finally{Error.stackTraceLimit=r}},e.exports.scan=i},143:(e,t,r)=>{"use strict";r.d(t,{fr:()=>Q});var n=class extends Error{constructor({prompt:e,message:t}){super(`Invalid prompt: ${t}`),this.name="AI_InvalidPromptError",this.prompt=e}static isInvalidPromptError(e){return e instanceof Error&&"AI_InvalidPromptError"===e.name&&null!=prompt}toJSON(){return{name:this.name,message:this.message,stack:this.stack,prompt:this.prompt}}},s=class extends Error{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super(t),this.name="AI_InvalidResponseDataError",this.data=e}static isInvalidResponseDataError(e){return e instanceof Error&&"AI_InvalidResponseDataError"===e.name&&null!=e.data}toJSON(){return{name:this.name,message:this.message,stack:this.stack,data:this.data}}},i=class extends Error{constructor(e){super(`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`),this.name="AI_TooManyEmbeddingValuesForCallError",this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInvalidPromptError(e){return e instanceof Error&&"AI_TooManyEmbeddingValuesForCallError"===e.name&&"provider"in e&&"string"==typeof e.provider&&"modelId"in e&&"string"==typeof e.modelId&&"maxEmbeddingsPerCall"in e&&"number"==typeof e.maxEmbeddingsPerCall&&"values"in e&&Array.isArray(e.values)}toJSON(){return{name:this.name,message:this.message,stack:this.stack,provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:this.values}}},a=class extends Error{constructor({functionality:e}){super(`'${e}' functionality not supported.`),this.name="AI_UnsupportedFunctionalityError",this.functionality=e}static isUnsupportedFunctionalityError(e){return e instanceof Error&&"AI_UnsupportedFunctionalityError"===e.name&&"string"==typeof e.functionality}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}},o=class extends Error{constructor({message:e,url:t,requestBodyValues:r,statusCode:n,responseHeaders:s,responseBody:i,cause:a,isRetryable:o=null!=n&&(408===n||409===n||429===n||n>=500),data:l}){super(e),this.name="AI_APICallError",this.url=t,this.requestBodyValues=r,this.statusCode=n,this.responseHeaders=s,this.responseBody=i,this.cause=a,this.isRetryable=o,this.data=l}static isAPICallError(e){return e instanceof Error&&"AI_APICallError"===e.name&&"string"==typeof e.url&&"object"==typeof e.requestBodyValues&&(null==e.statusCode||"number"==typeof e.statusCode)&&(null==e.responseHeaders||"object"==typeof e.responseHeaders)&&(null==e.responseBody||"string"==typeof e.responseBody)&&(null==e.cause||"object"==typeof e.cause)&&"boolean"==typeof e.isRetryable&&(null==e.data||"object"==typeof e.data)}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}},l=class extends Error{constructor({message:e="Empty response body"}={}){super(e),this.name="AI_EmptyResponseBodyError"}static isEmptyResponseBodyError(e){return e instanceof Error&&"AI_EmptyResponseBodyError"===e.name}toJSON(){return{name:this.name,message:this.message,stack:this.stack}}};function u(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}var c=class extends Error{constructor({text:e,cause:t}){super(`JSON parsing failed: Text: ${e}.
Error message: ${u(t)}`),this.name="AI_JSONParseError",this.cause=t,this.text=e}static isJSONParseError(e){return e instanceof Error&&"AI_JSONParseError"===e.name&&"string"==typeof e.text&&"string"==typeof e.cause}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}},d=class extends Error{constructor({message:e}){super(e),this.name="AI_LoadAPIKeyError"}static isLoadAPIKeyError(e){return e instanceof Error&&"AI_LoadAPIKeyError"===e.name}toJSON(){return{name:this.name,message:this.message}}},p=class extends Error{constructor({value:e,cause:t}){super(`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${u(t)}`),this.name="AI_TypeValidationError",this.cause=t,this.value=e}static isTypeValidationError(e){return e instanceof Error&&"AI_TypeValidationError"===e.name}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}},m=r(5762);let f=[239,187,191];class h extends TransformStream{constructor(){let e;super({start(t){e=function(e){let t,r,n,s,i,a,o;return l(),{feed:function(l){var u;r=r?r+l:l,t&&(u=r,f.every((e,t)=>u.charCodeAt(t)===e))&&(r=r.slice(f.length)),t=!1;let c=r.length,d=0,p=!1;for(;d<c;){let t;p&&("\n"===r[d]&&++d,p=!1);let l=-1,u=s;for(let e=n;l<0&&e<c;++e)":"===(t=r[e])&&u<0?u=e-d:"\r"===t?(p=!0,l=e-d):"\n"===t&&(l=e-d);if(l<0){n=c-d,s=u;break}n=0,s=-1,function(t,r,n,s){if(0===s){o.length>0&&(e({type:"event",id:i,event:a||void 0,data:o.slice(0,-1)}),o="",i=void 0),a=void 0;return}let l=n<0,u=t.slice(r,r+(l?s:n)),c=0;c=l?s:" "===t[r+n+1]?n+2:n+1;let d=r+c,p=s-c,m=t.slice(d,d+p).toString();if("data"===u)o+=m?"".concat(m,"\n"):"\n";else if("event"===u)a=m;else if("id"!==u||m.includes("\0")){if("retry"===u){let t=parseInt(m,10);Number.isNaN(t)||e({type:"reconnect-interval",value:t})}}else i=m}(r,d,u,l),d+=l+1}d===c?r="":d>0&&(r=r.slice(d))},reset:l};function l(){t=!0,r="",n=0,s=-1,i=void 0,a=void 0,o=""}}(e=>{"event"===e.type&&t.enqueue(e)})},transform(t){e.feed(t)}})}}function g(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}function y(e){let t={};return e.headers.forEach((e,r)=>{t[r]=e}),t}var v=((e,t=21)=>(r=t)=>{let n="",s=r;for(;s--;)n+=e[Math.random()*e.length|0];return n})("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",7);function b(e){return e instanceof DOMException&&("AbortError"===e.name||"TimeoutError"===e.name)}function _({text:e,schema:t}){try{let r=m.parse(e);if(null==t)return{success:!0,value:r};return function({value:e,schema:t}){try{let r=t.safeParse(e);if(r.success)return{success:!0,value:r.data};return{success:!1,error:new p({value:e,cause:r.error})}}catch(t){return{success:!1,error:p.isTypeValidationError(t)?t:new p({value:e,cause:t})}}}({value:r,schema:t})}catch(t){return{success:!1,error:c.isJSONParseError(t)?t:new c({text:e,cause:t})}}}function w(e){try{return m.parse(e),!0}catch(e){return!1}}var S=()=>fetch,x=async({url:e,headers:t,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:a})=>T({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:a}),T=async({url:e,headers:t={},body:r,successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:a=S()})=>{try{let l=await a(e,{method:"POST",headers:Object.fromEntries(Object.entries(t).filter(([e,t])=>null!=t)),body:r.content,signal:i}),u=y(l);if(!l.ok){let t;try{t=await s({response:l,url:e,requestBodyValues:r.values})}catch(t){if(b(t)||o.isAPICallError(t))throw t;throw new o({message:"Failed to process error response",cause:t,statusCode:l.status,url:e,responseHeaders:u,requestBodyValues:r.values})}throw t.value}try{return await n({response:l,url:e,requestBodyValues:r.values})}catch(t){if(t instanceof Error&&(b(t)||o.isAPICallError(t)))throw t;throw new o({message:"Failed to process successful response",cause:t,statusCode:l.status,url:e,responseHeaders:u,requestBodyValues:r.values})}}catch(t){if(b(t))throw t;if(t instanceof TypeError&&"fetch failed"===t.message){let n=t.cause;if(null!=n)throw new o({message:`Cannot connect to API: ${n.message}`,cause:n,url:e,requestBodyValues:r.values,isRetryable:!0})}throw t}},k=e=>async({response:t})=>{let r=y(t);if(null==t.body)throw new l({});return{responseHeaders:r,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new h).pipeThrough(new TransformStream({transform({data:t},r){"[DONE]"!==t&&r.enqueue(_({text:t,schema:e}))}}))}},E=e=>async({response:t,url:r,requestBodyValues:n})=>{let s=await t.text(),i=_({text:s,schema:e}),a=y(t);if(!i.success)throw new o({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:a,responseBody:s,url:r,requestBodyValues:n});return{responseHeaders:a,value:i.value}},N=r(7410);function A(e){var t,r;return null!=(r=null==(t=null==e?void 0:e.content)?void 0:t.map(({token:e,logprob:t,top_logprobs:r})=>({token:e,logprob:t,topLogprobs:r?r.map(({token:e,logprob:t})=>({token:e,logprob:t})):[]})))?r:void 0}function O(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var j=N.z.object({error:N.z.object({message:N.z.string(),type:N.z.string(),param:N.z.any().nullable(),code:N.z.string().nullable()})}),$=(({errorSchema:e,errorToMessage:t,isRetryable:r})=>async({response:n,url:s,requestBodyValues:i})=>{let a=await n.text(),l=y(n);if(""===a.trim())return{responseHeaders:l,value:new o({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:l,responseBody:a,isRetryable:null==r?void 0:r(n)})};try{let u=function({text:e,schema:t}){try{let r=m.parse(e);if(null==t)return r;return function({value:e,schema:t}){try{return t.parse(e)}catch(t){throw new p({value:e,cause:t})}}({value:r,schema:t})}catch(t){if(c.isJSONParseError(t)||p.isTypeValidationError(t))throw t;throw new c({text:e,cause:t})}}({text:a,schema:e});return{responseHeaders:l,value:new o({message:t(u),url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:l,responseBody:a,data:u,isRetryable:null==r?void 0:r(n,u)})}}catch(e){return{responseHeaders:l,value:new o({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:l,responseBody:a,isRetryable:null==r?void 0:r(n)})}}})({errorSchema:j,errorToMessage:e=>e.error.message}),I=class{constructor(e,t,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=r}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:r,temperature:n,topP:s,frequencyPenalty:i,presencePenalty:o,seed:l}){let u=e.type,c={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:!0===this.settings.logprobs||"number"==typeof this.settings.logprobs||void 0,top_logprobs:"number"==typeof this.settings.logprobs?this.settings.logprobs:"boolean"==typeof this.settings.logprobs&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:r,temperature:n,top_p:s,frequency_penalty:i,presence_penalty:o,seed:l,messages:function(e){let t=[];for(let{role:r,content:n}of e)switch(r){case"system":t.push({role:"system",content:n});break;case"user":if(1===n.length&&"text"===n[0].type){t.push({role:"user",content:n[0].text});break}t.push({role:"user",content:n.map(e=>{var t;switch(e.type){case"text":return{type:"text",text:e.text};case"image":return{type:"image_url",image_url:{url:e.image instanceof URL?e.image.toString():`data:${null!=(t=e.mimeType)?t:"image/jpeg"};base64,${function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return globalThis.btoa(t)}(e.image)}`}}}})});break;case"assistant":{let e="",r=[];for(let t of n)switch(t.type){case"text":e+=t.text;break;case"tool-call":r.push({id:t.toolCallId,type:"function",function:{name:t.toolName,arguments:JSON.stringify(t.args)}});break;default:throw Error(`Unsupported part: ${t}`)}t.push({role:"assistant",content:e,tool_calls:r.length>0?r:void 0});break}case"tool":for(let e of n)t.push({role:"tool",tool_call_id:e.toolCallId,content:JSON.stringify(e.result)});break;default:throw Error(`Unsupported role: ${r}`)}return t}(t)};switch(u){case"regular":return{...c,...function(e){var t;let r=(null==(t=e.tools)?void 0:t.length)?e.tools:void 0;if(null==r)return{tools:void 0,tool_choice:void 0};let n=r.map(e=>({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters}})),s=e.toolChoice;if(null==s)return{tools:n,tool_choice:void 0};let i=s.type;switch(i){case"auto":case"none":case"required":return{tools:n,tool_choice:i};case"tool":return{tools:n,tool_choice:{type:"function",function:{name:s.toolName}}};default:throw Error(`Unsupported tool choice type: ${i}`)}}(e)};case"object-json":return{...c,response_format:{type:"json_object"}};case"object-tool":return{...c,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]};case"object-grammar":throw new a({functionality:"object-grammar mode"});default:throw Error(`Unsupported type: ${u}`)}}async doGenerate(e){var t,r;let n=this.getArgs(e),{responseHeaders:s,value:i}=await x({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:g(this.config.headers(),e.headers),body:n,failedResponseHandler:$,successfulResponseHandler:E(C),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=n,l=i.choices[0];return{text:null!=(t=l.message.content)?t:void 0,toolCalls:null==(r=l.message.tool_calls)?void 0:r.map(e=>{var t;return{toolCallType:"function",toolCallId:null!=(t=e.id)?t:v(),toolName:e.function.name,args:e.function.arguments}}),finishReason:O(l.finish_reason),usage:{promptTokens:i.usage.prompt_tokens,completionTokens:i.usage.completion_tokens},rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:[],logprobs:A(l.logprobs)}}async doStream(e){let t;let r=this.getArgs(e),{responseHeaders:n,value:i}=await x({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:g(this.config.headers(),e.headers),body:{...r,stream:!0,stream_options:"strict"===this.config.compatibility?{include_usage:!0}:void 0},failedResponseHandler:$,successfulResponseHandler:k(P),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=r,l=[],u="other",c={promptTokens:Number.NaN,completionTokens:Number.NaN};return{stream:i.pipeThrough(new TransformStream({transform(e,r){var n,i,a,o,d,p,m,f,h,g,y,b;if(!e.success){u="error",r.enqueue({type:"error",error:e.error});return}let _=e.value;if("error"in _){u="error",r.enqueue({type:"error",error:_.error});return}null!=_.usage&&(c={promptTokens:_.usage.prompt_tokens,completionTokens:_.usage.completion_tokens});let S=_.choices[0];if((null==S?void 0:S.finish_reason)!=null&&(u=O(S.finish_reason)),(null==S?void 0:S.delta)==null)return;let x=S.delta;null!=x.content&&r.enqueue({type:"text-delta",textDelta:x.content});let T=A(null==S?void 0:S.logprobs);if((null==T?void 0:T.length)&&(void 0===t&&(t=[]),t.push(...T)),null!=x.tool_calls)for(let e of x.tool_calls){let t=e.index;if(null==l[t]){if("function"!==e.type)throw new s({data:e,message:"Expected 'function' type."});if(null==e.id)throw new s({data:e,message:"Expected 'id' to be a string."});if((null==(n=e.function)?void 0:n.name)==null)throw new s({data:e,message:"Expected 'function.name' to be a string."});l[t]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(i=e.function.arguments)?i:""}};let u=l[t];(null==(a=u.function)?void 0:a.name)!=null&&(null==(o=u.function)?void 0:o.arguments)!=null&&w(u.function.arguments)&&(r.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:u.id,toolName:u.function.name,argsTextDelta:u.function.arguments}),r.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(d=u.id)?d:v(),toolName:u.function.name,args:u.function.arguments}));continue}let u=l[t];(null==(p=e.function)?void 0:p.arguments)!=null&&(u.function.arguments+=null!=(f=null==(m=e.function)?void 0:m.arguments)?f:""),r.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:u.id,toolName:u.function.name,argsTextDelta:null!=(h=e.function.arguments)?h:""}),(null==(g=u.function)?void 0:g.name)!=null&&(null==(y=u.function)?void 0:y.arguments)!=null&&w(u.function.arguments)&&r.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(b=u.id)?b:v(),toolName:u.function.name,args:u.function.arguments})}},flush(e){e.enqueue({type:"finish",finishReason:u,logprobs:t,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:n},warnings:[]}}},C=N.z.object({choices:N.z.array(N.z.object({message:N.z.object({role:N.z.literal("assistant"),content:N.z.string().nullable().optional(),tool_calls:N.z.array(N.z.object({id:N.z.string().optional().nullable(),type:N.z.literal("function"),function:N.z.object({name:N.z.string(),arguments:N.z.string()})})).optional()}),index:N.z.number(),logprobs:N.z.object({content:N.z.array(N.z.object({token:N.z.string(),logprob:N.z.number(),top_logprobs:N.z.array(N.z.object({token:N.z.string(),logprob:N.z.number()}))})).nullable()}).nullable().optional(),finish_reason:N.z.string().optional().nullable()})),usage:N.z.object({prompt_tokens:N.z.number(),completion_tokens:N.z.number()})}),P=N.z.union([N.z.object({choices:N.z.array(N.z.object({delta:N.z.object({role:N.z.enum(["assistant"]).optional(),content:N.z.string().nullish(),tool_calls:N.z.array(N.z.object({index:N.z.number(),id:N.z.string().nullish(),type:N.z.literal("function").optional(),function:N.z.object({name:N.z.string().nullish(),arguments:N.z.string().nullish()})})).nullish()}).nullish(),logprobs:N.z.object({content:N.z.array(N.z.object({token:N.z.string(),logprob:N.z.number(),top_logprobs:N.z.array(N.z.object({token:N.z.string(),logprob:N.z.number()}))})).nullable()}).nullish(),finish_reason:N.z.string().nullable().optional(),index:N.z.number()})),usage:N.z.object({prompt_tokens:N.z.number(),completion_tokens:N.z.number()}).nullish()}),j]);function z(e){return null==e?void 0:e.tokens.map((t,r)=>({token:t,logprob:e.token_logprobs[r],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[r]).map(([e,t])=>({token:e,logprob:t})):[]}))}var D=class{constructor(e,t,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=r}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:r,maxTokens:s,temperature:i,topP:o,frequencyPenalty:l,presencePenalty:u,seed:c}){var d;let p=e.type,{prompt:m,stopSequences:f}=function({prompt:e,inputFormat:t,user:r="user",assistant:s="assistant"}){if("prompt"===t&&1===e.length&&"user"===e[0].role&&1===e[0].content.length&&"text"===e[0].content[0].type)return{prompt:e[0].content[0].text};let i="";for(let{role:t,content:o}of("system"===e[0].role&&(i+=`${e[0].content}

`,e=e.slice(1)),e))switch(t){case"system":throw new n({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{let e=o.map(e=>{switch(e.type){case"text":return e.text;case"image":throw new a({functionality:"images"})}}).join("");i+=`${r}:
${e}

`;break}case"assistant":{let e=o.map(e=>{switch(e.type){case"text":return e.text;case"tool-call":throw new a({functionality:"tool-call messages"})}}).join("");i+=`${s}:
${e}

`;break}case"tool":throw new a({functionality:"tool messages"});default:throw Error(`Unsupported role: ${t}`)}return{prompt:i+=`${s}:
`,stopSequences:[`
${r}:`]}}({prompt:r,inputFormat:t}),h={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:"number"==typeof this.settings.logprobs?this.settings.logprobs:"boolean"==typeof this.settings.logprobs&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:s,temperature:i,top_p:o,frequency_penalty:l,presence_penalty:u,seed:c,prompt:m,stop:f};switch(p){case"regular":if(null==(d=e.tools)?void 0:d.length)throw new a({functionality:"tools"});if(e.toolChoice)throw new a({functionality:"toolChoice"});return h;case"object-json":throw new a({functionality:"object-json mode"});case"object-tool":throw new a({functionality:"object-tool mode"});case"object-grammar":throw new a({functionality:"object-grammar mode"});default:throw Error(`Unsupported type: ${p}`)}}async doGenerate(e){let t=this.getArgs(e),{responseHeaders:r,value:n}=await x({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:g(this.config.headers(),e.headers),body:t,failedResponseHandler:$,successfulResponseHandler:E(R),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:s,...i}=t,a=n.choices[0];return{text:a.text,usage:{promptTokens:n.usage.prompt_tokens,completionTokens:n.usage.completion_tokens},finishReason:O(a.finish_reason),logprobs:z(a.logprobs),rawCall:{rawPrompt:s,rawSettings:i},rawResponse:{headers:r},warnings:[]}}async doStream(e){let t;let r=this.getArgs(e),{responseHeaders:n,value:s}=await x({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:g(this.config.headers(),e.headers),body:{...this.getArgs(e),stream:!0,stream_options:"strict"===this.config.compatibility?{include_usage:!0}:void 0},failedResponseHandler:$,successfulResponseHandler:k(M),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:i,...a}=r,o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN};return{stream:s.pipeThrough(new TransformStream({transform(e,r){if(!e.success){o="error",r.enqueue({type:"error",error:e.error});return}let n=e.value;if("error"in n){o="error",r.enqueue({type:"error",error:n.error});return}null!=n.usage&&(l={promptTokens:n.usage.prompt_tokens,completionTokens:n.usage.completion_tokens});let s=n.choices[0];(null==s?void 0:s.finish_reason)!=null&&(o=O(s.finish_reason)),(null==s?void 0:s.text)!=null&&r.enqueue({type:"text-delta",textDelta:s.text});let i=z(null==s?void 0:s.logprobs);(null==i?void 0:i.length)&&(void 0===t&&(t=[]),t.push(...i))},flush(e){e.enqueue({type:"finish",finishReason:o,logprobs:t,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},R=N.z.object({choices:N.z.array(N.z.object({text:N.z.string(),finish_reason:N.z.string(),logprobs:N.z.object({tokens:N.z.array(N.z.string()),token_logprobs:N.z.array(N.z.number()),top_logprobs:N.z.array(N.z.record(N.z.string(),N.z.number())).nullable()}).nullable().optional()})),usage:N.z.object({prompt_tokens:N.z.number(),completion_tokens:N.z.number()})}),M=N.z.union([N.z.object({choices:N.z.array(N.z.object({text:N.z.string(),finish_reason:N.z.string().nullish(),index:N.z.number(),logprobs:N.z.object({tokens:N.z.array(N.z.string()),token_logprobs:N.z.array(N.z.number()),top_logprobs:N.z.array(N.z.record(N.z.string(),N.z.number())).nullable()}).nullable().optional()})),usage:N.z.object({prompt_tokens:N.z.number(),completion_tokens:N.z.number()}).optional().nullable()}),j]),q=class{constructor(e,t,r){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return null!=(e=this.settings.maxEmbeddingsPerCall)?e:2048}get supportsParallelCalls(){var e;return null==(e=this.settings.supportsParallelCalls)||e}async doEmbed({values:e,headers:t,abortSignal:r}){if(e.length>this.maxEmbeddingsPerCall)throw new i({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:n,value:s}=await x({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:g(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:$,successfulResponseHandler:E(L),abortSignal:r,fetch:this.config.fetch});return{embeddings:s.data.map(e=>e.embedding),rawResponse:{headers:n}}}},L=N.z.object({data:N.z.array(N.z.object({embedding:N.z.array(N.z.number())}))}),Q=function(e={}){var t,r,n,s;let i=null!=(r=null==(s=null!=(t=e.baseURL)?t:e.baseUrl)?void 0:s.replace(/\/$/,""))?r:"https://api.openai.com/v1",a=null!=(n=e.compatibility)?n:"compatible",o=()=>({Authorization:`Bearer ${function({apiKey:e,environmentVariableName:t,apiKeyParameterName:r="apiKey",description:n}){if("string"==typeof e)return e;if(null!=e)throw new d({message:`${n} API key must be a string.`});if("undefined"==typeof process)throw new d({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(null==(e=process.env[t]))throw new d({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${t} environment variable.`});if("string"!=typeof e)throw new d({message:`${n} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(t,r={})=>new I(t,r,{provider:"openai.chat",url:({path:e})=>`${i}${e}`,headers:o,compatibility:a,fetch:e.fetch}),u=(t,r={})=>new D(t,r,{provider:"openai.completion",url:({path:e})=>`${i}${e}`,headers:o,compatibility:a,fetch:e.fetch}),c=(t,r={})=>new q(t,r,{provider:"openai.embedding",url:({path:e})=>`${i}${e}`,headers:o,fetch:e.fetch}),p=(e,t)=>{if(new.target)throw Error("The OpenAI model function cannot be called with the new keyword.");return"gpt-3.5-turbo-instruct"===e?u(e,t):l(e,t)},m=function(e,t){return p(e,t)};return m.languageModel=p,m.chat=l,m.completion=u,m.embedding=c,m.textEmbedding=c,m}({compatibility:"strict"})},5395:(e,t,r)=>{"use strict";r.d(t,{D:()=>s});var n=r(7410);function s(e){let t="object"==typeof e.client?e.client:{},r="object"==typeof e.server?e.server:{},s=e.shared,i=e.runtimeEnv?e.runtimeEnv:{...process.env,...e.experimental__runtimeEnv};return function(e){let t=e.runtimeEnvStrict??e.runtimeEnv??process.env;if(e.emptyStringAsUndefined)for(let[e,r]of Object.entries(t))""===r&&delete t[e];if(e.skipValidation)return t;let r="object"==typeof e.client?e.client:{},s="object"==typeof e.server?e.server:{},i="object"==typeof e.shared?e.shared:{},a=(0,n.Ry)(r),o=(0,n.Ry)(s),l=(0,n.Ry)(i),u=e.isServer??("undefined"==typeof window||"Deno"in window),c=a.merge(l),d=o.merge(l).merge(a),p=u?d.safeParse(t):c.safeParse(t),m=e.onValidationError??(e=>{throw console.error("❌ Invalid environment variables:",e.flatten().fieldErrors),Error("Invalid environment variables")}),f=e.onInvalidAccess??(e=>{throw Error("❌ Attempted to access a server-side environment variable on the client")});if(!1===p.success)return m(p.error);let h=t=>!e.clientPrefix||!t.startsWith(e.clientPrefix)&&!(t in l.shape),g=e=>u||!h(e),y=e=>"__esModule"===e||"$$typeof"===e,v=(e.extends??[]).reduce((e,t)=>Object.assign(e,t),{});return new Proxy(Object.assign(p.data,v),{get(e,t){if("string"==typeof t&&!y(t))return g(t)?Reflect.get(e,t):f(t)}})}({...e,shared:s,client:t,server:r,clientPrefix:"NEXT_PUBLIC_",runtimeEnv:i})}},4487:(e,t,r)=>{"use strict";let n;r.d(t,{BZ:()=>rD,$Z:()=>t_,h5:()=>tS,jA:()=>rp,kP:()=>rP,w3:()=>rq});var s,i,a,o,l,u,c,d,p,m,f,h,g,y,v,b,_,w=r(5762);let S=(e,t=21)=>(r=t)=>{let n="",s=r;for(;s--;)n+=e[Math.random()*e.length|0];return n};var x=(({prefix:e="",size:t=7,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}={})=>{let n=S(r,t);return t=>`${e}${n(t)}`})(),T=Symbol.for("vercel.ai.validator"),{btoa:k,atob:E}=globalThis;let N=Symbol("Let zodToJsonSchema decide on which parser to use"),A={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},O=e=>"string"==typeof e?{...A,name:e}:{...A,...e},j=e=>{let t=O(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}};var $=r(7410);function I(e,t,r,n){n?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}function C(e,t,r,n,s){e[t]=r,I(e,t,n,s)}let P=(e,t)=>G(e.innerType._def,t),z=(e,t)=>{let r={type:"integer",format:"unix-time"};if("openApi3"===t.target)return r;for(let n of e.checks)switch(n.kind){case"min":C(r,"minimum",n.value,n.message,t);break;case"max":C(r,"maximum",n.value,n.message,t)}return r},D=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e,R={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===n&&(n=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),n),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function M(e,t){let r={type:"string"};function n(e){return"escape"===t.patternStrategy?q(e):e}if(e.checks)for(let s of e.checks)switch(s.kind){case"min":C(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,s.value):s.value,s.message,t);break;case"max":C(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,s.value):s.value,s.message,t);break;case"email":switch(t.emailStrategy){case"format:email":L(r,"email",s.message,t);break;case"format:idn-email":L(r,"idn-email",s.message,t);break;case"pattern:zod":Q(r,R.email,s.message,t)}break;case"url":L(r,"uri",s.message,t);break;case"uuid":L(r,"uuid",s.message,t);break;case"regex":Q(r,s.regex,s.message,t);break;case"cuid":Q(r,R.cuid,s.message,t);break;case"cuid2":Q(r,R.cuid2,s.message,t);break;case"startsWith":Q(r,RegExp(`^${n(s.value)}`),s.message,t);break;case"endsWith":Q(r,RegExp(`${n(s.value)}$`),s.message,t);break;case"datetime":L(r,"date-time",s.message,t);break;case"date":L(r,"date",s.message,t);break;case"time":L(r,"time",s.message,t);break;case"duration":L(r,"duration",s.message,t);break;case"length":C(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,s.value):s.value,s.message,t),C(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,s.value):s.value,s.message,t);break;case"includes":Q(r,RegExp(n(s.value)),s.message,t);break;case"ip":"v6"!==s.version&&L(r,"ipv4",s.message,t),"v4"!==s.version&&L(r,"ipv6",s.message,t);break;case"emoji":Q(r,R.emoji,s.message,t);break;case"ulid":Q(r,R.ulid,s.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":L(r,"binary",s.message,t);break;case"contentEncoding:base64":C(r,"contentEncoding","base64",s.message,t);break;case"pattern:zod":Q(r,R.base64,s.message,t)}break;case"nanoid":Q(r,R.nanoid,s.message,t)}return r}let q=e=>Array.from(e).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),L=(e,t,r,n)=>{e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&n.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&n.errorMessages&&{errorMessage:{format:r}}})):C(e,"format",t,r,n)},Q=(e,t,r,n)=>{e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&n.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:U(t,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):C(e,"pattern",U(t,n),r,n)},U=(e,t)=>{let r="function"==typeof e?e():e;if(!t.applyRegexFlags||!r.flags)return r.source;let n={i:r.flags.includes("i"),m:r.flags.includes("m"),s:r.flags.includes("s")},s=n.i?r.source.toLowerCase():r.source,i="",a=!1,o=!1,l=!1;for(let e=0;e<s.length;e++){if(a){i+=s[e],a=!1;continue}if(n.i){if(o){if(s[e].match(/[a-z]/)){l?(i+=s[e]+`${s[e-2]}-${s[e]}`.toUpperCase(),l=!1):"-"===s[e+1]&&s[e+2]?.match(/[a-z]/)?(i+=s[e],l=!0):i+=`${s[e]}${s[e].toUpperCase()}`;continue}}else if(s[e].match(/[a-z]/)){i+=`[${s[e]}${s[e].toUpperCase()}]`;continue}}if(n.m){if("^"===s[e]){i+=`(^|(?<=[\r
]))`;continue}if("$"===s[e]){i+=`($|(?=[\r
]))`;continue}}if(n.s&&"."===s[e]){i+=o?`${s[e]}\r
`:`[${s[e]}\r
]`;continue}i+=s[e],"\\"===s[e]?a=!0:o&&"]"===s[e]?o=!1:o||"["!==s[e]||(o=!0)}try{new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return i};function Z(e,t){if("openApi3"===t.target&&e.keyType?._def.typeName===$.pA.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,n)=>({...r,[n]:G(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",n]})??{}}),{}),additionalProperties:!1};let r={type:"object",additionalProperties:G(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if("openApi3"===t.target)return r;if(e.keyType?._def.typeName===$.pA.ZodString&&e.keyType._def.checks?.length){let n=Object.entries(M(e.keyType._def,t)).reduce((e,[t,r])=>"type"===t?e:{...e,[t]:r},{});return{...r,propertyNames:n}}return e.keyType?._def.typeName===$.pA.ZodEnum?{...r,propertyNames:{enum:e.keyType._def.values}}:r}let B={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},F=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>G(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0},V=(e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return G(e.innerType._def,t);let r=G(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}},J=(e,t)=>{if("input"===t.pipeStrategy)return G(e.in._def,t);if("output"===t.pipeStrategy)return G(e.out._def,t);let r=G(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),n=G(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(e=>void 0!==e)}},K=(e,t)=>G(e.innerType._def,t);function G(e,t,r=!1){let n=t.seen.get(e);if(t.override){let s=t.override?.(e,t,n,r);if(s!==N)return s}if(n&&!r){let e=W(n,t);if(void 0!==e)return e}let s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);let i=H(e,e.typeName,t);return i&&X(e,t,i),s.jsonSchema=i,i}let W=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Y(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},Y=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},H=(e,t,r)=>{switch(t){case $.pA.ZodString:return M(e,r);case $.pA.ZodNumber:return function(e,t){let r={type:"number"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case"int":r.type="integer",I(r,"type",n.message,t);break;case"min":"jsonSchema7"===t.target?n.inclusive?C(r,"minimum",n.value,n.message,t):C(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=!0),C(r,"minimum",n.value,n.message,t));break;case"max":"jsonSchema7"===t.target?n.inclusive?C(r,"maximum",n.value,n.message,t):C(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=!0),C(r,"maximum",n.value,n.message,t));break;case"multipleOf":C(r,"multipleOf",n.value,n.message,t)}return r}(e,r);case $.pA.ZodObject:return function(e,t){let r={type:"object",...Object.entries(e.shape()).reduce((e,[r,n])=>{if(void 0===n||void 0===n._def)return e;let s=G(n._def,{...t,currentPath:[...t.currentPath,"properties",r],propertyPath:[...t.currentPath,"properties",r]});return void 0===s?e:{properties:{...e.properties,[r]:s},required:n.isOptional()?e.required:[...e.required,r]}},{properties:{},required:[]}),additionalProperties:"strict"===t.removeAdditionalStrategy?"ZodNever"===e.catchall._def.typeName?"strict"!==e.unknownKeys:G(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:G(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0};return r.required.length||delete r.required,r}(e,r);case $.pA.ZodBigInt:return function(e,t){let r={type:"integer",format:"int64"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case"min":"jsonSchema7"===t.target?n.inclusive?C(r,"minimum",n.value,n.message,t):C(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=!0),C(r,"minimum",n.value,n.message,t));break;case"max":"jsonSchema7"===t.target?n.inclusive?C(r,"maximum",n.value,n.message,t):C(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=!0),C(r,"maximum",n.value,n.message,t));break;case"multipleOf":C(r,"multipleOf",n.value,n.message,t)}return r}(e,r);case $.pA.ZodBoolean:return{type:"boolean"};case $.pA.ZodDate:return function e(t,r,n){let s=n??r.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((n,s)=>e(t,r,n))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return z(t,r)}}(e,r);case $.pA.ZodUndefined:return{not:{}};case $.pA.ZodNull:return"openApi3"===r.target?{enum:["null"],nullable:!0}:{type:"null"};case $.pA.ZodArray:return function(e,t){let r={type:"array"};return e.type?._def?.typeName!==$.pA.ZodAny&&(r.items=G(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&C(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&C(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(C(r,"minItems",e.exactLength.value,e.exactLength.message,t),C(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}(e,r);case $.pA.ZodUnion:case $.pA.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return F(e,t);let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in B&&(!e._def.checks||!e._def.checks.length))){let e=r.reduce((e,t)=>{let r=B[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=r.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return F(e,t)}(e,r);case $.pA.ZodIntersection:return function(e,t){let r=[G(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),G(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),n="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,s=[];return r.forEach(e=>{if(D(e))s.push(...e.allOf),void 0===e.unevaluatedProperties&&(n=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...n}=e;t=n}else n=void 0;s.push(t)}}),s.length?{allOf:s,...n}:void 0}(e,r);case $.pA.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>G(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:G(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>G(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,r);case $.pA.ZodRecord:return Z(e,r);case $.pA.ZodLiteral:return function(e,t){let r=typeof e.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===r?"integer":r,enum:[e.value]}:{type:"bigint"===r?"integer":r,const:e.value}}(e,r);case $.pA.ZodEnum:return{type:"string",enum:e.values};case $.pA.ZodNativeEnum:return function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),n=Array.from(new Set(r.map(e=>typeof e)));return{type:1===n.length?"string"===n[0]?"string":"number":["string","number"],enum:r}}(e);case $.pA.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:B[e.innerType._def.typeName],nullable:!0}:{type:[B[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){let r=G(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}let r=G(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(e,r);case $.pA.ZodOptional:return V(e,r);case $.pA.ZodMap:return function(e,t){return"record"===t.mapStrategy?Z(e,t):{type:"array",maxItems:125,items:{type:"array",items:[G(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},G(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,r);case $.pA.ZodSet:return function(e,t){let r={type:"array",uniqueItems:!0,items:G(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&C(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&C(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}(e,r);case $.pA.ZodLazy:return G(e.getter()._def,r);case $.pA.ZodPromise:return G(e.type._def,r);case $.pA.ZodNaN:case $.pA.ZodNever:return{not:{}};case $.pA.ZodEffects:return function(e,t){return"input"===t.effectStrategy?G(e.schema._def,t):{}}(e,r);case $.pA.ZodAny:case $.pA.ZodUnknown:return{};case $.pA.ZodDefault:return function(e,t){return{...G(e.innerType._def,t),default:e.defaultValue()}}(e,r);case $.pA.ZodBranded:return G(e.type._def,r);case $.pA.ZodReadonly:return K(e,r);case $.pA.ZodCatch:return P(e,r);case $.pA.ZodPipeline:return J(e,r);case $.pA.ZodFunction:case $.pA.ZodVoid:case $.pA.ZodSymbol:default:return}},X=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r),ee=(e,t)=>{let r=j(t),n="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,n])=>({...e,[t]:G(n._def,{...r,currentPath:[...r.basePath,r.definitionPath,t]},!0)??{}}),{}):void 0,s="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,i=G(e._def,void 0===s?r:{...r,currentPath:[...r.basePath,r.definitionPath,s]},!1)??{},a="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==a&&(i.title=a);let o=void 0===s?n?{...i,[r.definitionPath]:n}:i:{$ref:[..."relative"===r.$refStrategy?[]:r.basePath,r.definitionPath,s].join("/"),[r.definitionPath]:{...n,[s]:i}};return"jsonSchema7"===r.target?o.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"===r.target&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};var et={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},er={code:"1",name:"function_call",parse:e=>{if(null==e||"object"!=typeof e||!("function_call"in e)||"object"!=typeof e.function_call||null==e.function_call||!("name"in e.function_call)||!("arguments"in e.function_call)||"string"!=typeof e.function_call.name||"string"!=typeof e.function_call.arguments)throw Error('"function_call" parts expect an object with a "function_call" property.');return{type:"function_call",value:e}}},en={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw Error('"data" parts expect an array value.');return{type:"data",value:e}}},es={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},ei={code:"4",name:"assistant_message",parse:e=>{if(null==e||"object"!=typeof e||!("id"in e)||!("role"in e)||!("content"in e)||"string"!=typeof e.id||"string"!=typeof e.role||"assistant"!==e.role||!Array.isArray(e.content)||!e.content.every(e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))throw Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},ea={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},eo={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},el={code:"7",name:"tool_calls",parse:e=>{if(null==e||"object"!=typeof e||!("tool_calls"in e)||"object"!=typeof e.tool_calls||null==e.tool_calls||!Array.isArray(e.tool_calls)||e.tool_calls.some(e=>null==e||"object"!=typeof e||!("id"in e)||"string"!=typeof e.id||!("type"in e)||"string"!=typeof e.type||!("function"in e)||null==e.function||"object"!=typeof e.function||!("arguments"in e.function)||"string"!=typeof e.function.name||"string"!=typeof e.function.arguments))throw Error('"tool_calls" parts expect an object with a ToolCallPayload.');return{type:"tool_calls",value:e}}},eu={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},ec={code:"9",name:"tool_call",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName||!("args"in e)||"object"!=typeof e.args)throw Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},ed={code:"a",name:"tool_result",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("result"in e))throw Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},ep={code:"b",name:"tool_call_streaming_start",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName)throw Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},em={code:"c",name:"tool_call_delta",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("argsTextDelta"in e)||"string"!=typeof e.argsTextDelta)throw Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},ef={code:"d",name:"finish_message",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_message" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},eh={code:"e",name:"finish_step",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_step" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&"boolean"==typeof e.isContinued&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},eg=[et,er,en,es,ei,ea,eo,el,eu,ec,ed,ep,em,ef,eh],ey={[et.code]:et,[er.code]:er,[en.code]:en,[es.code]:es,[ei.code]:ei,[ea.code]:ea,[eo.code]:eo,[el.code]:el,[eu.code]:eu,[ec.code]:ec,[ed.code]:ed,[ep.code]:ep,[em.code]:em,[ef.code]:ef,[eh.code]:eh};et.name,et.code,er.name,er.code,en.name,en.code,es.name,es.code,ei.name,ei.code,ea.name,ea.code,eo.name,eo.code,el.name,el.code,eu.name,eu.code,ec.name,ec.code,ed.name,ed.code,ep.name,ep.code,em.name,em.code,ef.name,ef.code,eh.name,eh.code;var ev=eg.map(e=>e.code),eb=e=>{let t=e.indexOf(":");if(-1===t)throw Error("Failed to parse stream string. No separator found.");let r=e.slice(0,t);if(!ev.includes(r))throw Error(`Failed to parse stream string. Invalid code ${r}.`);let n=JSON.parse(e.slice(t+1));return ey[r].parse(n)};function e_(e,t){let r=eg.find(t=>t.name===e);if(!r)throw Error(`Invalid stream part type: ${e}`);return`${r.code}:${JSON.stringify(t)}
`}var ew=Symbol.for("vercel.ai.schema");function eS(e){return"object"==typeof e&&null!==e&&ew in e&&!0===e[ew]&&"jsonSchema"in e&&"validate"in e?e:function(e,{validate:t}={}){return{[ew]:!0,_type:void 0,[T]:!0,jsonSchema:e,validate:t}}(ee(e),{validate:t=>{let r=e.safeParse(t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}var ex="vercel.ai.error",eT=Symbol.for(ex),ek=class e extends Error{constructor({name:e,message:t,cause:r}){super(t),this[s]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,ex)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}toJSON(){return{name:this.name,message:this.message}}};s=eT;var eE=ek,eN="AI_APICallError",eA=`vercel.ai.error.${eN}`,eO=Symbol.for(eA),ej=class extends eE{constructor({message:e,url:t,requestBodyValues:r,statusCode:n,responseHeaders:s,responseBody:a,cause:o,isRetryable:l=null!=n&&(408===n||409===n||429===n||n>=500),data:u}){super({name:eN,message:e,cause:o}),this[i]=!0,this.url=t,this.requestBodyValues=r,this.statusCode=n,this.responseHeaders=s,this.responseBody=a,this.isRetryable=l,this.data=u}static isInstance(e){return eE.hasMarker(e,eA)}static isAPICallError(e){return e instanceof Error&&e.name===eN&&"string"==typeof e.url&&"object"==typeof e.requestBodyValues&&(null==e.statusCode||"number"==typeof e.statusCode)&&(null==e.responseHeaders||"object"==typeof e.responseHeaders)&&(null==e.responseBody||"string"==typeof e.responseBody)&&(null==e.cause||"object"==typeof e.cause)&&"boolean"==typeof e.isRetryable&&(null==e.data||"object"==typeof e.data)}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}};function e$(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}i=eO,Symbol.for("vercel.ai.error.AI_EmptyResponseBodyError");var eI="AI_InvalidPromptError",eC=`vercel.ai.error.${eI}`,eP=Symbol.for(eC),ez=class extends eE{constructor({prompt:e,message:t,cause:r}){super({name:eI,message:`Invalid prompt: ${t}`,cause:r}),this[a]=!0,this.prompt=e}static isInstance(e){return eE.hasMarker(e,eC)}static isInvalidPromptError(e){return e instanceof Error&&e.name===eI&&null!=prompt}toJSON(){return{name:this.name,message:this.message,stack:this.stack,prompt:this.prompt}}};a=eP,Symbol.for("vercel.ai.error.AI_InvalidResponseDataError");var eD="AI_JSONParseError",eR=`vercel.ai.error.${eD}`,eM=Symbol.for(eR),eq=class extends eE{constructor({text:e,cause:t}){super({name:eD,message:`JSON parsing failed: Text: ${e}.
Error message: ${e$(t)}`,cause:t}),this[o]=!0,this.text=e}static isInstance(e){return eE.hasMarker(e,eR)}static isJSONParseError(e){return e instanceof Error&&e.name===eD&&"text"in e&&"string"==typeof e.text}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}};o=eM,Symbol.for("vercel.ai.error.AI_LoadAPIKeyError"),Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");var eL="AI_NoSuchModelError",eQ=`vercel.ai.error.${eL}`,eU=Symbol.for(eQ),eZ=class extends eE{constructor({errorName:e=eL,modelId:t,modelType:r,message:n=`No such ${r}: ${t}`}){super({name:e,message:n}),this[l]=!0,this.modelId=t,this.modelType=r}static isInstance(e){return eE.hasMarker(e,eQ)}static isNoSuchModelError(e){return e instanceof Error&&e.name===eL&&"string"==typeof e.modelId&&"string"==typeof e.modelType}toJSON(){return{name:this.name,message:this.message,stack:this.stack,modelId:this.modelId,modelType:this.modelType}}};l=eU,Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError");var eB="AI_TypeValidationError",eF=`vercel.ai.error.${eB}`,eV=Symbol.for(eF),eJ=class e extends eE{constructor({value:e,cause:t}){super({name:eB,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${e$(t)}`,cause:t}),this[u]=!0,this.value=e}static isInstance(e){return eE.hasMarker(e,eF)}static wrap({value:t,cause:r}){return e.isInstance(r)&&r.value===t?r:new e({value:t,cause:r})}static isTypeValidationError(e){return e instanceof Error&&e.name===eB}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}};u=eV;var eK="AI_UnsupportedFunctionalityError",eG=`vercel.ai.error.${eK}`,eW=Symbol.for(eG),eY=class extends eE{constructor({functionality:e}){super({name:eK,message:`'${e}' functionality not supported.`}),this[c]=!0,this.functionality=e}static isInstance(e){return eE.hasMarker(e,eG)}static isUnsupportedFunctionalityError(e){return e instanceof Error&&e.name===eK&&"string"==typeof e.functionality}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}};function eH(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(eH):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&eH(t)))}function eX(e){return Array.isArray(e)&&e.every(eH)}function e0(e){return null!=e&&"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&eH(t))}c=eW;let e1=(e,t=21)=>(r=t)=>{let n="",s=r;for(;s--;)n+=e[Math.random()*e.length|0];return n};var e6=({prefix:e="",size:t=7,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}={})=>{let n=e1(r,t);return t=>`${e}${n(t)}`};function e2(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}e6();var e4=Symbol.for("vercel.ai.validator");function e8({value:e,schema:t}){let r="object"==typeof t&&null!==t&&e4 in t&&!0===t[e4]&&"validate"in t?t:{[e4]:!0,validate:e=>{let r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}};try{if(null==r.validate)return{success:!0,value:e};let t=r.validate(e);if(t.success)return t;return{success:!1,error:eJ.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:eJ.wrap({value:e,cause:t})}}}function e3({text:e,schema:t}){try{let r=w.parse(e);if(null==t)return{success:!0,value:r};return e8({value:r,schema:t})}catch(t){return{success:!1,error:eq.isJSONParseError(t)?t:new eq({text:e,cause:t})}}}var{btoa:e9,atob:e7}=globalThis;function e5(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return e9(t)}var te=r(5658),tt=r(3048),tr=Object.defineProperty,tn=(e,t)=>{for(var r in t)tr(e,r,{get:t[r],enumerable:!0})};async function ts(e){return void 0===e?Promise.resolve():new Promise(t=>setTimeout(t,e))}var ti="AI_RetryError",ta=`vercel.ai.error.${ti}`,to=Symbol.for(ta),tl=class extends eE{constructor({message:e,reason:t,errors:r}){super({name:ti,message:e}),this[d]=!0,this.reason=t,this.errors=r,this.lastError=r[r.length-1]}static isInstance(e){return eE.hasMarker(e,ta)}static isRetryError(e){return e instanceof Error&&e.name===ti&&"string"==typeof e.reason&&Array.isArray(e.errors)}toJSON(){return{name:this.name,message:this.message,reason:this.reason,lastError:this.lastError,errors:this.errors}}};d=to;var tu=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:r=2}={})=>async n=>tc(n,{maxRetries:e,delayInMs:t,backoffFactor:r});async function tc(e,{maxRetries:t,delayInMs:r,backoffFactor:n},s=[]){try{return await e()}catch(u){var i;if((i=u)instanceof Error&&("AbortError"===i.name||"TimeoutError"===i.name)||0===t)throw u;let a=e2(u),o=[...s,u],l=o.length;if(l>t)throw new tl({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:o});if(u instanceof Error&&ej.isAPICallError(u)&&!0===u.isRetryable&&l<=t)return await ts(r),tc(e,{maxRetries:t,delayInMs:n*r,backoffFactor:n},o);if(1===l)throw u;throw new tl({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:o})}}function td({operationId:e,telemetry:t}){return{"operation.name":`${e}${(null==t?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":null==t?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":null==t?void 0:t.functionId}}function tp({model:e,settings:t,telemetry:r,headers:n}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((e,[t,r])=>(e[`ai.settings.${t}`]=r,e),{}),...Object.entries(null!=(s=null==r?void 0:r.metadata)?s:{}).reduce((e,[t,r])=>(e[`ai.telemetry.metadata.${t}`]=r,e),{}),...Object.entries(null!=n?n:{}).reduce((e,[t,r])=>(void 0!==r&&(e[`ai.request.headers.${t}`]=r),e),{})}}var tm={startSpan:()=>tf,startActiveSpan:(e,t,r,n)=>"function"==typeof t?t(tf):"function"==typeof r?r(tf):"function"==typeof n?n(tf):void 0},tf={spanContext:()=>th,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},th={traceId:"",spanId:"",traceFlags:0},tg=void 0;function ty({isEnabled:e}){return e?tg||te.g.getTracer("ai"):tm}function tv({name:e,tracer:t,attributes:r,fn:n,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:r},async e=>{try{let t=await n(e);return s&&e.end(),t}catch(t){try{t instanceof Error?(e.recordException({name:t.name,message:t.message,stack:t.stack}),e.setStatus({code:tt.Q.ERROR,message:t.message})):e.setStatus({code:tt.Q.ERROR})}finally{e.end()}throw t}})}function tb({telemetry:e,attributes:t}){return Object.entries(t).reduce((t,[r,n])=>{if(void 0===n)return t;if("object"==typeof n&&"input"in n&&"function"==typeof n.input){if((null==e?void 0:e.recordInputs)===!1)return t;let s=n.input();return void 0===s?t:{...t,[r]:s}}if("object"==typeof n&&"output"in n&&"function"==typeof n.output){if((null==e?void 0:e.recordOutputs)===!1)return t;let s=n.output();return void 0===s?t:{...t,[r]:s}}return{...t,[r]:n}},{})}async function t_({model:e,value:t,maxRetries:r,abortSignal:n,headers:s,experimental_telemetry:i}){var a;let o=tp({model:e,telemetry:i,headers:s,settings:{maxRetries:r}}),l=ty({isEnabled:null!=(a=null==i?void 0:i.isEnabled)&&a});return tv({name:"ai.embed",attributes:tb({telemetry:i,attributes:{...td({operationId:"ai.embed",telemetry:i}),...o,"ai.value":{input:()=>JSON.stringify(t)}}}),tracer:l,fn:async a=>{let u=tu({maxRetries:r}),{embedding:c,usage:d,rawResponse:p}=await u(()=>tv({name:"ai.embed.doEmbed",attributes:tb({telemetry:i,attributes:{...td({operationId:"ai.embed.doEmbed",telemetry:i}),...o,"ai.values":{input:()=>[JSON.stringify(t)]}}}),tracer:l,fn:async r=>{var a;let o=await e.doEmbed({values:[t],abortSignal:n,headers:s}),l=o.embeddings[0],u=null!=(a=o.usage)?a:{tokens:NaN};return r.setAttributes(tb({telemetry:i,attributes:{"ai.embeddings":{output:()=>o.embeddings.map(e=>JSON.stringify(e))},"ai.usage.tokens":u.tokens}})),{embedding:l,usage:u,rawResponse:o.rawResponse}}}));return a.setAttributes(tb({telemetry:i,attributes:{"ai.embedding":{output:()=>JSON.stringify(c)},"ai.usage.tokens":d.tokens}})),new tw({value:t,embedding:c,usage:d,rawResponse:p})}})}var tw=class{constructor(e){this.value=e.value,this.embedding=e.embedding,this.usage=e.usage,this.rawResponse=e.rawResponse}};async function tS({model:e,values:t,maxRetries:r,abortSignal:n,headers:s,experimental_telemetry:i}){var a;let o=tp({model:e,telemetry:i,headers:s,settings:{maxRetries:r}}),l=ty({isEnabled:null!=(a=null==i?void 0:i.isEnabled)&&a});return tv({name:"ai.embedMany",attributes:tb({telemetry:i,attributes:{...td({operationId:"ai.embedMany",telemetry:i}),...o,"ai.values":{input:()=>t.map(e=>JSON.stringify(e))}}}),tracer:l,fn:async a=>{let u=tu({maxRetries:r}),c=e.maxEmbeddingsPerCall;if(null==c){let{embeddings:r,usage:c}=await u(()=>tv({name:"ai.embedMany.doEmbed",attributes:tb({telemetry:i,attributes:{...td({operationId:"ai.embedMany.doEmbed",telemetry:i}),...o,"ai.values":{input:()=>t.map(e=>JSON.stringify(e))}}}),tracer:l,fn:async r=>{var a;let o=await e.doEmbed({values:t,abortSignal:n,headers:s}),l=o.embeddings,u=null!=(a=o.usage)?a:{tokens:NaN};return r.setAttributes(tb({telemetry:i,attributes:{"ai.embeddings":{output:()=>l.map(e=>JSON.stringify(e))},"ai.usage.tokens":u.tokens}})),{embeddings:l,usage:u}}}));return a.setAttributes(tb({telemetry:i,attributes:{"ai.embeddings":{output:()=>r.map(e=>JSON.stringify(e))},"ai.usage.tokens":c.tokens}})),new tx({values:t,embeddings:r,usage:c})}let d=function(e,t){if(t<=0)throw Error("chunkSize must be greater than 0");let r=[];for(let n=0;n<e.length;n+=t)r.push(e.slice(n,n+t));return r}(t,c),p=[],m=0;for(let t of d){let{embeddings:r,usage:a}=await u(()=>tv({name:"ai.embedMany.doEmbed",attributes:tb({telemetry:i,attributes:{...td({operationId:"ai.embedMany.doEmbed",telemetry:i}),...o,"ai.values":{input:()=>t.map(e=>JSON.stringify(e))}}}),tracer:l,fn:async r=>{var a;let o=await e.doEmbed({values:t,abortSignal:n,headers:s}),l=o.embeddings,u=null!=(a=o.usage)?a:{tokens:NaN};return r.setAttributes(tb({telemetry:i,attributes:{"ai.embeddings":{output:()=>l.map(e=>JSON.stringify(e))},"ai.usage.tokens":u.tokens}})),{embeddings:l,usage:u}}}));p.push(...r),m+=a.tokens}return a.setAttributes(tb({telemetry:i,attributes:{"ai.embeddings":{output:()=>p.map(e=>JSON.stringify(e))},"ai.usage.tokens":m}})),new tx({values:t,embeddings:p,usage:{tokens:m}})}})}var tx=class{constructor(e){this.values=e.values,this.embeddings=e.embeddings,this.usage=e.usage}},tT="AI_DownloadError",tk=`vercel.ai.error.${tT}`,tE=Symbol.for(tk),tN=class extends eE{constructor({url:e,statusCode:t,statusText:r,cause:n,message:s=null==n?`Failed to download ${e}: ${t} ${r}`:`Failed to download ${e}: ${n}`}){super({name:tT,message:s,cause:n}),this[p]=!0,this.url=e,this.statusCode=t,this.statusText=r}static isInstance(e){return eE.hasMarker(e,tk)}static isDownloadError(e){return e instanceof Error&&e.name===tT&&"string"==typeof e.url&&(null==e.statusCode||"number"==typeof e.statusCode)&&(null==e.statusText||"string"==typeof e.statusText)}toJSON(){return{name:this.name,message:this.message,url:this.url,statusCode:this.statusCode,statusText:this.statusText,cause:this.cause}}};async function tA({url:e,fetchImplementation:t=fetch}){var r;let n=e.toString();try{let e=await t(n);if(!e.ok)throw new tN({url:n,statusCode:e.status,statusText:e.statusText});return{data:new Uint8Array(await e.arrayBuffer()),mimeType:null!=(r=e.headers.get("content-type"))?r:void 0}}catch(e){if(tN.isInstance(e))throw e;throw new tN({url:n,cause:e})}}p=tE;var tO=[{mimeType:"image/gif",bytes:[71,73,70]},{mimeType:"image/png",bytes:[137,80,78,71]},{mimeType:"image/jpeg",bytes:[255,216]},{mimeType:"image/webp",bytes:[82,73,70,70]}],tj="AI_InvalidDataContentError",t$=`vercel.ai.error.${tj}`,tI=Symbol.for(t$),tC=class extends eE{constructor({content:e,cause:t,message:r=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:tj,message:r,cause:t}),this[m]=!0,this.content=e}static isInstance(e){return eE.hasMarker(e,t$)}static isInvalidDataContentError(e){return e instanceof Error&&e.name===tj&&null!=e.content}toJSON(){return{name:this.name,message:this.message,stack:this.stack,cause:this.cause,content:this.content}}};m=tI;var tP=$.z.union([$.z.string(),$.z.instanceof(Uint8Array),$.z.instanceof(ArrayBuffer),$.z.custom(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]);function tz(e){return"string"==typeof e?e:e instanceof ArrayBuffer?e5(new Uint8Array(e)):e5(e)}function tD(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)try{return function(e){let t=e7(e.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(t,e=>e.codePointAt(0))}(e)}catch(t){throw new tC({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new tC({content:e})}var tR="AI_InvalidMessageRoleError",tM=`vercel.ai.error.${tR}`,tq=Symbol.for(tM),tL=class extends eE{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:tR,message:t}),this[f]=!0,this.role=e}static isInstance(e){return eE.hasMarker(e,tM)}static isInvalidMessageRoleError(e){return e instanceof Error&&e.name===tR&&"string"==typeof e.role}toJSON(){return{name:this.name,message:this.message,stack:this.stack,role:this.role}}};function tQ(e){try{let[t,r]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:r}}catch(e){return{mimeType:void 0,base64Content:void 0}}}async function tU({prompt:e,modelSupportsImageUrls:t=!0,downloadImplementation:r=tA}){let n=[];null!=e.system&&n.push({role:"system",content:e.system});let s=t||null==e.messages?null:await tB(e.messages,r),i=e.type;switch(i){case"prompt":n.push({role:"user",content:[{type:"text",text:e.prompt}]});break;case"messages":n.push(...e.messages.map(e=>tZ(e,s)));break;default:throw Error(`Unsupported prompt type: ${i}`)}return n}function tZ(e,t){let r=e.role;switch(r){case"system":return{role:"system",content:e.content,providerMetadata:e.experimental_providerMetadata};case"user":if("string"==typeof e.content)return{role:"user",content:[{type:"text",text:e.content}],providerMetadata:e.experimental_providerMetadata};return{role:"user",content:e.content.map(r=>{var n,s,i,a,o;switch(r.type){case"text":return{type:"text",text:r.text,providerMetadata:r.experimental_providerMetadata};case"image":{if(r.image instanceof URL){if(null==t)return{type:"image",image:r.image,mimeType:r.mimeType,providerMetadata:r.experimental_providerMetadata};{let e=t[r.image.toString()];return{type:"image",image:e.data,mimeType:null!=(n=r.mimeType)?n:e.mimeType,providerMetadata:r.experimental_providerMetadata}}}if("string"==typeof r.image)try{let n=new URL(r.image);switch(n.protocol){case"http:":case"https:":if(null==t)return{type:"image",image:n,mimeType:r.mimeType,providerMetadata:r.experimental_providerMetadata};{let e=t[n.toString()];return{type:"image",image:e.data,mimeType:null!=(s=r.mimeType)?s:e.mimeType,providerMetadata:r.experimental_providerMetadata}}case"data:":try{let{mimeType:e,base64Content:t}=tQ(r.image);if(null==e||null==t)throw Error("Invalid data URL format");return{type:"image",image:tD(t),mimeType:e,providerMetadata:r.experimental_providerMetadata}}catch(t){throw Error(`Error processing data URL: ${e2(e)}`)}}}catch(e){}let a=tD(r.image);return{type:"image",image:a,mimeType:null!=(i=r.mimeType)?i:function(e){for(let{bytes:t,mimeType:r}of tO)if(e.length>=t.length&&t.every((t,r)=>e[r]===t))return r}(a),providerMetadata:r.experimental_providerMetadata}}case"file":if(r.data instanceof URL){if(null==t)return{type:"file",data:r.data,mimeType:r.mimeType,providerMetadata:r.experimental_providerMetadata};{let e=t[r.data.toString()];return{type:"file",data:e5(e.data),mimeType:null!=(a=r.mimeType)?a:e.mimeType,providerMetadata:r.experimental_providerMetadata}}}if("string"==typeof r.data)try{let n=new URL(r.data);switch(n.protocol){case"http:":case"https:":if(null==t)return{type:"file",data:n,mimeType:r.mimeType,providerMetadata:r.experimental_providerMetadata};{let e=t[n.toString()];return{type:"file",data:e5(e.data),mimeType:null!=(o=r.mimeType)?o:e.mimeType,providerMetadata:r.experimental_providerMetadata}}case"data:":try{let{mimeType:e,base64Content:t}=tQ(r.data);if(null==e||null==t)throw Error("Invalid data URL format");return{type:"file",data:tz(t),mimeType:e,providerMetadata:r.experimental_providerMetadata}}catch(t){throw Error(`Error processing data URL: ${e2(e)}`)}}}catch(e){}return{type:"file",data:tz(r.data),mimeType:r.mimeType,providerMetadata:r.experimental_providerMetadata}}}).filter(e=>"text"!==e.type||""!==e.text),providerMetadata:e.experimental_providerMetadata};case"assistant":if("string"==typeof e.content)return{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:e.experimental_providerMetadata};return{role:"assistant",content:e.content.filter(e=>"text"!==e.type||""!==e.text).map(e=>{let{experimental_providerMetadata:t,...r}=e;return{...r,providerMetadata:t}}),providerMetadata:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(e=>({type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:e.result,providerMetadata:e.experimental_providerMetadata})),providerMetadata:e.experimental_providerMetadata};default:throw new tL({role:r})}}async function tB(e,t){let r=e.filter(e=>"user"===e.role).map(e=>e.content).filter(e=>Array.isArray(e)).flat().filter(e=>"image"===e.type||"file"===e.type).map(e=>"image"===e.type?e.image:e.data).map(e=>"string"==typeof e&&(e.startsWith("http:")||e.startsWith("https:"))?new URL(e):e).filter(e=>e instanceof URL);return Object.fromEntries((await Promise.all(r.map(async e=>({url:e,data:await t({url:e})})))).map(({url:e,data:t})=>[e.toString(),t]))}f=tq;var tF="AI_InvalidArgumentError",tV=`vercel.ai.error.${tF}`,tJ=Symbol.for(tV),tK=class extends eE{constructor({parameter:e,value:t,message:r}){super({name:tF,message:`Invalid argument for parameter ${e}: ${r}`}),this[h]=!0,this.parameter=e,this.value=t}static isInstance(e){return eE.hasMarker(e,tV)}static isInvalidArgumentError(e){return e instanceof Error&&e.name===tF&&"string"==typeof e.parameter&&"string"==typeof e.value}toJSON(){return{name:this.name,message:this.message,stack:this.stack,parameter:this.parameter,value:this.value}}};function tG({maxTokens:e,temperature:t,topP:r,topK:n,presencePenalty:s,frequencyPenalty:i,stopSequences:a,seed:o,maxRetries:l}){if(null!=e){if(!Number.isInteger(e))throw new tK({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new tK({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(null!=t&&"number"!=typeof t)throw new tK({parameter:"temperature",value:t,message:"temperature must be a number"});if(null!=r&&"number"!=typeof r)throw new tK({parameter:"topP",value:r,message:"topP must be a number"});if(null!=n&&"number"!=typeof n)throw new tK({parameter:"topK",value:n,message:"topK must be a number"});if(null!=s&&"number"!=typeof s)throw new tK({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(null!=i&&"number"!=typeof i)throw new tK({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(null!=o&&!Number.isInteger(o))throw new tK({parameter:"seed",value:o,message:"seed must be an integer"});if(null!=l){if(!Number.isInteger(l))throw new tK({parameter:"maxRetries",value:l,message:"maxRetries must be an integer"});if(l<0)throw new tK({parameter:"maxRetries",value:l,message:"maxRetries must be >= 0"})}return{maxTokens:e,temperature:null!=t?t:0,topP:r,topK:n,presencePenalty:s,frequencyPenalty:i,stopSequences:null!=a&&a.length>0?a:void 0,seed:o,maxRetries:null!=l?l:2}}h=tJ;var tW=$.z.lazy(()=>$.z.union([$.z.null(),$.z.string(),$.z.number(),$.z.boolean(),$.z.record($.z.string(),tW),$.z.array(tW)])),tY=$.z.record($.z.string(),$.z.record($.z.string(),tW)),tH=$.z.object({type:$.z.literal("text"),text:$.z.string(),experimental_providerMetadata:tY.optional()}),tX=$.z.object({type:$.z.literal("image"),image:$.z.union([tP,$.z.instanceof(URL)]),mimeType:$.z.string().optional(),experimental_providerMetadata:tY.optional()}),t0=$.z.object({type:$.z.literal("file"),data:$.z.union([tP,$.z.instanceof(URL)]),mimeType:$.z.string(),experimental_providerMetadata:tY.optional()}),t1=$.z.object({type:$.z.literal("tool-call"),toolCallId:$.z.string(),toolName:$.z.string(),args:$.z.unknown()}),t6=$.z.object({type:$.z.literal("tool-result"),toolCallId:$.z.string(),toolName:$.z.string(),result:$.z.unknown(),isError:$.z.boolean().optional(),experimental_providerMetadata:tY.optional()}),t2=$.z.object({role:$.z.literal("system"),content:$.z.string(),experimental_providerMetadata:tY.optional()}),t4=$.z.object({role:$.z.literal("user"),content:$.z.union([$.z.string(),$.z.array($.z.union([tH,tX,t0]))]),experimental_providerMetadata:tY.optional()}),t8=$.z.object({role:$.z.literal("assistant"),content:$.z.union([$.z.string(),$.z.array($.z.union([tH,t1]))]),experimental_providerMetadata:tY.optional()}),t3=$.z.object({role:$.z.literal("tool"),content:$.z.array(t6),experimental_providerMetadata:tY.optional()}),t9=$.z.union([t2,t4,t8,t3]);function t7(e){if(null==e.prompt&&null==e.messages)throw new ez({prompt:e,message:"prompt or messages must be defined"});if(null!=e.prompt&&null!=e.messages)throw new ez({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(null!=e.system&&"string"!=typeof e.system)throw new ez({prompt:e,message:"system must be a string"});if(null!=e.prompt){if("string"!=typeof e.prompt)throw new ez({prompt:e,message:"prompt must be a string"});return{type:"prompt",prompt:e.prompt,messages:void 0,system:e.system}}if(null!=e.messages){let t=e8({value:e.messages,schema:$.z.array(t9)});if(!t.success)throw new ez({prompt:e,message:"messages must be an array of CoreMessage",cause:t.error});return{type:"messages",prompt:void 0,messages:e.messages,system:e.system}}throw Error("unreachable")}function t5(e){return{promptTokens:e.promptTokens,completionTokens:e.completionTokens,totalTokens:e.promptTokens+e.completionTokens}}function re(e,{contentType:t,dataStreamVersion:r}){var n;let s=new Headers(null!=(n=null==e?void 0:e.headers)?n:{});return s.has("Content-Type")||s.set("Content-Type",t),void 0!==r&&s.set("X-Vercel-AI-Data-Stream",r),s}function rt({prompt:e,schema:t,schemaPrefix:r=null!=t?"JSON schema:":void 0,schemaSuffix:n=null!=t?"You MUST answer with a JSON object that matches the JSON schema above.":"You MUST answer with JSON."}){return[null!=e&&e.length>0?e:void 0,null!=e&&e.length>0?"":void 0,r,null!=t?JSON.stringify(t):void 0,n].filter(e=>null!=e).join("\n")}var rr="AI_NoObjectGeneratedError",rn=`vercel.ai.error.${rr}`,rs=Symbol.for(rn),ri=class extends eE{constructor({message:e="No object generated."}={}){super({name:rr,message:e}),this[g]=!0}static isInstance(e){return eE.hasMarker(e,rn)}static isNoObjectGeneratedError(e){return e instanceof Error&&e.name===rr}toJSON(){return{name:this.name,cause:this.cause,message:this.message,stack:this.stack}}};function ra(e,t){let r=e.pipeThrough(new TransformStream(t));return r[Symbol.asyncIterator]=()=>{let e=r.getReader();return{async next(){let{done:t,value:r}=await e.read();return t?{done:!0,value:void 0}:{done:!1,value:r}}}},r}g=rs;var ro={type:"no-schema",jsonSchema:void 0,validatePartialResult:({value:e,textDelta:t})=>({success:!0,value:{partial:e,textDelta:t}}),validateFinalResult:e=>void 0===e?{success:!1,error:new ri}:{success:!0,value:e},createElementStream(){throw new eY({functionality:"element streams in no-schema mode"})}},rl=e=>({type:"object",jsonSchema:e.jsonSchema,validatePartialResult:({value:e,textDelta:t})=>({success:!0,value:{partial:e,textDelta:t}}),validateFinalResult:t=>e8({value:t,schema:e}),createElementStream(){throw new eY({functionality:"element streams in object mode"})}}),ru=e=>{let{$schema:t,...r}=e.jsonSchema;return{type:"enum",jsonSchema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:r}},required:["elements"],additionalProperties:!1},validatePartialResult({value:t,latestObject:r,isFirstDelta:n,isFinalDelta:s}){var i;if(!e0(t)||!eX(t.elements))return{success:!1,error:new eJ({value:t,cause:"value must be an object that contains an array of elements"})};let a=t.elements,o=[];for(let t=0;t<a.length;t++){let r=e8({value:a[t],schema:e});if(t!==a.length-1||s){if(!r.success)return r;o.push(r.value)}}let l=null!=(i=null==r?void 0:r.length)?i:0,u="";return n&&(u+="["),l>0&&(u+=","),u+=o.slice(l).map(e=>JSON.stringify(e)).join(","),s&&(u+="]"),{success:!0,value:{partial:o,textDelta:u}}},validateFinalResult(t){if(!e0(t)||!eX(t.elements))return{success:!1,error:new eJ({value:t,cause:"value must be an object that contains an array of elements"})};let r=t.elements;for(let t of r){let r=e8({value:t,schema:e});if(!r.success)return r}return{success:!0,value:r}},createElementStream(e){let t=0;return ra(e,{transform(e,r){switch(e.type){case"object":{let n=e.object;for(;t<n.length;t++)r.enqueue(n[t]);break}case"text-delta":case"finish":break;case"error":r.error(e.error);break;default:throw Error(`Unsupported chunk type: ${e}`)}}})}}},rc=e=>({type:"enum",jsonSchema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:e}},required:["result"],additionalProperties:!1},validateFinalResult(t){if(!e0(t)||"string"!=typeof t.result)return{success:!1,error:new eJ({value:t,cause:'value must be an object that contains a string in the "result" property.'})};let r=t.result;return e.includes(r)?{success:!0,value:r}:{success:!1,error:new eJ({value:t,cause:"value must be a string in the enum"})}},validatePartialResult(){throw new eY({functionality:"partial results in enum mode"})},createElementStream(){throw new eY({functionality:"element streams in enum mode"})}}),rd=e6({prefix:"aiobj-",size:24});async function rp({model:e,enum:t,schema:r,schemaName:n,schemaDescription:s,mode:i,output:a="object",system:o,prompt:l,messages:u,maxRetries:c,abortSignal:d,headers:p,experimental_telemetry:m,experimental_providerMetadata:f,_internal:{generateId:h=rd,currentDate:g=()=>new Date}={},...y}){var v;(function({output:e,mode:t,schema:r,schemaName:n,schemaDescription:s,enumValues:i}){if(null!=e&&"object"!==e&&"array"!==e&&"enum"!==e&&"no-schema"!==e)throw new tK({parameter:"output",value:e,message:"Invalid output type."});if("no-schema"===e){if("auto"===t||"tool"===t)throw new tK({parameter:"mode",value:t,message:'Mode must be "json" for no-schema output.'});if(null!=r)throw new tK({parameter:"schema",value:r,message:"Schema is not supported for no-schema output."});if(null!=s)throw new tK({parameter:"schemaDescription",value:s,message:"Schema description is not supported for no-schema output."});if(null!=n)throw new tK({parameter:"schemaName",value:n,message:"Schema name is not supported for no-schema output."});if(null!=i)throw new tK({parameter:"enumValues",value:i,message:"Enum values are not supported for no-schema output."})}if("object"===e){if(null==r)throw new tK({parameter:"schema",value:r,message:"Schema is required for object output."});if(null!=i)throw new tK({parameter:"enumValues",value:i,message:"Enum values are not supported for object output."})}if("array"===e){if(null==r)throw new tK({parameter:"schema",value:r,message:"Element schema is required for array output."});if(null!=i)throw new tK({parameter:"enumValues",value:i,message:"Enum values are not supported for array output."})}if("enum"===e){if(null!=r)throw new tK({parameter:"schema",value:r,message:"Schema is not supported for enum output."});if(null!=s)throw new tK({parameter:"schemaDescription",value:s,message:"Schema description is not supported for enum output."});if(null!=n)throw new tK({parameter:"schemaName",value:n,message:"Schema name is not supported for enum output."});if(null==i)throw new tK({parameter:"enumValues",value:i,message:"Enum values are required for enum output."});for(let e of i)if("string"!=typeof e)throw new tK({parameter:"enumValues",value:e,message:"Enum values must be strings."})}})({output:a,mode:i,schema:r,schemaName:n,schemaDescription:s,enumValues:t});let b=function({output:e,schema:t,enumValues:r}){switch(e){case"object":return rl(eS(t));case"array":return ru(eS(t));case"enum":return rc(r);case"no-schema":return ro;default:throw Error(`Unsupported output: ${e}`)}}({output:a,schema:r,enumValues:t});"no-schema"===b.type&&void 0===i&&(i="json");let _=tp({model:e,telemetry:m,headers:p,settings:{...y,maxRetries:c}}),w=ty({isEnabled:null!=(v=null==m?void 0:m.isEnabled)&&v});return tv({name:"ai.generateObject",attributes:tb({telemetry:m,attributes:{...td({operationId:"ai.generateObject",telemetry:m}),..._,"ai.prompt":{input:()=>JSON.stringify({system:o,prompt:l,messages:u})},"ai.schema":null!=b.jsonSchema?{input:()=>JSON.stringify(b.jsonSchema)}:void 0,"ai.schema.name":n,"ai.schema.description":s,"ai.settings.output":b.type,"ai.settings.mode":i}}),tracer:w,fn:async t=>{let r,a,v,S,x,T,k,E;let N=tu({maxRetries:c});switch(("auto"===i||null==i)&&(i=e.defaultObjectGenerationMode),i){case"json":{let t=t7({system:null==b.jsonSchema?rt({prompt:o}):e.supportsStructuredOutputs?o:rt({prompt:o,schema:b.jsonSchema}),prompt:l,messages:u}),c=await tU({prompt:t,modelSupportsImageUrls:e.supportsImageUrls}),A=t.type,O=await N(()=>tv({name:"ai.generateObject.doGenerate",attributes:tb({telemetry:m,attributes:{...td({operationId:"ai.generateObject.doGenerate",telemetry:m}),..._,"ai.prompt.format":{input:()=>A},"ai.prompt.messages":{input:()=>JSON.stringify(c)},"ai.settings.mode":i,"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":y.frequencyPenalty,"gen_ai.request.max_tokens":y.maxTokens,"gen_ai.request.presence_penalty":y.presencePenalty,"gen_ai.request.temperature":y.temperature,"gen_ai.request.top_k":y.topK,"gen_ai.request.top_p":y.topP}}),tracer:w,fn:async t=>{var r,i,a,o,l,u;let v=await e.doGenerate({mode:{type:"object-json",schema:b.jsonSchema,name:n,description:s},...tG(y),inputFormat:A,prompt:c,providerMetadata:f,abortSignal:d,headers:p});if(void 0===v.text)throw new ri;let _={id:null!=(i=null==(r=v.response)?void 0:r.id)?i:h(),timestamp:null!=(o=null==(a=v.response)?void 0:a.timestamp)?o:g(),modelId:null!=(u=null==(l=v.response)?void 0:l.modelId)?u:e.modelId};return t.setAttributes(tb({telemetry:m,attributes:{"ai.response.finishReason":v.finishReason,"ai.response.object":{output:()=>v.text},"ai.response.id":_.id,"ai.response.model":_.modelId,"ai.response.timestamp":_.timestamp.toISOString(),"ai.usage.promptTokens":v.usage.promptTokens,"ai.usage.completionTokens":v.usage.completionTokens,"ai.finishReason":v.finishReason,"ai.result.object":{output:()=>v.text},"gen_ai.response.finish_reasons":[v.finishReason],"gen_ai.response.id":_.id,"gen_ai.response.model":_.modelId,"gen_ai.usage.prompt_tokens":v.usage.promptTokens,"gen_ai.usage.completion_tokens":v.usage.completionTokens}})),{...v,objectText:v.text,responseData:_}}}));r=O.objectText,a=O.finishReason,v=O.usage,S=O.warnings,x=O.rawResponse,k=O.logprobs,E=O.providerMetadata,T=O.responseData;break}case"tool":{let t=t7({system:o,prompt:l,messages:u}),c=await tU({prompt:t,modelSupportsImageUrls:e.supportsImageUrls}),A=t.type,O=await N(()=>tv({name:"ai.generateObject.doGenerate",attributes:tb({telemetry:m,attributes:{...td({operationId:"ai.generateObject.doGenerate",telemetry:m}),..._,"ai.prompt.format":{input:()=>A},"ai.prompt.messages":{input:()=>JSON.stringify(c)},"ai.settings.mode":i,"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":y.frequencyPenalty,"gen_ai.request.max_tokens":y.maxTokens,"gen_ai.request.presence_penalty":y.presencePenalty,"gen_ai.request.temperature":y.temperature,"gen_ai.request.top_k":y.topK,"gen_ai.request.top_p":y.topP}}),tracer:w,fn:async t=>{var r,i,a,o,l,u,v,_;let w=await e.doGenerate({mode:{type:"object-tool",tool:{type:"function",name:null!=n?n:"json",description:null!=s?s:"Respond with a JSON object.",parameters:b.jsonSchema}},...tG(y),inputFormat:A,prompt:c,providerMetadata:f,abortSignal:d,headers:p}),S=null==(i=null==(r=w.toolCalls)?void 0:r[0])?void 0:i.args;if(void 0===S)throw new ri;let x={id:null!=(o=null==(a=w.response)?void 0:a.id)?o:h(),timestamp:null!=(u=null==(l=w.response)?void 0:l.timestamp)?u:g(),modelId:null!=(_=null==(v=w.response)?void 0:v.modelId)?_:e.modelId};return t.setAttributes(tb({telemetry:m,attributes:{"ai.response.finishReason":w.finishReason,"ai.response.object":{output:()=>S},"ai.response.id":x.id,"ai.response.model":x.modelId,"ai.response.timestamp":x.timestamp.toISOString(),"ai.usage.promptTokens":w.usage.promptTokens,"ai.usage.completionTokens":w.usage.completionTokens,"ai.finishReason":w.finishReason,"ai.result.object":{output:()=>S},"gen_ai.response.finish_reasons":[w.finishReason],"gen_ai.response.id":x.id,"gen_ai.response.model":x.modelId,"gen_ai.usage.input_tokens":w.usage.promptTokens,"gen_ai.usage.output_tokens":w.usage.completionTokens}})),{...w,objectText:S,responseData:x}}}));r=O.objectText,a=O.finishReason,v=O.usage,S=O.warnings,x=O.rawResponse,k=O.logprobs,E=O.providerMetadata,T=O.responseData;break}case void 0:throw Error("Model does not have a default object generation mode.");default:{let e=i;throw Error(`Unsupported mode: ${e}`)}}let A=e3({text:r});if(!A.success)throw A.error;let O=b.validateFinalResult(A.value);if(!O.success)throw O.error;return t.setAttributes(tb({telemetry:m,attributes:{"ai.response.finishReason":a,"ai.response.object":{output:()=>JSON.stringify(O.value)},"ai.usage.promptTokens":v.promptTokens,"ai.usage.completionTokens":v.completionTokens,"ai.finishReason":a,"ai.result.object":{output:()=>JSON.stringify(O.value)}}})),new rm({object:O.value,finishReason:a,usage:t5(v),warnings:S,response:{...T,headers:null==x?void 0:x.headers},logprobs:k,providerMetadata:E})}})}var rm=class{constructor(e){this.object=e.object,this.finishReason=e.finishReason,this.usage=e.usage,this.warnings=e.warnings,this.experimental_providerMetadata=e.providerMetadata,this.response=e.response,this.rawResponse={headers:e.response.headers},this.logprobs=e.logprobs}toJsonResponse(e){var t;return new Response(JSON.stringify(this.object),{status:null!=(t=null==e?void 0:e.status)?t:200,headers:re(e,{contentType:"application/json; charset=utf-8"})})}};function rf(){let e,t;return{promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}}function rh(){var e,t;return null!=(t=null==(e=null==globalThis?void 0:globalThis.performance)?void 0:e.now())?t:Date.now()}function rg(e,{contentType:t,dataStreamVersion:r}){let n={};if((null==e?void 0:e.headers)!=null)for(let[t,r]of Object.entries(e.headers))n[t]=r;return null==n["Content-Type"]&&(n["Content-Type"]=t),void 0!==r&&(n["X-Vercel-AI-Data-Stream"]=r),n}function ry({response:e,status:t,statusText:r,headers:n,stream:s}){e.writeHead(null!=t?t:200,r,n);let i=s.getReader();(async()=>{try{for(;;){let{done:t,value:r}=await i.read();if(t)break;e.write(r)}}catch(e){throw e}finally{e.end()}})()}e6({prefix:"aiobj-",size:24});var rv="AI_InvalidToolArgumentsError",rb=`vercel.ai.error.${rv}`,r_=Symbol.for(rb),rw=class extends eE{constructor({toolArgs:e,toolName:t,cause:r,message:n=`Invalid arguments for tool ${t}: ${e$(r)}`}){super({name:rv,message:n,cause:r}),this[y]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return eE.hasMarker(e,rb)}static isInvalidToolArgumentsError(e){return e instanceof Error&&e.name===rv&&"string"==typeof e.toolName&&"string"==typeof e.toolArgs}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,toolName:this.toolName,toolArgs:this.toolArgs}}};y=r_;var rS="AI_NoSuchToolError",rx=`vercel.ai.error.${rS}`,rT=Symbol.for(rx),rk=class extends eE{constructor({toolName:e,availableTools:t,message:r=`Model tried to call unavailable tool '${e}'. ${void 0===t?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:rS,message:r}),this[v]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return eE.hasMarker(e,rx)}static isNoSuchToolError(e){return e instanceof Error&&e.name===rS&&"toolName"in e&&void 0!=e.toolName&&"string"==typeof e.name}toJSON(){return{name:this.name,message:this.message,stack:this.stack,toolName:this.toolName,availableTools:this.availableTools}}};v=rT;var rE="AI_MessageConversionError",rN=`vercel.ai.error.${rE}`,rA=Symbol.for(rN),rO=class extends eE{constructor({originalMessage:e,message:t}){super({name:rE,message:t}),this[b]=!0,this.originalMessage=e}static isInstance(e){return eE.hasMarker(e,rN)}};b=rA;var rj=/^([\s\S]*?)(\s+)(\S*)$/;function r$({text:e="",toolCalls:t,toolResults:r}){let n=[];return n.push({role:"assistant",content:[{type:"text",text:e},...t]}),r.length>0&&n.push({role:"tool",content:r.map(e=>({type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:e.result}))}),n}function rI(e,t){let r,n;let s=e.getReader(),i=t.getReader(),a=!1,o=!1;async function l(e){try{null==r&&(r=s.read());let t=await r;r=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}async function u(e){try{null==n&&(n=i.read());let t=await n;n=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}return new ReadableStream({async pull(e){try{if(a){await u(e);return}if(o){await l(e);return}null==r&&(r=s.read()),null==n&&(n=i.read());let{result:t,reader:c}=await Promise.race([r.then(e=>({result:e,reader:s})),n.then(e=>({result:e,reader:i}))]);t.done||e.enqueue(t.value),c===s?(r=void 0,t.done&&(await u(e),a=!0)):(n=void 0,t.done&&(o=!0,await l(e)))}catch(t){e.error(t)}},cancel(){s.cancel(),i.cancel()}})}e6({prefix:"aitxt-",size:24});var rC=e6({prefix:"aitxt-",size:24});async function rP({model:e,tools:t,toolChoice:r,system:n,prompt:s,messages:i,maxRetries:a,abortSignal:o,headers:l,maxToolRoundtrips:u=0,maxSteps:c=null!=u?u+1:1,experimental_continueSteps:d=!1,experimental_telemetry:p,experimental_providerMetadata:m,experimental_toolCallStreaming:f=!1,onChunk:h,onFinish:g,onStepFinish:y,_internal:{now:v=rh,generateId:b=rC,currentDate:_=()=>new Date}={},...w}){var S;if(c<1)throw new tK({parameter:"maxSteps",value:c,message:"maxSteps must be at least 1"});let T=tp({model:e,telemetry:p,headers:l,settings:{...w,maxRetries:a}}),k=ty({isEnabled:null!=(S=null==p?void 0:p.isEnabled)&&S});return tv({name:"ai.streamText",attributes:tb({telemetry:p,attributes:{...td({operationId:"ai.streamText",telemetry:p}),...T,"ai.prompt":{input:()=>JSON.stringify({system:n,prompt:s,messages:i})},"ai.settings.maxSteps":c}}),tracer:k,endWhenDone:!1,fn:async u=>{let S=tu({maxRetries:a}),E=async({promptMessages:n,promptType:s})=>{let{result:{stream:i,warnings:a,rawResponse:u},doStreamSpan:c,startTimestampMs:d}=await S(()=>tv({name:"ai.streamText.doStream",attributes:tb({telemetry:p,attributes:{...td({operationId:"ai.streamText.doStream",telemetry:p}),...T,"ai.prompt.format":{input:()=>s},"ai.prompt.messages":{input:()=>JSON.stringify(n)},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":w.frequencyPenalty,"gen_ai.request.max_tokens":w.maxTokens,"gen_ai.request.presence_penalty":w.presencePenalty,"gen_ai.request.stop_sequences":w.stopSequences,"gen_ai.request.temperature":w.temperature,"gen_ai.request.top_k":w.topK,"gen_ai.request.top_p":w.topP}}),tracer:k,endWhenDone:!1,fn:async i=>({startTimestampMs:v(),doStreamSpan:i,result:await e.doStream({mode:{type:"regular",...function({tools:e,toolChoice:t}){return null!=e&&Object.keys(e).length>0?{tools:Object.entries(e).map(([e,t])=>({type:"function",name:e,description:t.description,parameters:eS(t.parameters).jsonSchema})),toolChoice:null==t?{type:"auto"}:"string"==typeof t?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}({tools:t,toolChoice:r})},...tG(w),inputFormat:s,prompt:n,providerMetadata:m,abortSignal:o,headers:l})})}));return{result:{stream:function({tools:e,generatorStream:t,toolCallStreaming:r,tracer:n,telemetry:s}){let i=!1,a=new Set,o=null,l=new ReadableStream({start(e){o=e}}),u={},c=new TransformStream({transform(t,l){let c=t.type;switch(c){case"text-delta":case"response-metadata":case"error":l.enqueue(t);break;case"tool-call-delta":r&&(u[t.toolCallId]||(l.enqueue({type:"tool-call-streaming-start",toolCallId:t.toolCallId,toolName:t.toolName}),u[t.toolCallId]=!0),l.enqueue({type:"tool-call-delta",toolCallId:t.toolCallId,toolName:t.toolName,argsTextDelta:t.argsTextDelta}));break;case"tool-call":{let r=t.toolName;if(null==e){o.enqueue({type:"error",error:new rk({toolName:t.toolName})});break}let u=e[r];if(null==u){o.enqueue({type:"error",error:new rk({toolName:t.toolName,availableTools:Object.keys(e)})});break}try{let r=function({toolCall:e,tools:t}){let r=e.toolName;if(null==t)throw new rk({toolName:e.toolName});let n=t[r];if(null==n)throw new rk({toolName:e.toolName,availableTools:Object.keys(t)});let s=eS(n.parameters),i=""===e.args.trim()?e8({value:{},schema:s}):e3({text:e.args,schema:s});if(!1===i.success)throw new rw({toolName:r,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:r,args:i.value}}({toolCall:t,tools:e});if(l.enqueue(r),null!=u.execute){let e=x();a.add(e),tv({name:"ai.toolCall",attributes:tb({telemetry:s,attributes:{...td({operationId:"ai.toolCall",telemetry:s}),"ai.toolCall.name":r.toolName,"ai.toolCall.id":r.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(r.args)}}}),tracer:n,fn:async t=>u.execute(r.args).then(n=>{o.enqueue({...r,type:"tool-result",result:n}),a.delete(e),i&&0===a.size&&o.close();try{t.setAttributes(tb({telemetry:s,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(n)}}}))}catch(e){}},t=>{o.enqueue({type:"error",error:t}),a.delete(e),i&&0===a.size&&o.close()})})}}catch(e){o.enqueue({type:"error",error:e})}break}case"finish":l.enqueue({type:"finish",finishReason:t.finishReason,logprobs:t.logprobs,usage:t5(t.usage),experimental_providerMetadata:t.providerMetadata});break;default:throw Error(`Unhandled chunk type: ${c}`)}},flush(){i=!0,0===a.size&&o.close()}});return new ReadableStream({start:async e=>Promise.all([t.pipeThrough(c).pipeTo(new WritableStream({write(t){e.enqueue(t)},close(){}})),l.pipeTo(new WritableStream({write(t){e.enqueue(t)},close(){e.close()}}))])})}({tools:t,generatorStream:i,toolCallStreaming:f,tracer:k,telemetry:p}),warnings:a,rawResponse:u},doStreamSpan:c,startTimestampMs:d}},N=await tU({prompt:t7({system:n,prompt:s,messages:i}),modelSupportsImageUrls:e.supportsImageUrls}),{result:{stream:A,warnings:O,rawResponse:j},doStreamSpan:$,startTimestampMs:I}=await E({promptType:t7({system:n,prompt:s,messages:i}).type,promptMessages:N});return new rz({stream:A,warnings:O,rawResponse:j,onChunk:h,onFinish:g,onStepFinish:y,rootSpan:u,doStreamSpan:$,telemetry:p,startTimestampMs:I,maxSteps:c,continueSteps:d,startStep:E,promptMessages:N,modelId:e.modelId,now:v,currentDate:_,generateId:b})}})}var rz=class{constructor({stream:e,warnings:t,rawResponse:r,onChunk:n,onFinish:s,onStepFinish:i,rootSpan:a,doStreamSpan:o,telemetry:l,startTimestampMs:u,maxSteps:c,continueSteps:d,startStep:p,promptMessages:m,modelId:f,now:h,currentDate:g,generateId:y}){this.warnings=t,this.rawResponse=r;let{resolve:v,promise:b}=rf();this.usage=b;let{resolve:_,promise:w}=rf();this.finishReason=w;let{resolve:S,promise:x}=rf();this.text=x;let{resolve:T,promise:k}=rf();this.toolCalls=k;let{resolve:E,promise:N}=rf();this.toolResults=N;let{resolve:A,promise:O}=rf();this.steps=O;let{resolve:j,promise:$}=rf();this.experimental_providerMetadata=$;let{resolve:I,promise:C}=rf();this.response=C;let{resolve:P,promise:z}=rf();this.responseMessages=z;let{stream:D,addStream:R,close:M}=function(){let e=[],t=null,r=!1,n=async()=>{if(r&&0===e.length){null==t||t.close();return}if(0!==e.length)try{let{value:s,done:i}=await e[0].read();i?(e.shift(),e.length>0?await n():r&&(null==t||t.close())):null==t||t.enqueue(s)}catch(n){null==t||t.error(n),e.shift(),r&&0===e.length&&(null==t||t.close())}};return{stream:new ReadableStream({start(e){t=e},pull:n,async cancel(){for(let t of e)await t.cancel();e=[],r=!0}}),addStream:t=>{if(r)throw Error("Cannot add inner stream: outer stream is closed");e.push(t.getReader())},close:()=>{r=!0,0===e.length&&(null==t||t.close())}}}();this.originalStream=D;let q=[],L=this;!function e({stream:o,startTimestamp:u,doStreamSpan:m,currentStep:b,promptMessages:w,usage:x={promptTokens:0,completionTokens:0,totalTokens:0},stepType:k,previousStepText:N=""}){let O,$;let C=[],z=[],D="unknown",Q={promptTokens:0,completionTokens:0,totalTokens:0},U=!0,Z="",B="continue"===k?N:"",F={id:y(),timestamp:g(),modelId:f},V="",J=!1;async function K({controller:e,chunk:t}){e.enqueue(t),Z+=t.textDelta,B+=t.textDelta,J=!0,await (null==n?void 0:n({chunk:t}))}R(o.pipeThrough(new TransformStream({async transform(e,t){var r,s,i;if(U){let e=h()-u;U=!1,m.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":e,"ai.stream.msToFirstChunk":e}),m.setAttributes({"ai.response.msToFirstChunk":e,"ai.stream.msToFirstChunk":e})}if("text-delta"===e.type&&0===e.textDelta.length)return;let a=e.type;switch(a){case"text-delta":if(d){let r=function(e){let t=e.match(rj);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}(V+=e.textDelta);null!=r&&(V=r.suffix,await K({controller:t,chunk:{type:"text-delta",textDelta:r.prefix+r.whitespace}}))}else await K({controller:t,chunk:e});break;case"tool-call":t.enqueue(e),C.push(e),await (null==n?void 0:n({chunk:e}));break;case"tool-result":t.enqueue(e),z.push(e),await (null==n?void 0:n({chunk:e}));break;case"response-metadata":F={id:null!=(r=e.id)?r:F.id,timestamp:null!=(s=e.timestamp)?s:F.timestamp,modelId:null!=(i=e.modelId)?i:F.modelId};break;case"finish":{Q=e.usage,D=e.finishReason,O=e.experimental_providerMetadata,$=e.logprobs;let t=h()-u;m.addEvent("ai.stream.finish"),m.setAttributes({"ai.response.msToFinish":t,"ai.response.avgCompletionTokensPerSecond":1e3*Q.completionTokens/t});break}case"tool-call-streaming-start":case"tool-call-delta":t.enqueue(e),await (null==n?void 0:n({chunk:e}));break;case"error":t.enqueue(e),D="error";break;default:throw Error(`Unknown chunk type: ${a}`)}},async flush(n){let o=C.length>0?JSON.stringify(C):void 0,u="done";b+1<c&&(d&&"length"===D&&0===C.length?u="continue":C.length>0&&z.length===C.length&&(u="tool-result")),d&&V.length>0&&("continue"!==u||"continue"===k&&!J)&&(await K({controller:n,chunk:{type:"text-delta",textDelta:V}}),V="");try{m.setAttributes(tb({telemetry:l,attributes:{"ai.response.finishReason":D,"ai.response.text":{output:()=>Z},"ai.response.toolCalls":{output:()=>o},"ai.response.id":F.id,"ai.response.model":F.modelId,"ai.response.timestamp":F.timestamp.toISOString(),"ai.usage.promptTokens":Q.promptTokens,"ai.usage.completionTokens":Q.completionTokens,"ai.finishReason":D,"ai.result.text":{output:()=>Z},"ai.result.toolCalls":{output:()=>o},"gen_ai.response.finish_reasons":[D],"gen_ai.response.id":F.id,"gen_ai.response.model":F.modelId,"gen_ai.usage.input_tokens":Q.promptTokens,"gen_ai.usage.output_tokens":Q.completionTokens}}))}catch(e){}finally{m.end()}n.enqueue({type:"step-finish",finishReason:D,usage:Q,experimental_providerMetadata:O,logprobs:$,response:F,isContinued:"continue"===u});let f={stepType:k,text:Z,toolCalls:C,toolResults:z,finishReason:D,usage:Q,warnings:L.warnings,logprobs:$,response:F,rawResponse:L.rawResponse,experimental_providerMetadata:O,isContinued:"continue"===u};q.push(f),await (null==i?void 0:i(f));let h={promptTokens:x.promptTokens+Q.promptTokens,completionTokens:x.completionTokens+Q.completionTokens,totalTokens:x.totalTokens+Q.totalTokens};if("done"!==u){"continue"===k?w[w.length-1].content.push({text:Z,type:"text"}):w.push(...r$({text:Z,toolCalls:C,toolResults:z}).map(e=>tZ(e,null)));let{result:t,doStreamSpan:r,startTimestampMs:n}=await p({promptType:"messages",promptMessages:w});L.warnings=t.warnings,L.rawResponse=t.rawResponse,e({stream:t.stream,startTimestamp:n,doStreamSpan:r,currentStep:b+1,promptMessages:w,usage:h,stepType:u,previousStepText:B});return}try{n.enqueue({type:"finish",finishReason:D,usage:h,experimental_providerMetadata:O,logprobs:$,response:F}),M(),a.setAttributes(tb({telemetry:l,attributes:{"ai.response.finishReason":D,"ai.response.text":{output:()=>B},"ai.response.toolCalls":{output:()=>o},"ai.usage.promptTokens":h.promptTokens,"ai.usage.completionTokens":h.completionTokens,"ai.finishReason":D,"ai.result.text":{output:()=>B},"ai.result.toolCalls":{output:()=>o}}}));let e=q.reduce((e,t)=>{if("continue"===t.stepType){let r=e.pop();return"string"==typeof r.content?r.content+=t.text:r.content.push({text:t.text,type:"text"}),[...e,r]}return[...e,...r$({text:t.text,toolCalls:t.toolCalls,toolResults:t.toolResults})]},[]);v(h),_(D),S(B),T(C),j(O),E(z),I({...F,headers:null==r?void 0:r.headers}),A(q),P(e),await (null==s?void 0:s({finishReason:D,logprobs:$,usage:h,text:B,toolCalls:C,toolResults:z,rawResponse:r,response:{...F,headers:null==r?void 0:r.headers},warnings:t,experimental_providerMetadata:O,steps:q,responseMessages:e}))}catch(e){n.error(e)}finally{a.end()}}})))}({stream:e,startTimestamp:u,doStreamSpan:o,currentStep:0,promptMessages:m,usage:void 0,stepType:"initial"})}teeStream(){let[e,t]=this.originalStream.tee();return this.originalStream=t,e}get textStream(){return ra(this.teeStream(),{transform(e,t){"text-delta"===e.type?t.enqueue(e.textDelta):"error"===e.type&&t.error(e.error)}})}get fullStream(){return ra(this.teeStream(),{transform(e,t){t.enqueue(e)}})}toAIStream(e={}){return this.toDataStreamInternal({callbacks:e})}toDataStreamInternal({callbacks:e={},getErrorMessage:t=()=>"",sendUsage:r=!0}={}){let n="",s=new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(t,r){if(r.enqueue(t),"text-delta"===t.type){let r=t.textDelta;n+=r,e.onToken&&await e.onToken(r),e.onText&&await e.onText(r)}},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}}),i=new TransformStream({transform:async(e,n)=>{let s=e.type;switch(s){case"text-delta":n.enqueue(e_("text",e.textDelta));break;case"tool-call-streaming-start":n.enqueue(e_("tool_call_streaming_start",{toolCallId:e.toolCallId,toolName:e.toolName}));break;case"tool-call-delta":n.enqueue(e_("tool_call_delta",{toolCallId:e.toolCallId,argsTextDelta:e.argsTextDelta}));break;case"tool-call":n.enqueue(e_("tool_call",{toolCallId:e.toolCallId,toolName:e.toolName,args:e.args}));break;case"tool-result":n.enqueue(e_("tool_result",{toolCallId:e.toolCallId,result:e.result}));break;case"error":n.enqueue(e_("error",t(e.error)));break;case"step-finish":n.enqueue(e_("finish_step",{finishReason:e.finishReason,usage:r?{promptTokens:e.usage.promptTokens,completionTokens:e.usage.completionTokens}:void 0,isContinued:e.isContinued}));break;case"finish":n.enqueue(e_("finish_message",{finishReason:e.finishReason,usage:r?{promptTokens:e.usage.promptTokens,completionTokens:e.usage.completionTokens}:void 0}));break;default:throw Error(`Unknown chunk type: ${s}`)}}});return this.fullStream.pipeThrough(s).pipeThrough(i).pipeThrough(new TextEncoderStream)}pipeAIStreamToResponse(e,t){return this.pipeDataStreamToResponse(e,t)}pipeDataStreamToResponse(e,t){let r=null==t?void 0:"init"in t?t.init:{headers:"headers"in t?t.headers:void 0,status:"status"in t?t.status:void 0,statusText:"statusText"in t?t.statusText:void 0},n=null==t?void 0:"data"in t?t.data:void 0,s=null==t?void 0:"getErrorMessage"in t?t.getErrorMessage:void 0,i=null==t?void 0:"sendUsage"in t?t.sendUsage:void 0;ry({response:e,status:null==r?void 0:r.status,statusText:null==r?void 0:r.statusText,headers:rg(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:n,getErrorMessage:s,sendUsage:i})})}pipeTextStreamToResponse(e,t){ry({response:e,status:null==t?void 0:t.status,statusText:null==t?void 0:t.statusText,headers:rg(t,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toAIStreamResponse(e){return this.toDataStreamResponse(e)}toDataStream(e){let t=this.toDataStreamInternal({getErrorMessage:null==e?void 0:e.getErrorMessage,sendUsage:null==e?void 0:e.sendUsage});return(null==e?void 0:e.data)?rI(null==e?void 0:e.data.stream,t):t}toDataStreamResponse(e){var t;let r=null==e?void 0:"init"in e?e.init:{headers:"headers"in e?e.headers:void 0,status:"status"in e?e.status:void 0,statusText:"statusText"in e?e.statusText:void 0},n=null==e?void 0:"data"in e?e.data:void 0,s=null==e?void 0:"getErrorMessage"in e?e.getErrorMessage:void 0,i=null==e?void 0:"sendUsage"in e?e.sendUsage:void 0;return new Response(this.toDataStream({data:n,getErrorMessage:s,sendUsage:i}),{status:null!=(t=null==r?void 0:r.status)?t:200,statusText:null==r?void 0:r.statusText,headers:re(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:null!=(t=null==e?void 0:e.status)?t:200,headers:re(e,{contentType:"text/plain; charset=utf-8"})})}};function rD(e){let t=[];for(let r of e){let{role:e,content:n,toolInvocations:s,experimental_attachments:i}=r;switch(e){case"system":t.push({role:"system",content:n});break;case"user":t.push({role:"user",content:i?[{type:"text",text:n},...function(e){var t,r,n;let s=[];for(let i of e){let e;try{e=new URL(i.url)}catch(e){throw Error(`Invalid URL: ${i.url}`)}switch(e.protocol){case"http:":case"https:":if(null==(t=i.contentType)?void 0:t.startsWith("image/"))s.push({type:"image",image:e});else{if(!i.contentType)throw Error("If the attachment is not an image, it must specify a content type");s.push({type:"file",data:e,mimeType:i.contentType})}break;case"data:":{let e,t,a;try{[e,t]=i.url.split(","),a=e.split(";")[0].split(":")[1]}catch(e){throw Error(`Error processing data URL: ${i.url}`)}if(null==a||null==t)throw Error(`Invalid data URL format: ${i.url}`);if(null==(r=i.contentType)?void 0:r.startsWith("image/"))s.push({type:"image",image:tD(t)});else if(null==(n=i.contentType)?void 0:n.startsWith("text/"))s.push({type:"text",text:function(e){try{return new TextDecoder().decode(e)}catch(e){throw Error("Error decoding Uint8Array to text")}}(tD(t))});else{if(!i.contentType)throw Error("If the attachment is not an image or text, it must specify a content type");s.push({type:"file",data:t,mimeType:i.contentType})}break}default:throw Error(`Unsupported URL protocol: ${e.protocol}`)}}return s}(i)]:n});break;case"assistant":if(null==s){t.push({role:"assistant",content:n});break}t.push({role:"assistant",content:[{type:"text",text:n},...s.map(({toolCallId:e,toolName:t,args:r})=>({type:"tool-call",toolCallId:e,toolName:t,args:r}))]}),t.push({role:"tool",content:s.map(e=>{if(!("result"in e))throw new rO({originalMessage:r,message:"ToolInvocation must have a result: "+JSON.stringify(e)});let{toolCallId:t,toolName:n,args:s,result:i}=e;return{type:"tool-result",toolCallId:t,toolName:n,args:s,result:i}})});break;case"function":case"data":case"tool":break;default:throw new rO({originalMessage:r,message:`Unsupported role: ${e}`})}}return t}var rR="AI_NoSuchProviderError",rM=`vercel.ai.error.${rR}`;function rq(e){return e}function rL(e){let t=new TextEncoder,r="",n=e||{};return new TransformStream({async start(){n.onStart&&await n.onStart()},async transform(e,s){let i="string"==typeof e?e:e.content;s.enqueue(t.encode(i)),r+=i,n.onToken&&await n.onToken(i),n.onText&&"string"==typeof e&&await n.onText(e)},async flush(){n.onCompletion&&await n.onCompletion(r),!n.onFinal||"experimental_onFunctionCall"in n||await n.onFinal(r)}})}_=Symbol.for(rM);function rQ(){let e=new TextEncoder,t=new TextDecoder;return new TransformStream({transform:async(r,n)=>{let s=t.decode(r);n.enqueue(e.encode(e_("text",s)))}})}new TextDecoder("utf-8");function rU(e,t){return rZ(e,t)}function rZ(e,t){return e.pipeThrough(new TransformStream({transform:async(e,t)=>{var r;if("string"==typeof e){t.enqueue(e);return}if("event"in e){"on_chat_model_stream"===e.event&&rF(null==(r=e.data)?void 0:r.chunk,t);return}rF(e,t)}})).pipeThrough(rL(t)).pipeThrough(rQ())}function rB(e,t){var r;let n=rZ(e,null==t?void 0:t.callbacks),s=null==t?void 0:t.data,i=null==t?void 0:t.init;return new Response(s?rI(s.stream,n):n,{status:null!=(r=null==i?void 0:i.status)?r:200,statusText:null==i?void 0:i.statusText,headers:re(i,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function rF(e,t){if("string"==typeof e.content)t.enqueue(e.content);else for(let r of e.content)"text"===r.type&&t.enqueue(r.text)}function rV(e,t){return(function(e){let t;let r=e[Symbol.asyncIterator](),n=(t=!0,e=>(t&&(e=e.trimStart())&&(t=!1),e));return new ReadableStream({async pull(e){var t;let{value:s,done:i}=await r.next();if(i){e.close();return}let a=n(null!=(t=s.delta)?t:"");a&&e.enqueue(a)}})})(e).pipeThrough(rL(t)).pipeThrough(rQ())}function rJ(e,t={}){var r;let{init:n,data:s,callbacks:i}=t,a=rV(e,i);return new Response(s?rI(s.stream,a):a,{status:null!=(r=null==n?void 0:n.status)?r:200,statusText:null==n?void 0:n.statusText,headers:re(n,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}tn({},{toAIStream:()=>rU,toDataStream:()=>rZ,toDataStreamResponse:()=>rB}),tn({},{toDataStream:()=>rV,toDataStreamResponse:()=>rJ});Symbol("internal_openai_fn_messages"),Response},5418:(e,t,r)=>{"use strict";r.d(t,{L:()=>s});var n=r(9326);class s{static [n.Q]="ColumnBuilder";config;constructor(e,t,r){this.config={name:e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}}},3596:(e,t,r)=>{"use strict";r.d(t,{s:()=>s});var n=r(9326);class s{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType}static [n.Q]="Column";name;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}}},9326:(e,t,r)=>{"use strict";r.d(t,{Q:()=>n,is:()=>s});let n=Symbol.for("drizzle:entityKind");function s(e,t){if(!e||"object"!=typeof e)return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,n))throw Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=e.constructor;if(r)for(;r;){if(n in r&&r[n]===t[n])return!0;r=Object.getPrototypeOf(r)}return!1}Symbol.for("drizzle:hasOwnEntityKind")},2596:(e,t,r)=>{"use strict";r.d(t,{pK:()=>v,df:()=>g,b1:()=>h});var n=r(5418),s=r(3596),i=r(9326),a=r(8324);class o{static [i.Q]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:t,columns:r,foreignColumns:n}=e();return{name:t,columns:r,foreignTable:n[0].table,foreignColumns:n}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=void 0===e?"no action":e,this}onDelete(e){return this._onDelete=void 0===e?"no action":e,this}build(e){return new l(e,this)}}class l{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static [i.Q]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),n=t.map(e=>e.name),s=r.map(e=>e.name),i=[this.table[a.YA.Symbol.Name],...n,r[0].table[a.YA.Symbol.Name],...s];return e??`${i.join("_")}_fk`}}var u=r(9082);function c(e,t){return`${e[a.YA.Symbol.Name]}_${t.join("_")}_unique`}class d{constructor(e,t){this.name=t,this.columns=e}static [i.Q]=null;columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new m(e,this.columns,this.nullsNotDistinctConfig,this.name)}}class p{static [i.Q]=null;name;constructor(e){this.name=e}on(...e){return new d(e,this.name)}}class m{constructor(e,t,r,n){this.table=e,this.columns=t,this.name=n??c(this.table,this.columns.map(e=>e.name)),this.nullsNotDistinct=r}static [i.Q]=null;columns;name;nullsNotDistinct=!1;getName(){return this.name}}function f(e,t,r){for(let n=t;n<e.length;n++){let s=e[n];if("\\"===s){n++;continue}if('"'===s)return[e.slice(t,n).replace(/\\/g,""),n+1];if(!r&&(","===s||"}"===s))return[e.slice(t,n).replace(/\\/g,""),n]}return[e.slice(t).replace(/\\/g,""),e.length]}class h extends n.L{foreignKeyConfigs=[];static [i.Q]="PgColumnBuilder";array(e){return new b(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:n})=>(0,u.t)((r,n)=>{let s=new o(()=>({columns:[e],foreignColumns:[r()]}));return n.onUpdate&&s.onUpdate(n.onUpdate),n.onDelete&&s.onDelete(n.onDelete),s.build(t)},r,n))}buildExtraConfigColumn(e){return new y(e,this.config)}}class g extends s.s{constructor(e,t){t.uniqueName||(t.uniqueName=c(e,[t.name])),super(e,t),this.table=e}static [i.Q]="PgColumn"}class y extends g{static [i.Q]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}}class v{static [i.Q]="IndexedColumn";constructor(e,t,r){this.name=e,this.type=t,this.indexConfig=r}name;type;indexConfig}class b extends h{static [i.Q]="PgArrayBuilder";constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){let t=this.config.baseBuilder.build(e);return new _(e,this.config,t)}}class _ extends g{constructor(e,t,r,n){super(e,t),this.baseColumn=r,this.range=n,this.size=t.size}size;static [i.Q]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(e){return"string"==typeof e&&(e=function(e){let[t]=function e(t,r=0){let n=[],s=r,i=!1;for(;s<t.length;){let a=t[s];if(","===a){(i||s===r)&&n.push(""),i=!0,s++;continue}if(i=!1,"\\"===a){s+=2;continue}if('"'===a){let[e,r]=f(t,s+1,!0);n.push(e),s=r;continue}if("}"===a)return[n,s+1];if("{"===a){let[r,i]=e(t,s+1);n.push(r),s=i;continue}let[o,l]=f(t,s,!1);n.push(o),s=l}return[n,s]}(e,1);return t}(e)),e.map(e=>this.baseColumn.mapFromDriverValue(e))}mapToDriverValue(e,t=!1){let r=e.map(e=>null===e?null:(0,i.is)(this.baseColumn,_)?this.baseColumn.mapToDriverValue(e,!0):this.baseColumn.mapToDriverValue(e));return t?r:function e(t){return`{${t.map(t=>Array.isArray(t)?e(t):"string"==typeof t?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}(r)}}},2182:(e,t,r)=>{"use strict";r.d(t,{M:()=>a});var n=r(9326),s=r(2315),i=r(2596);class a extends i.b1{static [n.Q]="PgDateColumnBaseBuilder";defaultNow(){return this.default((0,s.i6)`now()`)}}},2140:(e,t,r)=>{"use strict";r.d(t,{fL:()=>o});var n=r(9326),s=r(2596);class i extends s.b1{static [n.Q]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new a(e,this.config)}}class a extends s.df{static [n.Q]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function o(e,t={}){return new i(e,t)}},1575:(e,t,r)=>{"use strict";r.d(t,{AB:()=>c,bf:()=>u,sC:()=>o});var n=r(9326),s=r(2596),i=r(2182);class a extends i.M{static [n.Q]="PgTimestampBuilder";constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new o(e,this.config)}}class o extends s.df{static [n.Q]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":` (${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()}class l extends i.M{static [n.Q]="PgTimestampStringBuilder";constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new u(e,this.config)}}class u extends s.df{static [n.Q]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}}function c(e,t={}){return"string"===t.mode?new l(e,t.withTimezone??!1,t.precision):new a(e,t.withTimezone??!1,t.precision)}},967:(e,t,r)=>{"use strict";r.d(t,{RX:()=>o});var n=r(9326),s=r(2315),i=r(2596);class a extends i.b1{static [n.Q]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default((0,s.i6)`gen_random_uuid()`)}build(e){return new o(e,this.config)}}class o extends i.df{static [n.Q]="PgUUID";getSQLType(){return"uuid"}}},1401:(e,t,r)=>{"use strict";r.d(t,{L7:()=>o,qX:()=>a});var n=r(9326),s=r(2596);class i extends s.b1{static [n.Q]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new a(e,this.config)}}class a extends s.df{static [n.Q]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function o(e,t={}){return new i(e,t)}},5867:(e,t,r)=>{"use strict";r.d(t,{xr:()=>o});var n=r(9326),s=r(2596);class i extends s.b1{static [n.Q]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new a(e,this.config)}}class a extends s.df{static [n.Q]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function o(e,t){return new i(e,t)}},8483:(e,t,r)=>{"use strict";r.d(t,{Kz:()=>u});var n=r(2315),s=r(9326),i=r(2596);class a{constructor(e,t){this.unique=e,this.name=t}static [s.Q]="PgIndexBuilderOn";on(...e){return new o(e.map(e=>{if((0,s.is)(e,n.$s))return e;let t=new i.pK(e.name,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),t}),this.unique,!1,this.name)}onOnly(...e){return new o(e.map(e=>{if((0,s.is)(e,n.$s))return e;let t=new i.pK(e.name,e.columnType,e.indexConfig);return e.indexConfig=e.defaultConfig,t}),this.unique,!0,this.name)}using(e,...t){return new o(t.map(e=>{if((0,s.is)(e,n.$s))return e;let t=new i.pK(e.name,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),t}),this.unique,!0,this.name,e)}}class o{static [s.Q]="PgIndexBuilder";config;constructor(e,t,r,n,s="btree"){this.config={name:n,columns:e,unique:t,only:r,method:s}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new l(this.config,e)}}class l{static [s.Q]="PgIndex";config;constructor(e,t){this.config={...e,table:t}}}function u(e){return new a(!1,e)}},8324:(e,t,r)=>{"use strict";r.d(t,{YA:()=>a,af:()=>o});var n=r(9326),s=r(298);let i=Symbol.for("drizzle:PgInlineForeignKeys");class a extends s.iA{static [n.Q]="PgTable";static Symbol=Object.assign({},s.iA.Symbol,{InlineForeignKeys:i});[i]=[];[s.iA.Symbol.ExtraConfigBuilder]=void 0}let o=(e,t,r)=>(function(e,t,r,n,o=e){let l=new a(e,n,o),u=Object.fromEntries(Object.entries(t).map(([e,t])=>{let r=t.build(l);return l[i].push(...t.buildForeignKeys(r,l)),[e,r]})),c=Object.fromEntries(Object.entries(t).map(([e,t])=>[e,t.buildExtraConfigColumn(l)])),d=Object.assign(l,u);return d[s.iA.Symbol.Columns]=u,d[s.iA.Symbol.ExtraConfigColumns]=c,r&&(d[a.Symbol.ExtraConfigBuilder]=r),d})(e,t,r,void 0)},3388:(e,t,r)=>{"use strict";r.d(t,{t:()=>eA});var n=r(9326);class s{static [n.Q]="ConsoleLogWriter";write(e){console.log(e)}}class i{static [n.Q]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new s}logQuery(e,t){let r=t.map(e=>{try{return JSON.stringify(e)}catch{return String(e)}}),n=r.length?` -- params: [${r.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}}class a{static [n.Q]="NoopLogger";logQuery(){}}var o=r(3596),l=r(2315),u=r(298),c=r(7029);class d{constructor(e){this.table=e}static [n.Q]="ColumnAliasProxyHandler";get(e,t){return"table"===t?this.table:e[t]}}class p{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static [n.Q]="TableAliasProxyHandler";get(e,t){if(t===u.iA.Symbol.IsAlias)return!0;if(t===u.iA.Symbol.Name||this.replaceOriginalName&&t===u.iA.Symbol.OriginalName)return this.alias;if(t===c.d)return{...e[c.d],name:this.alias,isAlias:!0};if(t===u.iA.Symbol.Columns){let t=e[u.iA.Symbol.Columns];if(!t)return t;let r={};return Object.keys(t).map(n=>{r[n]=new Proxy(t[n],new d(new Proxy(e,this)))}),r}let r=e[t];return(0,n.is)(r,o.s)?new Proxy(r,new d(new Proxy(e,this))):r}}class m{constructor(e){this.alias=e}static [n.Q]=null;get(e,t){return"sourceTable"===t?f(e.sourceTable,this.alias):e[t]}}function f(e,t){return new Proxy(e,new p(t,!1))}function h(e,t){return new Proxy(e,new d(new Proxy(e.table,new p(t,!1))))}function g(e,t){return new l.$s.Aliased(y(e.sql,t),e.fieldAlias)}function y(e,t){return l.i6.join(e.queryChunks.map(e=>(0,n.is)(e,o.s)?h(e,t):(0,n.is)(e,l.$s)?y(e,t):(0,n.is)(e,l.$s.Aliased)?g(e,t):e))}class v extends Error{static [n.Q]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}}class b extends v{static [n.Q]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}var _=r(2596);class w extends _.b1{static [n.Q]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new S(e,this.config)}}class S extends _.df{static [n.Q]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}class x extends _.b1{static [n.Q]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new T(e,this.config)}}class T extends _.df{static [n.Q]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}class k extends _.b1{static [n.Q]="PgNumericBuilder";constructor(e,t,r){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new E(e,this.config)}}class E extends _.df{static [n.Q]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}var N=r(2182);class A extends N.M{constructor(e,t,r){super(e,"string","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}static [n.Q]="PgTimeBuilder";build(e){return new O(e,this.config)}}class O extends _.df{static [n.Q]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`time${e}${this.withTimezone?" with time zone":""}`}}var j=r(1575);class $ extends N.M{static [n.Q]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new I(e,this.config)}}class I extends _.df{static [n.Q]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}class C extends N.M{static [n.Q]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new P(e,this.config)}}class P extends _.df{static [n.Q]="PgDateString";getSQLType(){return"date"}}var z=r(967),D=r(8324);class R{static [n.Q]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new M(e,this.columns,this.name)}}class M{constructor(e,t,r){this.table=e,this.columns=t,this.name=r}static [n.Q]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[D.YA.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}var q=r(7745),L=r(1445);class Q{constructor(e,t,r){this.sourceTable=e,this.referencedTable=t,this.relationName=r,this.referencedTableName=t[u.iA.Symbol.Name]}static [n.Q]="Relation";referencedTableName;fieldName}class U{constructor(e,t){this.table=e,this.config=t}static [n.Q]="Relations"}class Z extends Q{constructor(e,t,r,n){super(e,t,r?.relationName),this.config=r,this.isNullable=n}static [n.Q]="One";withFieldName(e){let t=new Z(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}}class B extends Q{constructor(e,t,r){super(e,t,r?.relationName),this.config=r}static [n.Q]="Many";withFieldName(e){let t=new B(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}}function F(e){return{one:function(t,r){return new Z(e,t,r,r?.fields.reduce((e,t)=>e&&t.notNull,!0)??!1)},many:function(t,r){return new B(e,t,r)}}}var V=r(8586),J=r(9237);class K extends l.G7{static [n.Q]="PgViewBase"}class G{static [n.Q]="PgDialect";async migrate(e,t,r){let n="string"==typeof r?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",s="string"==typeof r?"drizzle":r.migrationsSchema??"drizzle",i=(0,l.i6)`
			CREATE TABLE IF NOT EXISTS ${l.i6.identifier(s)}.${l.i6.identifier(n)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute((0,l.i6)`CREATE SCHEMA IF NOT EXISTS ${l.i6.identifier(s)}`),await t.execute(i);let a=(await t.all((0,l.i6)`select id, hash, created_at from ${l.i6.identifier(s)}.${l.i6.identifier(n)} order by created_at desc limit 1`))[0];await t.transaction(async t=>{for await(let r of e)if(!a||Number(a.created_at)<r.folderMillis){for(let e of r.sql)await t.execute(l.i6.raw(e));await t.execute((0,l.i6)`insert into ${l.i6.identifier(s)}.${l.i6.identifier(n)} ("hash", "created_at") values(${r.hash}, ${r.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[(0,l.i6)`with `];for(let[r,n]of e.entries())t.push((0,l.i6)`${l.i6.identifier(n._.alias)} as (${n._.sql})`),r<e.length-1&&t.push((0,l.i6)`, `);return t.push((0,l.i6)` `),l.i6.join(t)}buildDeleteQuery({table:e,where:t,returning:r,withList:n}){let s=this.buildWithCTE(n),i=r?(0,l.i6)` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,a=t?(0,l.i6)` where ${t}`:void 0;return(0,l.i6)`${s}delete from ${e}${a}${i}`}buildUpdateSet(e,t){let r=e[u.iA.Symbol.Columns],n=Object.keys(r).filter(e=>void 0!==t[e]||r[e]?.onUpdateFn!==void 0),s=n.length;return l.i6.join(n.flatMap((e,n)=>{let i=r[e],a=t[e]??l.i6.param(i.onUpdateFn(),i),o=(0,l.i6)`${l.i6.identifier(i.name)} = ${a}`;return n<s-1?[o,l.i6.raw(", ")]:[o]}))}buildUpdateQuery({table:e,set:t,where:r,returning:n,withList:s}){let i=this.buildWithCTE(s),a=this.buildUpdateSet(e,t),o=n?(0,l.i6)` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,u=r?(0,l.i6)` where ${r}`:void 0;return(0,l.i6)`${i}update ${e} set ${a}${u}${o}`}buildSelection(e,{isSingleTable:t=!1}={}){let r=e.length,s=e.flatMap(({field:e},s)=>{let i=[];if((0,n.is)(e,l.$s.Aliased)&&e.isSelectionField)i.push(l.i6.identifier(e.fieldAlias));else if((0,n.is)(e,l.$s.Aliased)||(0,n.is)(e,l.$s)){let r=(0,n.is)(e,l.$s.Aliased)?e.sql:e;t?i.push(new l.$s(r.queryChunks.map(e=>(0,n.is)(e,_.df)?l.i6.identifier(e.name):e))):i.push(r),(0,n.is)(e,l.$s.Aliased)&&i.push((0,l.i6)` as ${l.i6.identifier(e.fieldAlias)}`)}else(0,n.is)(e,o.s)&&(t?i.push(l.i6.identifier(e.name)):i.push(e));return s<r-1&&i.push((0,l.i6)`, `),i});return l.i6.join(s)}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:s,having:i,table:a,joins:d,orderBy:p,groupBy:m,limit:f,offset:h,lockingClause:g,distinct:y,setOperators:v}){let b,_,w;let S=r??(0,J.ZS)(t);for(let e of S){let t;if((0,n.is)(e.field,o.s)&&(0,u.SP)(e.field.table)!==((0,n.is)(a,V.k)?a._.alias:(0,n.is)(a,K)?a[c.d].name:(0,n.is)(a,l.$s)?void 0:(0,u.SP)(a))&&(t=e.field.table,!d?.some(({alias:e})=>e===(t[u.iA.Symbol.IsAlias]?u.SP(t):t[u.iA.Symbol.BaseName])))){let t=(0,u.SP)(e.field.table);throw Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}}let x=!d||0===d.length,T=this.buildWithCTE(e);y&&(b=!0===y?(0,l.i6)` distinct`:(0,l.i6)` distinct on (${l.i6.join(y.on,(0,l.i6)`, `)})`);let k=this.buildSelection(S,{isSingleTable:x}),E=(()=>{if((0,n.is)(a,u.iA)&&a[u.iA.Symbol.OriginalName]!==a[u.iA.Symbol.Name]){let e=(0,l.i6)`${l.i6.identifier(a[u.iA.Symbol.OriginalName])}`;return a[u.iA.Symbol.Schema]&&(e=(0,l.i6)`${l.i6.identifier(a[u.iA.Symbol.Schema])}.${e}`),(0,l.i6)`${e} ${l.i6.identifier(a[u.iA.Symbol.Name])}`}return a})(),N=[];if(d)for(let[e,t]of d.entries()){0===e&&N.push((0,l.i6)` `);let r=t.table,s=t.lateral?(0,l.i6)` lateral`:void 0;if((0,n.is)(r,D.YA)){let e=r[D.YA.Symbol.Name],n=r[D.YA.Symbol.Schema],i=r[D.YA.Symbol.OriginalName],a=e===i?void 0:t.alias;N.push((0,l.i6)`${l.i6.raw(t.joinType)} join${s} ${n?(0,l.i6)`${l.i6.identifier(n)}.`:void 0}${l.i6.identifier(i)}${a&&(0,l.i6)` ${l.i6.identifier(a)}`} on ${t.on}`)}else if((0,n.is)(r,l.G7)){let e=r[c.d].name,n=r[c.d].schema,i=r[c.d].originalName,a=e===i?void 0:t.alias;N.push((0,l.i6)`${l.i6.raw(t.joinType)} join${s} ${n?(0,l.i6)`${l.i6.identifier(n)}.`:void 0}${l.i6.identifier(i)}${a&&(0,l.i6)` ${l.i6.identifier(a)}`} on ${t.on}`)}else N.push((0,l.i6)`${l.i6.raw(t.joinType)} join${s} ${r} on ${t.on}`);e<d.length-1&&N.push((0,l.i6)` `)}let A=l.i6.join(N),O=s?(0,l.i6)` where ${s}`:void 0,j=i?(0,l.i6)` having ${i}`:void 0;p&&p.length>0&&(_=(0,l.i6)` order by ${l.i6.join(p,(0,l.i6)`, `)}`),m&&m.length>0&&(w=(0,l.i6)` group by ${l.i6.join(m,(0,l.i6)`, `)}`);let $=f?(0,l.i6)` limit ${f}`:void 0,I=h?(0,l.i6)` offset ${h}`:void 0,C=l.i6.empty();if(g){let e=(0,l.i6)` for ${l.i6.raw(g.strength)}`;g.config.of&&e.append((0,l.i6)` of ${l.i6.join(Array.isArray(g.config.of)?g.config.of:[g.config.of],(0,l.i6)`, `)}`),g.config.noWait?e.append((0,l.i6)` no wait`):g.config.skipLocked&&e.append((0,l.i6)` skip locked`),C.append(e)}let P=(0,l.i6)`${T}select${b} ${k} from ${E}${A}${O}${w}${j}${_}${$}${I}${C}`;return v.length>0?this.buildSetOperations(P,v):P}buildSetOperations(e,t){let[r,...n]=t;if(!r)throw Error("Cannot pass undefined values to any set operator");return 0===n.length?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),n)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:r,rightSelect:s,limit:i,orderBy:a,offset:o}}){let u;let c=(0,l.i6)`(${e.getSQL()}) `,d=(0,l.i6)`(${s.getSQL()})`;if(a&&a.length>0){let e=[];for(let t of a)if((0,n.is)(t,_.df))e.push(l.i6.identifier(t.name));else if((0,n.is)(t,l.$s)){for(let e=0;e<t.queryChunks.length;e++){let r=t.queryChunks[e];(0,n.is)(r,_.df)&&(t.queryChunks[e]=l.i6.identifier(r.name))}e.push((0,l.i6)`${t}`)}else e.push((0,l.i6)`${t}`);u=(0,l.i6)` order by ${l.i6.join(e,(0,l.i6)`, `)} `}let p=i?(0,l.i6)` limit ${i}`:void 0,m=l.i6.raw(`${t} ${r?"all ":""}`),f=o?(0,l.i6)` offset ${o}`:void 0;return(0,l.i6)`${c}${m}${d}${u}${p}${f}`}buildInsertQuery({table:e,values:t,onConflict:r,returning:s,withList:i}){let a=[],o=Object.entries(e[u.iA.Symbol.Columns]),c=o.map(([,e])=>l.i6.identifier(e.name));for(let[e,r]of t.entries()){let s=[];for(let[e,t]of o){let i=r[e];if(void 0===i||(0,n.is)(i,l.dO)&&void 0===i.value){if(void 0!==t.defaultFn){let e=t.defaultFn(),r=(0,n.is)(e,l.$s)?e:l.i6.param(e,t);s.push(r)}else if(t.default||void 0===t.onUpdateFn)s.push((0,l.i6)`default`);else{let e=t.onUpdateFn(),r=(0,n.is)(e,l.$s)?e:l.i6.param(e,t);s.push(r)}}else s.push(i)}a.push(s),e<t.length-1&&a.push((0,l.i6)`, `)}let d=this.buildWithCTE(i),p=l.i6.join(a),m=s?(0,l.i6)` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,f=r?(0,l.i6)` on conflict ${r}`:void 0;return(0,l.i6)`${d}insert into ${e} ${c} values ${p}${f}${m}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:r}){let n=t?(0,l.i6)` concurrently`:void 0,s=r?(0,l.i6)` with no data`:void 0;return(0,l.i6)`refresh materialized view${n} ${e}${s}`}prepareTyping(e){return(0,n.is)(e,S)||(0,n.is)(e,T)?"json":(0,n.is)(e,E)?"decimal":(0,n.is)(e,O)?"time":(0,n.is)(e,j.sC)||(0,n.is)(e,j.bf)?"timestamp":(0,n.is)(e,I)||(0,n.is)(e,P)?"date":(0,n.is)(e,z.RX)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:s,tableConfig:i,queryConfig:a,tableAlias:c,nestedQueryRelation:d,joinOn:p}){let m,b=[],_,w,S=[],x,T=[];if(!0===a)b=Object.entries(i.columns).map(([e,t])=>({dbKey:t.name,tsKey:e,field:h(t,c),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let s=Object.fromEntries(Object.entries(i.columns).map(([e,t])=>[e,h(t,c)]));if(a.where){let e="function"==typeof a.where?a.where(s,{and:q.xD,between:q.vX,eq:q.eq,exists:q.Gg,gt:q.gt,gte:q.eg,ilike:q.o$,inArray:q.d3,isNull:q.Ft,isNotNull:q.K0,like:q.vL,lt:q.lt,lte:q.G,ne:q.ne,not:q.ff,notBetween:q.OL,notExists:q.UN,notLike:q.Qg,notIlike:q.mM,notInArray:q.Nl,or:q.or,sql:l.i6}):a.where;x=e&&y(e,c)}let d=[],p=[];if(a.columns){let e=!1;for(let[t,r]of Object.entries(a.columns))void 0!==r&&t in i.columns&&(e||!0!==r||(e=!0),p.push(t));p.length>0&&(p=e?p.filter(e=>a.columns?.[e]===!0):Object.keys(i.columns).filter(e=>!p.includes(e)))}else p=Object.keys(i.columns);for(let e of p){let t=i.columns[e];d.push({tsKey:e,value:t})}let m=[];if(a.with&&(m=Object.entries(a.with).filter(e=>!!e[1]).map(([e,t])=>({tsKey:e,queryConfig:t,relation:i.relations[e]}))),a.extras)for(let[e,t]of Object.entries("function"==typeof a.extras?a.extras(s,{sql:l.i6}):a.extras))d.push({tsKey:e,value:g(t,c)});for(let{tsKey:e,value:t}of d)b.push({dbKey:(0,n.is)(t,l.$s.Aliased)?t.fieldAlias:i.columns[e].name,tsKey:e,field:(0,n.is)(t,o.s)?h(t,c):t,relationTableTsKey:void 0,isJson:!1,selection:[]});let f="function"==typeof a.orderBy?a.orderBy(s,{sql:l.i6,asc:L.d,desc:L.C}):a.orderBy??[];for(let{tsKey:s,queryConfig:i,relation:d}of(Array.isArray(f)||(f=[f]),S=f.map(e=>(0,n.is)(e,o.s)?h(e,c):y(e,c)),_=a.limit,w=a.offset,m)){let a=function(e,t,r){if((0,n.is)(r,Z)&&r.config)return{fields:r.config.fields,references:r.config.references};let s=t[(0,u.Q0)(r.referencedTable)];if(!s)throw Error(`Table "${r.referencedTable[u.iA.Symbol.Name]}" not found in schema`);let i=e[s];if(!i)throw Error(`Table "${s}" not found in schema`);let a=r.sourceTable,o=t[(0,u.Q0)(a)];if(!o)throw Error(`Table "${a[u.iA.Symbol.Name]}" not found in schema`);let l=[];for(let e of Object.values(i.relations))(r.relationName&&r!==e&&e.relationName===r.relationName||!r.relationName&&e.referencedTable===r.sourceTable)&&l.push(e);if(l.length>1)throw r.relationName?Error(`There are multiple relations with name "${r.relationName}" in table "${s}"`):Error(`There are multiple relations between "${s}" and "${r.sourceTable[u.iA.Symbol.Name]}". Please specify relation name`);if(l[0]&&(0,n.is)(l[0],Z)&&l[0].config)return{fields:l[0].config.references,references:l[0].config.fields};throw Error(`There is not enough information to infer relation "${o}.${r.fieldName}"`)}(t,r,d),o=r[(0,u.Q0)(d.referencedTable)],p=`${c}_${s}`,m=(0,q.xD)(...a.fields.map((e,t)=>(0,q.eq)(h(a.references[t],p),h(e,c)))),f=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:e[o],tableConfig:t[o],queryConfig:(0,n.is)(d,Z)?!0===i?{limit:1}:{...i,limit:1}:i,tableAlias:p,joinOn:m,nestedQueryRelation:d}),g=(0,l.i6)`${l.i6.identifier(p)}.${l.i6.identifier("data")}`.as(s);T.push({on:(0,l.i6)`true`,table:new V.k(f.sql,{},p),alias:p,joinType:"left",lateral:!0}),b.push({dbKey:s,tsKey:s,field:g,relationTableTsKey:o,isJson:!0,selection:f.selection})}}if(0===b.length)throw new v({message:`No fields selected for table "${i.tsName}" ("${c}")`});if(x=(0,q.xD)(p,x),d){let e=(0,l.i6)`json_build_array(${l.i6.join(b.map(({field:e,tsKey:t,isJson:r})=>r?(0,l.i6)`${l.i6.identifier(`${c}_${t}`)}.${l.i6.identifier("data")}`:(0,n.is)(e,l.$s.Aliased)?e.sql:e),(0,l.i6)`, `)})`;(0,n.is)(d,B)&&(e=(0,l.i6)`coalesce(json_agg(${e}${S.length>0?(0,l.i6)` order by ${l.i6.join(S,(0,l.i6)`, `)}`:void 0}), '[]'::json)`);let t=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:b}];void 0!==_||void 0!==w||S.length>0?(m=this.buildSelectQuery({table:f(s,c),fields:{},fieldsFlat:[{path:[],field:l.i6.raw("*")}],where:x,limit:_,offset:w,orderBy:S,setOperators:[]}),x=void 0,_=void 0,w=void 0,S=[]):m=f(s,c),m=this.buildSelectQuery({table:(0,n.is)(m,D.YA)?m:new V.k(m,{},c),fields:{},fieldsFlat:t.map(({field:e})=>({path:[],field:(0,n.is)(e,o.s)?h(e,c):e})),joins:T,where:x,limit:_,offset:w,orderBy:S,setOperators:[]})}else m=this.buildSelectQuery({table:f(s,c),fields:{},fieldsFlat:b.map(({field:e})=>({path:[],field:(0,n.is)(e,o.s)?h(e,c):e})),joins:T,where:x,limit:_,offset:w,orderBy:S,setOperators:[]});return{tableTsKey:i.tsName,sql:m,selection:b}}}class W{static [n.Q]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if("_"===t)return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===c.d)return{...e[c.d],selectedFields:new Proxy(e[c.d].selectedFields,this)};if("symbol"==typeof t)return e[t];let r=((0,n.is)(e,V.k)?e._.selectedFields:(0,n.is)(e,l.G7)?e[c.d].selectedFields:e)[t];if((0,n.is)(r,l.$s.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!r.isSelectionField)return r.sql;let e=r.clone();return e.isSelectionField=!0,e}if((0,n.is)(r,l.$s)){if("sql"===this.config.sqlBehavior)return r;throw Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return(0,n.is)(r,o.s)?this.config.alias?new Proxy(r,new d(new Proxy(r.table,new p(this.config.alias,this.config.replaceOriginalName??!1)))):r:"object"!=typeof r||null===r?r:new Proxy(r,new W(this.config))}}class Y{static [n.Q]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class H{static [n.Q]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}}var X=r(836);class ee{static [n.Q]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}from(e){let t;let r=!!this.fields;return t=this.fields?this.fields:(0,n.is)(e,V.k)?Object.fromEntries(Object.keys(e._.selectedFields).map(t=>[t,e[t]])):(0,n.is)(e,K)?e[c.d].selectedFields:(0,n.is)(e,l.$s)?{}:(0,J.SS)(e),new er({table:e,fields:t,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}class et extends Y{static [n.Q]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:r,session:n,dialect:s,withList:i,distinct:a}){super(),this.config={withList:i,table:e,fields:{...t},distinct:a,setOperators:[]},this.isPartialSelect=r,this.session=n,this.dialect=s,this._={selectedFields:t},this.tableName=(0,J.dP)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}createJoin(e){return(t,r)=>{let s=this.tableName,i=(0,J.dP)(t);if("string"==typeof i&&this.config.joins?.some(e=>e.alias===i))throw Error(`Alias "${i}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof s&&(this.config.fields={[s]:this.config.fields}),"string"==typeof i&&!(0,n.is)(t,l.$s))){let e=(0,n.is)(t,V.k)?t._.selectedFields:(0,n.is)(t,l.G7)?t[c.d].selectedFields:t[u.iA.Symbol.Columns];this.config.fields[i]=e}if("function"==typeof r&&(r=r(new Proxy(this.config.fields,new W({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:r,table:t,joinType:e,alias:i}),"string"==typeof i)switch(e){case"left":this.joinsNotNullableMap[i]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[i]=!0;break;case"inner":this.joinsNotNullableMap[i]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[i]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return r=>{let n="function"==typeof r?r(es()):r;if(!(0,J.ux)(this.getSelectedFields(),n.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new W({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new W({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new W({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new W({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=e:this.config.orderBy=e;return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new V.k(this.getSQL(),this.config.fields,e),new W({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new W({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class er extends et{static [n.Q]="PgSelect";_prepare(e){let{session:t,config:r,dialect:n,joinsNotNullableMap:s}=this;if(!t)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");return X.Z.startActiveSpan("drizzle.prepareQuery",()=>{let i=(0,J.ZS)(r.fields),a=t.prepareQuery(n.sqlToQuery(this.getSQL()),i,e,!0);return a.joinsNotNullableMap=s,a})}prepare(e){return this._prepare(e)}execute=e=>X.Z.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))}function en(e,t){return(r,n,...s)=>{let i=[n,...s].map(r=>({type:e,isAll:t,rightSelect:r}));for(let e of i)if(!(0,J.ux)(r.getSelectedFields(),e.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(i)}}(0,J.ef)(er,[H]);let es=()=>({union:ei,unionAll:ea,intersect:eo,intersectAll:el,except:eu,exceptAll:ec}),ei=en("union",!1),ea=en("union",!0),eo=en("intersect",!1),el=en("intersect",!0),eu=en("except",!1),ec=en("except",!0);class ed{static [n.Q]="PgQueryBuilder";dialect;$with(e){let t=this;return{as:r=>("function"==typeof r&&(r=r(t)),new Proxy(new V.S(r.getSQL(),r.getSelectedFields(),e,!0),new W({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...e){let t=this;return{select:function(r){return new ee({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(e){return new ee({fields:e??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})},selectDistinctOn:function(e,r){return new ee({fields:r??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:e}})}}}select(e){return new ee({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new ee({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new ee({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new G),this.dialect}}class ep{constructor(e,t,r,n){this.table=e,this.session=t,this.dialect=r,this.withList=n}static [n.Q]="PgUpdateBuilder";set(e){return new em(this.table,(0,J.M6)(this.table,e),this.session,this.dialect,this.withList)}}class em extends H{constructor(e,t,r,n,s){super(),this.session=r,this.dialect=n,this.config={set:t,table:e,withList:s}}static [n.Q]="PgUpdate";config;where(e){return this.config.where=e,this}returning(e=this.config.table[u.iA.Symbol.Columns]){return this.config.returning=(0,J.ZS)(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0)}prepare(e){return this._prepare(e)}execute=e=>this._prepare().execute(e);$dynamic(){return this}}class ef{constructor(e,t,r,n){this.table=e,this.session=t,this.dialect=r,this.withList=n}static [n.Q]="PgInsertBuilder";values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw Error("values() must be called with at least one value");let t=e.map(e=>{let t={},r=this.table[u.iA.Symbol.Columns];for(let s of Object.keys(e)){let i=e[s];t[s]=(0,n.is)(i,l.$s)?i:new l.dO(i,r[s])}return t});return new eh(this.table,t,this.session,this.dialect,this.withList)}}class eh extends H{constructor(e,t,r,n,s){super(),this.session=r,this.dialect=n,this.config={table:e,values:t,withList:s}}static [n.Q]="PgInsert";config;returning(e=this.config.table[u.iA.Symbol.Columns]){return this.config.returning=(0,J.ZS)(e),this}onConflictDoNothing(e={}){if(void 0===e.target)this.config.onConflict=(0,l.i6)`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(e.name)).join(","):this.dialect.escapeName(e.target.name);let r=e.where?(0,l.i6)` where ${e.where}`:void 0;this.config.onConflict=(0,l.i6)`(${l.i6.raw(t)})${r} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?(0,l.i6)` where ${e.where}`:void 0,r=e.targetWhere?(0,l.i6)` where ${e.targetWhere}`:void 0,n=e.setWhere?(0,l.i6)` where ${e.setWhere}`:void 0,s=this.dialect.buildUpdateSet(this.config.table,(0,J.M6)(this.config.table,e.set)),i="";return i=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(e.name)).join(","):this.dialect.escapeName(e.target.name),this.config.onConflict=(0,l.i6)`(${l.i6.raw(i)})${r} do update set ${s}${t}${n}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return X.Z.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}execute=e=>X.Z.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e));$dynamic(){return this}}class eg extends H{constructor(e,t,r,n){super(),this.session=t,this.dialect=r,this.config={table:e,withList:n}}static [n.Q]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[u.iA.Symbol.Columns]){return this.config.returning=(0,J.ZS)(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return X.Z.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}execute=e=>X.Z.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e));$dynamic(){return this}}class ey{constructor(e,t,r,n,s,i,a){this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=n,this.tableConfig=s,this.dialect=i,this.session=a}static [n.Q]="PgRelationalQueryBuilder";findMany(e){return new ev(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new ev(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class ev extends H{constructor(e,t,r,n,s,i,a,o,l){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=n,this.tableConfig=s,this.dialect=i,this.session=a,this.config=o,this.mode=l}static [n.Q]="PgRelationalQuery";_prepare(e){return X.Z.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:r}=this._toSQL();return this.session.prepareQuery(r,void 0,e,!0,(e,r)=>{let s=e.map(e=>(function e(t,r,s,i,a=e=>e){let u={};for(let[c,d]of i.entries())if(d.isJson){let i=r.relations[d.tsKey],o=s[c],l="string"==typeof o?JSON.parse(o):o;u[d.tsKey]=(0,n.is)(i,Z)?l&&e(t,t[d.relationTableTsKey],l,d.selection,a):l.map(r=>e(t,t[d.relationTableTsKey],r,d.selection,a))}else{let e;let t=a(s[c]),r=d.field;e=(0,n.is)(r,o.s)?r:(0,n.is)(r,l.$s)?r.decoder:r.sql.decoder,u[d.tsKey]=null===t?null:e.mapFromDriverValue(t)}return u})(this.schema,this.tableConfig,e,t.selection,r));return"first"===this.mode?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}execute(){return X.Z.startActiveSpan("drizzle.operation",()=>this._prepare().execute())}}class eb extends H{constructor(e,t,r,n){super(),this.execute=e,this.sql=t,this.query=r,this.mapBatchResult=n}static [n.Q]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}class e_ extends H{constructor(e,t,r){super(),this.session=t,this.dialect=r,this.config={view:e}}static [n.Q]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return X.Z.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}execute=e=>X.Z.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))}class ew{constructor(e,t,r){if(this.dialect=e,this.session=t,this._=r?{schema:r.schema,fullSchema:r.fullSchema,tableNamesMap:r.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(let[n,s]of Object.entries(this._.schema))this.query[n]=new ey(r.fullSchema,this._.schema,this._.tableNamesMap,r.fullSchema[n],s,e,t)}static [n.Q]="PgDatabase";query;$with(e){return{as:t=>("function"==typeof t&&(t=t(new ed)),new Proxy(new V.S(t.getSQL(),t.getSelectedFields(),e,!0),new W({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...e){let t=this;return{select:function(r){return new ee({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(r){return new ee({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})},selectDistinctOn:function(r,n){return new ee({fields:n??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:r}})},update:function(r){return new ep(r,t.session,t.dialect,e)},insert:function(r){return new ef(r,t.session,t.dialect,e)},delete:function(r){return new eg(r,t.session,t.dialect,e)}}}select(e){return new ee({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new ee({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new ee({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new ep(e,this.session,this.dialect)}insert(e){return new ef(e,this.session,this.dialect)}delete(e){return new eg(e,this.session,this.dialect)}refreshMaterializedView(e){return new e_(e,this.session,this.dialect)}execute(e){let t=e.getSQL(),r=this.dialect.sqlToQuery(t),n=this.session.prepareQuery(r,void 0,void 0,!1);return new eb(()=>n.execute(),t,r,e=>n.mapResult(e,!0))}transaction(e,t){return this.session.transaction(e,t)}}class eS{constructor(e){this.query=e}getQuery(){return this.query}mapResult(e,t){return e}static [n.Q]="PgPreparedQuery";joinsNotNullableMap}class ex{constructor(e){this.dialect=e}static [n.Q]="PgSession";execute(e){return X.Z.startActiveSpan("drizzle.operation",()=>X.Z.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).execute())}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}}class eT extends ew{constructor(e,t,r,n=0){super(e,t,r),this.schema=r,this.nestedIndex=n}static [n.Q]="PgTransaction";rollback(){throw new b}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),"boolean"==typeof e.deferrable&&t.push(e.deferrable?"deferrable":"not deferrable"),l.i6.raw(t.join(" "))}setTransaction(e){return this.session.execute((0,l.i6)`set transaction ${this.getTransactionConfigSQL(e)}`)}}class ek extends eS{constructor(e,t,r,n,s,i,a){super({sql:t,params:r}),this.client=e,this.queryString=t,this.params=r,this.logger=n,this.fields=s,this._isResponseInArrayMode=i,this.customResultMapper=a}static [n.Q]="PostgresJsPreparedQuery";async execute(e={}){return X.Z.startActiveSpan("drizzle.execute",async t=>{let r=(0,l.Pr)(this.params,e);t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.logger.logQuery(this.queryString,r);let{fields:n,queryString:s,client:i,joinsNotNullableMap:a,customResultMapper:o}=this;if(!n&&!o)return X.Z.startActiveSpan("drizzle.driver.execute",()=>i.unsafe(s,r));let u=await X.Z.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":s,"drizzle.query.params":JSON.stringify(r)}),i.unsafe(s,r).values()));return X.Z.startActiveSpan("drizzle.mapResponse",()=>o?o(u):u.map(e=>(0,J.M4)(n,e,a)))})}all(e={}){return X.Z.startActiveSpan("drizzle.execute",async t=>{let r=(0,l.Pr)(this.params,e);return t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.logger.logQuery(this.queryString,r),X.Z.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.client.unsafe(this.queryString,r)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}}class eE extends ex{constructor(e,t,r,n={}){super(t),this.client=e,this.schema=r,this.options=n,this.logger=n.logger??new a}static [n.Q]="PostgresJsSession";logger;prepareQuery(e,t,r,n,s){return new ek(this.client,e.sql,e.params,this.logger,t,n,s)}query(e,t){return this.logger.logQuery(e,t),this.client.unsafe(e,t).values()}queryObjects(e,t){return this.client.unsafe(e,t)}transaction(e,t){return this.client.begin(async r=>{let n=new eE(r,this.dialect,this.schema,this.options),s=new eN(this.dialect,n,this.schema);return t&&await s.setTransaction(t),e(s)})}}class eN extends eT{constructor(e,t,r,n=0){super(e,t,r,n),this.session=t}static [n.Q]="PostgresJsTransaction";transaction(e){return this.session.client.savepoint(t=>{let r=new eE(t,this.dialect,this.schema,this.session.options);return e(new eN(this.dialect,r,this.schema))})}}function eA(e,t={}){let r,s;let a=e=>e;for(let t of["1184","1082","1083","1114"])e.options.parsers[t]=a,e.options.serializers[t]=a;let o=new G;if(!0===t.logger?r=new i:!1!==t.logger&&(r=t.logger),t.schema){let e=function(e,t){1===Object.keys(e).length&&"default"in e&&!(0,n.is)(e.default,u.iA)&&(e=e.default);let r={},s={},i={};for(let[a,o]of Object.entries(e))if((0,n.is)(o,u.iA)){let e=(0,u.Q0)(o),t=s[e];for(let n of(r[e]=a,i[a]={tsName:a,dbName:o[u.iA.Symbol.Name],schema:o[u.iA.Symbol.Schema],columns:o[u.iA.Symbol.Columns],relations:t?.relations??{},primaryKey:t?.primaryKey??[]},Object.values(o[u.iA.Symbol.Columns])))n.primary&&i[a].primaryKey.push(n);let l=o[u.iA.Symbol.ExtraConfigBuilder]?.(o[u.iA.Symbol.ExtraConfigColumns]);if(l)for(let e of Object.values(l))(0,n.is)(e,R)&&i[a].primaryKey.push(...e.columns)}else if((0,n.is)(o,U)){let e;let n=(0,u.Q0)(o.table),a=r[n];for(let[r,l]of Object.entries(o.config(t(o.table))))if(a){let t=i[a];t.relations[r]=l,e&&t.primaryKey.push(...e)}else n in s||(s[n]={relations:{},primaryKey:e}),s[n].relations[r]=l}return{tables:i,tableNamesMap:r}}(t.schema,F);s={fullSchema:t.schema,schema:e.tables,tableNamesMap:e.tableNamesMap}}let l=new eE(e,o,s,{logger:r});return new ew(o,l,s)}},7745:(e,t,r)=>{"use strict";r.d(t,{Ft:()=>b,G:()=>g,Gg:()=>w,K0:()=>_,Nl:()=>v,OL:()=>T,Qg:()=>E,UN:()=>S,d3:()=>y,eg:()=>f,eq:()=>l,ff:()=>p,gt:()=>m,lt:()=>h,mM:()=>A,ne:()=>u,o$:()=>N,or:()=>d,vL:()=>k,vX:()=>x,xD:()=>c});var n=r(3596),s=r(9326),i=r(298),a=r(2315);function o(e,t){return!(0,a._B)(t)||(0,a.zl)(e)||(0,s.is)(e,a.dO)||(0,s.is)(e,a.Vm)||(0,s.is)(e,n.s)||(0,s.is)(e,i.iA)||(0,s.is)(e,a.G7)?e:new a.dO(e,t)}let l=(e,t)=>(0,a.i6)`${e} = ${o(t,e)}`,u=(e,t)=>(0,a.i6)`${e} <> ${o(t,e)}`;function c(...e){let t=e.filter(e=>void 0!==e);return 0===t.length?void 0:new a.$s(1===t.length?t:[new a.Zm("("),a.i6.join(t,new a.Zm(" and ")),new a.Zm(")")])}function d(...e){let t=e.filter(e=>void 0!==e);return 0===t.length?void 0:new a.$s(1===t.length?t:[new a.Zm("("),a.i6.join(t,new a.Zm(" or ")),new a.Zm(")")])}function p(e){return(0,a.i6)`not ${e}`}let m=(e,t)=>(0,a.i6)`${e} > ${o(t,e)}`,f=(e,t)=>(0,a.i6)`${e} >= ${o(t,e)}`,h=(e,t)=>(0,a.i6)`${e} < ${o(t,e)}`,g=(e,t)=>(0,a.i6)`${e} <= ${o(t,e)}`;function y(e,t){if(Array.isArray(t)){if(0===t.length)throw Error("inArray requires at least one value");return(0,a.i6)`${e} in ${t.map(t=>o(t,e))}`}return(0,a.i6)`${e} in ${o(t,e)}`}function v(e,t){if(Array.isArray(t)){if(0===t.length)throw Error("notInArray requires at least one value");return(0,a.i6)`${e} not in ${t.map(t=>o(t,e))}`}return(0,a.i6)`${e} not in ${o(t,e)}`}function b(e){return(0,a.i6)`${e} is null`}function _(e){return(0,a.i6)`${e} is not null`}function w(e){return(0,a.i6)`exists ${e}`}function S(e){return(0,a.i6)`not exists ${e}`}function x(e,t,r){return(0,a.i6)`${e} between ${o(t,e)} and ${o(r,e)}`}function T(e,t,r){return(0,a.i6)`${e} not between ${o(t,e)} and ${o(r,e)}`}function k(e,t){return(0,a.i6)`${e} like ${t}`}function E(e,t){return(0,a.i6)`${e} not like ${t}`}function N(e,t){return(0,a.i6)`${e} ilike ${t}`}function A(e,t){return(0,a.i6)`${e} not ilike ${t}`}},1445:(e,t,r)=>{"use strict";r.d(t,{C:()=>i,d:()=>s});var n=r(2315);function s(e){return(0,n.i6)`${e} asc`}function i(e){return(0,n.i6)`${e} desc`}},6179:(e,t,r)=>{"use strict";r.d(t,{Zd:()=>s});var n=r(2315);function s(e,t){return Array.isArray(t)?(0,n.i6)`${e} <=> ${JSON.stringify(t)}`:(0,n.i6)`${e} <=> ${t}`}},2315:(e,t,r)=>{"use strict";r.d(t,{dO:()=>w,Vm:()=>x,$s:()=>g,Zm:()=>h,G7:()=>k,Pr:()=>T,_B:()=>v,zl:()=>f,i6:()=>S});var n=r(9326),s=r(2596);let i=Symbol.for("drizzle:isPgEnum");class a extends s.b1{static [n.Q]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new o(e,this.config)}}class o extends s.df{static [n.Q]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}var l=r(8586),u=r(836),c=r(7029),d=r(3596),p=r(298);class m{static [n.Q]=null}function f(e){return null!=e&&"function"==typeof e.getSQL}class h{static [n.Q]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new g([this])}}class g{constructor(e){this.queryChunks=e}static [n.Q]="SQL";decoder=b;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return u.Z.startActiveSpan("drizzle.buildSQL",t=>{let r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(e,t){let r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{escapeName:s,escapeParam:a,prepareTyping:o,inlineParams:u,paramStartIndex:m}=r;return function(e){let t={sql:"",params:[]};for(let r of e)t.sql+=r.sql,t.params.push(...r.params),r.typings?.length&&(t.typings||(t.typings=[]),t.typings.push(...r.typings));return t}(e.map(e=>{if((0,n.is)(e,h))return{sql:e.value.join(""),params:[]};if((0,n.is)(e,y))return{sql:s(e.value),params:[]};if(void 0===e)return{sql:"",params:[]};if(Array.isArray(e)){let t=[new h("(")];for(let[r,n]of e.entries())t.push(n),r<e.length-1&&t.push(new h(", "));return t.push(new h(")")),this.buildQueryFromSourceParams(t,r)}if((0,n.is)(e,g))return this.buildQueryFromSourceParams(e.queryChunks,{...r,inlineParams:u||e.shouldInlineParams});if((0,n.is)(e,p.iA)){let t=e[p.iA.Symbol.Schema],r=e[p.iA.Symbol.Name];return{sql:void 0===t?s(r):s(t)+"."+s(r),params:[]}}if((0,n.is)(e,d.s))return"indexes"===t.invokeSource?{sql:s(e.name),params:[]}:{sql:s(e.table[p.iA.Symbol.Name])+"."+s(e.name),params:[]};if((0,n.is)(e,k)){let t=e[c.d].schema,r=e[c.d].name;return{sql:void 0===t?s(r):s(t)+"."+s(r),params:[]}}if((0,n.is)(e,w)){let t;let s=null===e.value?null:e.encoder.mapToDriverValue(e.value);return(0,n.is)(s,g)?this.buildQueryFromSourceParams([s],r):u?{sql:this.mapInlineParam(s,r),params:[]}:(o&&(t=[o(e.encoder)]),{sql:a(m.value++,s),params:[s],typings:t})}return(0,n.is)(e,x)?{sql:a(m.value++,e),params:[e],typings:["none"]}:(0,n.is)(e,g.Aliased)&&void 0!==e.fieldAlias?{sql:s(e.fieldAlias),params:[]}:(0,n.is)(e,l.k)?e._.isWith?{sql:s(e._.alias),params:[]}:this.buildQueryFromSourceParams([new h("("),e._.sql,new h(") "),new y(e._.alias)],r):e&&"function"==typeof e&&i in e&&!0===e[i]?e.schema?{sql:s(e.schema)+"."+s(e.enumName),params:[]}:{sql:s(e.enumName),params:[]}:f(e)?e.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([e.getSQL()],r):this.buildQueryFromSourceParams([new h("("),e.getSQL(),new h(")")],r):u?{sql:this.mapInlineParam(e,r),params:[]}:{sql:a(m.value++,e),params:[e]}}))}mapInlineParam(e,{escapeString:t}){if(null===e)return"null";if("number"==typeof e||"boolean"==typeof e)return e.toString();if("string"==typeof e)return t(e);if("object"==typeof e){let r=e.toString();return"[object Object]"===r?t(JSON.stringify(e)):t(r)}throw Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return void 0===e?this:new g.Aliased(this,e)}mapWith(e){return this.decoder="function"==typeof e?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}class y{constructor(e){this.value=e}static [n.Q]="Name";brand;getSQL(){return new g([this])}}function v(e){return"object"==typeof e&&null!==e&&"mapToDriverValue"in e&&"function"==typeof e.mapToDriverValue}let b={mapFromDriverValue:e=>e},_={mapToDriverValue:e=>e};({...b,..._});class w{constructor(e,t=_){this.value=e,this.encoder=t}static [n.Q]="Param";brand;getSQL(){return new g([this])}}function S(e,...t){let r=[];for(let[n,s]of((t.length>0||e.length>0&&""!==e[0])&&r.push(new h(e[0])),t.entries()))r.push(s,new h(e[n+1]));return new g(r)}(e=>{e.empty=function(){return new g([])},e.fromList=function(e){return new g(e)},e.raw=function(e){return new g([new h(e)])},e.join=function(e,t){let r=[];for(let[n,s]of e.entries())n>0&&void 0!==t&&r.push(t),r.push(s);return new g(r)},e.identifier=function(e){return new y(e)},e.placeholder=function(e){return new x(e)},e.param=function(e,t){return new w(e,t)}})(S||(S={})),(e=>{class t{constructor(e,t){this.sql=e,this.fieldAlias=t}static [n.Q]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new t(this.sql,this.fieldAlias)}}e.Aliased=t})(g||(g={}));class x{constructor(e){this.name=e}static [n.Q]="Placeholder";getSQL(){return new g([this])}}function T(e,t){return e.map(e=>{if((0,n.is)(e,x)){if(!(e.name in t))throw Error(`No value for placeholder "${e.name}" was provided`);return t[e.name]}return e})}class k{static [n.Q]="View";[c.d];constructor({name:e,schema:t,selectedFields:r,query:n}){this[c.d]={name:e,originalName:e,schema:t,selectedFields:r,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new g([this])}}d.s.prototype.getSQL=function(){return new g([this])},p.iA.prototype.getSQL=function(){return new g([this])},l.k.prototype.getSQL=function(){return new g([this])}},8586:(e,t,r)=>{"use strict";r.d(t,{S:()=>i,k:()=>s});var n=r(9326);class s{static [n.Q]="Subquery";constructor(e,t,r,n=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:n}}}class i extends s{static [n.Q]="WithSubquery"}},298:(e,t,r)=>{"use strict";r.d(t,{Q0:()=>f,SP:()=>m,iA:()=>p});var n=r(9326);let s=Symbol.for("drizzle:Name"),i=Symbol.for("drizzle:Schema"),a=Symbol.for("drizzle:Columns"),o=Symbol.for("drizzle:ExtraConfigColumns"),l=Symbol.for("drizzle:OriginalName"),u=Symbol.for("drizzle:BaseName"),c=Symbol.for("drizzle:IsAlias"),d=Symbol.for("drizzle:ExtraConfigBuilder");Symbol.for("drizzle:IsDrizzleTable");class p{static [n.Q]="Table";static Symbol={Name:s,Schema:i,OriginalName:l,Columns:a,ExtraConfigColumns:o,BaseName:u,IsAlias:c,ExtraConfigBuilder:d};[s];[l];[i];[a];[o];[u];[c]=!1;[d]=void 0;constructor(e,t,r){this[s]=this[l]=e,this[i]=t,this[u]=r}}function m(e){return e[s]}function f(e){return`${e[i]??"public"}.${e[s]}`}},9082:(e,t,r)=>{"use strict";function n(e,...t){return e(...t)}r.d(t,{t:()=>n})},836:(e,t,r)=>{"use strict";let n,s;r.d(t,{Z:()=>a});var i=r(9082);let a={startActiveSpan:(e,t)=>n?(s||(s=n.trace.getTracer("drizzle-orm","0.31.4")),(0,i.t)((r,n)=>n.startActiveSpan(e,e=>{try{return t(e)}catch(t){throw e.setStatus({code:r.SpanStatusCode.ERROR,message:t instanceof Error?t.message:"Unknown error"}),t}finally{e.end()}}),n,s)):t()}},9237:(e,t,r)=>{"use strict";r.d(t,{M4:()=>u,M6:()=>d,SS:()=>m,ZS:()=>function e(t,r){return Object.entries(t).reduce((t,[a,l])=>{if("string"!=typeof a)return t;let u=r?[...r,a]:[a];return(0,s.is)(l,n.s)||(0,s.is)(l,i.$s)||(0,s.is)(l,i.$s.Aliased)?t.push({path:u,field:l}):(0,s.is)(l,o.iA)?t.push(...e(l[o.iA.Symbol.Columns],u)):t.push(...e(l,u)),t},[])},dP:()=>f,ef:()=>p,ux:()=>c});var n=r(3596),s=r(9326),i=r(2315),a=r(8586),o=r(298),l=r(7029);function u(e,t,r){let a={},l=e.reduce((e,{path:l,field:u},c)=>{let d;d=(0,s.is)(u,n.s)?u:(0,s.is)(u,i.$s)?u.decoder:u.sql.decoder;let p=e;for(let[e,i]of l.entries())if(e<l.length-1)i in p||(p[i]={}),p=p[i];else{let e=t[c],m=p[i]=null===e?null:d.mapFromDriverValue(e);if(r&&(0,s.is)(u,n.s)&&2===l.length){let e=l[0];e in a?"string"==typeof a[e]&&a[e]!==(0,o.SP)(u.table)&&(a[e]=!1):a[e]=null===m&&(0,o.SP)(u.table)}}return e},{});if(r&&Object.keys(a).length>0)for(let[e,t]of Object.entries(a))"string"!=typeof t||r[t]||(l[e]=null);return l}function c(e,t){let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let[e,t]of r.entries())if(t!==n[e])return!1;return!0}function d(e,t){let r=Object.entries(t).filter(([,e])=>void 0!==e).map(([t,r])=>(0,s.is)(r,i.$s)?[t,r]:[t,new i.dO(r,e[o.iA.Symbol.Columns][t])]);if(0===r.length)throw Error("No values to set");return Object.fromEntries(r)}function p(e,t){for(let r of t)for(let t of Object.getOwnPropertyNames(r.prototype))"constructor"!==t&&Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(r.prototype,t)||Object.create(null))}function m(e){return e[o.iA.Symbol.Columns]}function f(e){return(0,s.is)(e,a.k)?e._.alias:(0,s.is)(e,i.G7)?e[l.d].name:(0,s.is)(e,i.$s)?void 0:e[o.iA.Symbol.IsAlias]?e[o.iA.Symbol.Name]:e[o.iA.Symbol.BaseName]}},7029:(e,t,r)=>{"use strict";r.d(t,{d:()=>n});let n=Symbol.for("drizzle:ViewBaseConfig")},2359:(e,t,r)=>{"use strict";r.d(t,{IO:()=>K});var n=r(9237),s=r(9326),i=r(5418),a=r(3596),o=r(298);let l=Symbol.for("drizzle:MySqlInlineForeignKeys");class u extends o.iA{static [s.Q]="MySqlTable";static Symbol=Object.assign({},o.iA.Symbol,{InlineForeignKeys:l});[o.iA.Symbol.Columns];[l]=[];[o.iA.Symbol.ExtraConfigBuilder]=void 0}class c{static [s.Q]="MySqlForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(e,t){this.reference=()=>{let{name:t,columns:r,foreignColumns:n}=e();return{name:t,columns:r,foreignTable:n[0].table,foreignColumns:n}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e,this}onDelete(e){return this._onDelete=e,this}build(e){return new d(e,this)}}class d{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static [s.Q]="MySqlForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),n=t.map(e=>e.name),s=r.map(e=>e.name),i=[this.table[u.Symbol.Name],...n,r[0].table[u.Symbol.Name],...s];return e??`${i.join("_")}_fk`}}function p(e,t){return`${e[u.Symbol.Name]}_${t.join("_")}_unique`}class m{constructor(e,t){this.name=t,this.columns=e}static [s.Q]=null;columns;build(e){return new h(e,this.columns,this.name)}}class f{static [s.Q]=null;name;constructor(e){this.name=e}on(...e){return new m(e,this.name)}}class h{constructor(e,t,r){this.table=e,this.columns=t,this.name=r??p(this.table,this.columns.map(e=>e.name))}static [s.Q]=null;columns;name;nullsNotDistinct=!1;getName(){return this.name}}class g extends i.L{static [s.Q]="MySqlColumnBuilder";foreignKeyConfigs=[];references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e){return this.config.isUnique=!0,this.config.uniqueName=e,this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:n})=>((r,n)=>{let s=new c(()=>({columns:[e],foreignColumns:[r()]}));return n.onUpdate&&s.onUpdate(n.onUpdate),n.onDelete&&s.onDelete(n.onDelete),s.build(t)})(r,n))}}class y extends a.s{constructor(e,t){t.uniqueName||(t.uniqueName=p(e,[t.name])),super(e,t),this.table=e}static [s.Q]="MySqlColumn"}class v extends g{static [s.Q]="MySqlColumnBuilderWithAutoIncrement";constructor(e,t,r){super(e,t,r),this.config.autoIncrement=!1}autoincrement(){return this.config.autoIncrement=!0,this.config.hasDefault=!0,this}}class b extends null{static [s.Q]=null;autoIncrement=this.config.autoIncrement}class _ extends g{static [s.Q]="MySqlVarCharBuilder";constructor(e,t){super(e,"string","MySqlVarChar"),this.config.length=t.length,this.config.enum=t.enum}build(e){return new w(e,this.config)}}class w extends y{static [s.Q]="MySqlVarChar";length=this.config.length;enumValues=this.config.enum;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}class S extends g{static [s.Q]="MySqlVarBinaryBuilder";constructor(e,t){super(e,"string","MySqlVarBinary"),this.config.length=t?.length}build(e){return new x(e,this.config)}}class x extends y{static [s.Q]="MySqlVarBinary";length=this.config.length;getSQLType(){return void 0===this.length?"varbinary":`varbinary(${this.length})`}}class T extends g{static [s.Q]="MySqlCharBuilder";constructor(e,t){super(e,"string","MySqlChar"),this.config.length=t.length,this.config.enum=t.enum}build(e){return new k(e,this.config)}}class k extends y{static [s.Q]="MySqlChar";length=this.config.length;enumValues=this.config.enum;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}var E=r(967),N=r(2596);class A extends N.b1{static [s.Q]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new O(e,this.config)}}class O extends N.df{static [s.Q]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}var j=r(1401);let $=Symbol.for("drizzle:SQLiteInlineForeignKeys");class I extends o.iA{static [s.Q]="SQLiteTable";static Symbol=Object.assign({},o.iA.Symbol,{InlineForeignKeys:$});[o.iA.Symbol.Columns];[$]=[];[o.iA.Symbol.ExtraConfigBuilder]=void 0}class C{static [s.Q]="SQLiteForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(e,t){this.reference=()=>{let{name:t,columns:r,foreignColumns:n}=e();return{name:t,columns:r,foreignTable:n[0].table,foreignColumns:n}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e,this}onDelete(e){return this._onDelete=e,this}build(e){return new P(e,this)}}class P{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static [s.Q]="SQLiteForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),n=t.map(e=>e.name),s=r.map(e=>e.name),i=[this.table[I.Symbol.Name],...n,r[0].table[I.Symbol.Name],...s];return e??`${i.join("_")}_fk`}}function z(e,t){return`${e[I.Symbol.Name]}_${t.join("_")}_unique`}class D{constructor(e,t){this.name=t,this.columns=e}static [s.Q]=null;columns;build(e){return new M(e,this.columns,this.name)}}class R{static [s.Q]=null;name;constructor(e){this.name=e}on(...e){return new D(e,this.name)}}class M{constructor(e,t,r){this.table=e,this.columns=t,this.name=r??z(this.table,this.columns.map(e=>e.name))}static [s.Q]=null;columns;name;getName(){return this.name}}class q extends i.L{static [s.Q]="SQLiteColumnBuilder";foreignKeyConfigs=[];references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e){return this.config.isUnique=!0,this.config.uniqueName=e,this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:n})=>((r,n)=>{let s=new C(()=>({columns:[e],foreignColumns:[r()]}));return n.onUpdate&&s.onUpdate(n.onUpdate),n.onDelete&&s.onDelete(n.onDelete),s.build(t)})(r,n))}}class L extends a.s{constructor(e,t){t.uniqueName||(t.uniqueName=z(e,[t.name])),super(e,t),this.table=e}static [s.Q]="SQLiteColumn"}class Q extends q{static [s.Q]="SQLiteTextBuilder";constructor(e,t){super(e,"string","SQLiteText"),this.config.enumValues=t.enum,this.config.length=t.length}build(e){return new U(e,this.config)}}class U extends L{static [s.Q]="SQLiteText";enumValues=this.config.enumValues;length=this.config.length;constructor(e,t){super(e,t)}getSQLType(){return`text${this.config.length?`(${this.config.length})`:""}`}}class Z extends q{static [s.Q]="SQLiteTextJsonBuilder";constructor(e){super(e,"json","SQLiteTextJson")}build(e){return new B(e,this.config)}}class B extends L{static [s.Q]="SQLiteTextJson";getSQLType(){return"text"}mapFromDriverValue(e){return JSON.parse(e)}mapToDriverValue(e){return JSON.stringify(e)}}var F=r(7410);let V=F.z.union([F.z.string(),F.z.number(),F.z.boolean(),F.z.null()]),J=F.z.lazy(()=>F.z.union([V,F.z.array(J),F.z.record(J)]));function K(e,t){let r=Object.entries((0,n.SS)(e)),i=Object.fromEntries(r.map(([e,t])=>[e,function e(t){let r;if("enumValues"in t&&Array.isArray(t.enumValues)&&t.enumValues.length>0&&(r=t.enumValues.length?F.z.enum(t.enumValues):F.z.string()),!r){if((0,s.is)(t,E.RX))r=F.z.string().uuid();else if("custom"===t.dataType)r=F.z.any();else if("json"===t.dataType)r=J;else if("array"===t.dataType)r=F.z.array(e(t.baseColumn));else if("number"===t.dataType)r=F.z.number();else if("bigint"===t.dataType)r=F.z.bigint();else if("boolean"===t.dataType)r=F.z.boolean();else if("date"===t.dataType)r=F.z.date();else if("string"===t.dataType){let e=F.z.string();((0,s.is)(t,O)||(0,s.is)(t,j.qX)||(0,s.is)(t,w)||(0,s.is)(t,x)||(0,s.is)(t,k)||(0,s.is)(t,U))&&"number"==typeof t.length&&(e=e.max(t.length)),r=e}}return r||(r=F.z.any()),r}(t)]));for(let[e,n]of(t&&(i=Object.assign(i,Object.fromEntries(Object.entries(t).map(([e,t])=>[e,"function"==typeof t?t(i):t])))),r))n.notNull||(i[e]=i[e].nullable());return F.z.object(i)}},3397:(e,t,r)=>{"use strict";let n,s;r.d(t,{kP:()=>a});var i=r(6005);function a(e,t=21){var r;let a,o;return r=t,o=Math.ceil(1.6*(a=(2<<31-Math.clz32(e.length-1|1))-1)*r/e.length),(t=r)=>{let l="";for(;;){let r=function(e){var t;return t=e-=0,!n||n.length<t?(n=Buffer.allocUnsafe(128*t),i.webcrypto.getRandomValues(n),s=0):s+t>n.length&&(i.webcrypto.getRandomValues(n),s=0),s+=t,n.subarray(s-e,s)}(o),u=o;for(;u--;)if((l+=e[r[u]&a]||"").length===t)return l}}}},8937:(e,t,r)=>{"use strict";r.d(t,{Z:()=>e_});var n=r(2037),s=r(7147);let i=new Map,a=new Map,o=Symbol("OriginError"),l={};class u extends Promise{constructor(e,t,r,n,s={}){let a,l;super((e,t)=>{a=e,l=t}),this.tagged=Array.isArray(e.raw),this.strings=e,this.args=t,this.handler=r,this.canceller=n,this.options=s,this.state=null,this.statement=null,this.resolve=e=>(this.active=!1,a(e)),this.reject=e=>(this.active=!1,l(e)),this.active=!1,this.cancelled=null,this.executed=!1,this.signature="",this[o]=this.handler.debug?Error():this.tagged&&function(e){if(i.has(e))return i.get(e);let t=Error.stackTraceLimit;return Error.stackTraceLimit=4,i.set(e,Error()),Error.stackTraceLimit=t,i.get(e)}(this.strings)}get origin(){return(this.handler.debug?this[o].stack:this.tagged&&a.has(this.strings)?a.get(this.strings):a.set(this.strings,this[o].stack).get(this.strings))||""}static get[Symbol.species](){return Promise}cancel(){return this.canceller&&(this.canceller(this),this.canceller=null)}simple(){return this.options.simple=!0,this.options.prepare=!1,this}async readable(){return this.simple(),this.streaming=!0,this}async writable(){return this.simple(),this.streaming=!0,this}cursor(e=1,t){let r;return(this.options.simple=!1,"function"==typeof e&&(t=e,e=1),this.cursorRows=e,"function"==typeof t)?(this.cursorFn=t,this):{[Symbol.asyncIterator]:()=>({next:()=>{if(this.executed&&!this.active)return{done:!0};r&&r();let e=new Promise((e,t)=>{this.cursorFn=t=>(e({value:t,done:!1}),new Promise(e=>r=e)),this.resolve=()=>(this.active=!1,e({done:!0})),this.reject=e=>(this.active=!1,t(e))});return this.execute(),e},return:()=>(r&&r(l),{done:!0})})}}describe(){return this.options.simple=!1,this.onlyDescribe=this.options.prepare=!0,this}stream(){throw Error(".stream has been renamed to .forEach")}forEach(e){return this.forEachFn=e,this.handle(),this}raw(){return this.isRaw=!0,this}values(){return this.isRaw="values",this}async handle(){!this.executed&&(this.executed=!0)&&await 1&&this.handler(this)}execute(){return this.handle(),this}then(){return this.handle(),super.then.apply(this,arguments)}catch(){return this.handle(),super.catch.apply(this,arguments)}finally(){return this.handle(),super.finally.apply(this,arguments)}}class c extends Error{constructor(e){super(e.message),this.name=this.constructor.name,Object.assign(this,e)}}let d={connection:function e(t,r,n){let{host:s,port:i}=n||r,a=Object.assign(Error("write "+t+" "+(r.path||s+":"+i)),{code:t,errno:t,address:r.path||s},r.path?{}:{port:i});return Error.captureStackTrace(a,e),a},postgres:function e(t){let r=new c(t);return Error.captureStackTrace(r,e),r},generic:function e(t,r){let n=Object.assign(Error(t+": "+r),{code:t});return Error.captureStackTrace(n,e),n},notSupported:function e(t){let r=Object.assign(Error(t+" (B) is not supported"),{code:"MESSAGE_NOT_SUPPORTED",name:t});return Error.captureStackTrace(r,e),r}};class p{then(){k()}catch(){k()}finally(){k()}}class m extends p{constructor(e){super(),this.value=$(e)}}class f extends p{constructor(e,t,r){super(),this.value=e,this.type=t,this.array=r}}class h extends p{constructor(e,t){super(),this.first=e,this.rest=t}build(e,t,r,n){let s=T.map(([t,r])=>({fn:r,i:e.search(t)})).sort((e,t)=>e.i-t.i).pop();return -1===s.i?j(this.first,n):s.fn(this.first,this.rest,t,r,n)}}function g(e,t,r,n){let s=e instanceof f?e.value:e;if(void 0===s&&(e instanceof f?e.value=n.transform.undefined:s=e=n.transform.undefined,void 0===s))throw d.generic("UNDEFINED_VALUE","Undefined values are not allowed");return"$"+r.push(e instanceof f?(t.push(e.value),e.array?e.array[e.type||I(e.value)]||e.type||function e(t){return Array.isArray(t)?e(t[0]):"string"==typeof t?1009:0}(e.value):e.type):(t.push(e),I(e)))}let y=O({string:{to:25,from:null,serialize:e=>""+e},number:{to:0,from:[21,23,26,700,701],serialize:e=>""+e,parse:e=>+e},json:{to:114,from:[114,3802],serialize:e=>JSON.stringify(e),parse:e=>JSON.parse(e)},boolean:{to:16,from:16,serialize:e=>!0===e?"t":"f",parse:e=>"t"===e},date:{to:1184,from:[1082,1114,1184],serialize:e=>(e instanceof Date?e:new Date(e)).toISOString(),parse:e=>new Date(e)},bytea:{to:17,from:17,serialize:e=>"\\x"+Buffer.from(e).toString("hex"),parse:e=>Buffer.from(e.slice(2),"hex")}});function v(e,t,r,n,s,i){for(let a=1;a<e.strings.length;a++)t+=b(t,r,n,s,i)+e.strings[a],r=e.args[a];return t}function b(e,t,r,n,s){return t instanceof h?t.build(e,r,n,s):t instanceof u?_(t,r,n,s):t instanceof m?t.value:t&&t[0]instanceof u?t.reduce((e,t)=>e+" "+_(t,r,n,s),""):g(t,r,n,s)}function _(e,t,r,n){return e.fragment=!0,v(e,e.strings[0],e.args[0],t,r,n)}function w(e,t,r,n,s){return e.map(e=>"("+n.map(n=>b("values",e[n],t,r,s)).join(",")+")").join(",")}function S(e,t,r,n,s){let i=Array.isArray(e[0]),a=t.length?t.flat():Object.keys(i?e[0]:e);return w(i?e:[e],r,n,a,s)}function x(e,t,r,n,s){let i;return("string"==typeof e&&(e=[e].concat(t)),Array.isArray(e))?j(e,s):(t.length?t.flat():Object.keys(e)).map(t=>((i=e[t])instanceof u?_(i,r,n,s):i instanceof m?i.value:g(i,r,n,s))+" as "+$(s.transform.column.to?s.transform.column.to(t):t)).join(",")}let T=Object.entries({values:S,in:(...e)=>{let t=S(...e);return"()"===t?"(null)":t},select:x,as:x,returning:x,"\\(":x,update:(e,t,r,n,s)=>(t.length?t.flat():Object.keys(e)).map(t=>$(s.transform.column.to?s.transform.column.to(t):t)+"="+b("values",e[t],r,n,s)),insert(e,t,r,n,s){let i=t.length?t.flat():Object.keys(Array.isArray(e)?e[0]:e);return"("+j(i,s)+")values"+w(Array.isArray(e)?e:[e],r,n,i,s)}}).map(([e,t])=>[RegExp("((?:^|[\\s(])"+e+"(?:$|[\\s(]))(?![\\s\\S]*\\1)","i"),t]);function k(){throw d.generic("NOT_TAGGED_CALL","Query not called as a tagged template literal")}let E=y.serializers,N=y.parsers,A=function(e){let t=O(e||{});return{serializers:Object.assign({},E,t.serializers),parsers:Object.assign({},N,t.parsers)}};function O(e){return Object.keys(e).reduce((t,r)=>(e[r].from&&[].concat(e[r].from).forEach(n=>t.parsers[n]=e[r].parse),e[r].serialize&&(t.serializers[e[r].to]=e[r].serialize,e[r].from&&[].concat(e[r].from).forEach(n=>t.serializers[n]=e[r].serialize)),t),{parsers:{},serializers:{}})}function j(e,{transform:{column:t}}){return e.map(e=>$(t.to?t.to(e):e)).join(",")}let $=function(e){return'"'+e.replace(/"/g,'""').replace(/\./g,'"."')+'"'},I=function e(t){return t instanceof f?t.type:t instanceof Date?1184:t instanceof Uint8Array?17:!0===t||!1===t?16:"bigint"==typeof t?20:Array.isArray(t)?e(t[0]):0},C=/\\/g,P=/"/g,z=function e(t,r,n,s){if(!1===Array.isArray(t))return t;if(!t.length)return"{}";let i=t[0],a=1020===s?";":",";return Array.isArray(i)&&!i.type?"{"+t.map(t=>e(t,r,n,s)).join(a)+"}":"{"+t.map(e=>{if(void 0===e&&void 0===(e=n.transform.undefined))throw d.generic("UNDEFINED_VALUE","Undefined values are not allowed");return null===e?"null":'"'+(r?r(e.type?e.value:e):""+e).replace(C,"\\\\").replace(P,'\\"')+'"'}).join(a)+"}"},D={i:0,char:null,str:"",quoted:!1,last:0},R=e=>{let t=e[0];for(let r=1;r<e.length;r++)t+="_"===e[r]?e[++r].toUpperCase():e[r];return t},M=e=>{let t=e[0].toUpperCase();for(let r=1;r<e.length;r++)t+="_"===e[r]?e[++r].toUpperCase():e[r];return t},q=e=>e.replace(/_/g,"-"),L=e=>e.replace(/([A-Z])/g,"_$1").toLowerCase(),Q=e=>(e.slice(0,1)+e.slice(1).replace(/([A-Z])/g,"_$1")).toLowerCase(),U=e=>e.replace(/-/g,"_");function Z(e){return function t(r,n){return"object"==typeof r&&null!==r&&(114===n.type||3802===n.type)?Array.isArray(r)?r.map(e=>t(e,n)):Object.entries(r).reduce((r,[s,i])=>Object.assign(r,{[e(s)]:t(i,n)}),{}):r}}R.column={from:R},R.value={from:Z(R)},L.column={to:L};let B={...R};B.column.to=L,M.column={from:M},M.value={from:Z(M)},Q.column={to:Q};let F={...M};F.column.to=Q,q.column={from:q},q.value={from:Z(q)},U.column={to:U};let V={...q};V.column.to=U;var J=r(1808),K=r(4404),G=r(6113),W=r(2781),Y=r(4074);class H extends Array{constructor(){super(),Object.defineProperties(this,{count:{value:null,writable:!0},state:{value:null,writable:!0},command:{value:null,writable:!0},columns:{value:null,writable:!0},statement:{value:null,writable:!0}})}static get[Symbol.species](){return Array}}let X=function(e=[]){let t=e.slice(),r=0;return{get length(){return t.length-r},remove:e=>{let r=t.indexOf(e);return -1===r?null:(t.splice(r,1),e)},push:e=>(t.push(e),e),shift:()=>{let e=t[r++];return r===t.length?(r=0,t=[]):t[r-1]=void 0,e}}},ee=Buffer.allocUnsafe(256),et=Object.assign(function(){return et.i=0,et},"BCcDdEFfHPpQSX".split("").reduce((e,t)=>{let r=t.charCodeAt(0);return e[t]=()=>(ee[0]=r,et.i=5,et),e},{}),{N:"\0",i:0,inc:e=>(et.i+=e,et),str(e){let t=Buffer.byteLength(e);return er(t),et.i+=ee.write(e,et.i,t,"utf8"),et},i16:e=>(er(2),ee.writeUInt16BE(e,et.i),et.i+=2,et),i32:(e,t)=>(t||0===t?ee.writeUInt32BE(e,t):(er(4),ee.writeUInt32BE(e,et.i),et.i+=4),et),z:e=>(er(e),ee.fill(0,et.i,et.i+e),et.i+=e,et),raw:e=>(ee=Buffer.concat([ee.subarray(0,et.i),e]),et.i=ee.length,et),end(e=1){ee.writeUInt32BE(et.i-e,e);let t=ee.subarray(0,et.i);return et.i=0,ee=Buffer.allocUnsafe(256),t}});function er(e){if(ee.length-et.i<e){let t=ee,r=t.length;ee=Buffer.allocUnsafe(r+(r>>1)+e),t.copy(ee)}}let en=function e(t,r={},{onopen:n=ec,onend:s=ec,onclose:i=ec}={}){let{ssl:a,max:o,user:c,host:p,port:m,database:f,parsers:h,transform:y,onnotice:b,onnotify:_,onparameter:w,max_pipeline:S,keep_alive:x,backoff:T,target_session_attrs:k}=t,E=X(),N=es++,A={pid:null,secret:null},O=eg(eV,t.idle_timeout),j=eg(eV,t.max_lifetime),$=eg(function(){eB(d.connection("CONNECT_TIMEOUT",t,I)),I.destroy()},t.connect_timeout),I=null,C,P=new H,R=Buffer.alloc(0),M=t.fetch_types,q={},L={},Q=Math.random().toString(36).slice(2),U=1,Z=0,B=0,F=0,V=0,ee=0,er=0,en=0,ep=null,ey=null,ev=!1,eb=null,e_=null,ew=null,eS=null,ex=null,eT=null,ek=null,eE=null,eN=null,eA=null,eO={queue:r.closed,idleTimer:O,connect(e){ew=e||!0,eQ()},terminate:eJ,execute:eI,cancel:e$,end:eV,count:0,id:N};return r.closed&&r.closed.push(eO),eO;async function ej(){let e;try{e=t.socket?await Promise.resolve(t.socket(t)):new J.Socket}catch(e){eZ(e);return}return e.on("error",eZ),e.on("close",eK),e.on("drain",eM),e}async function e$({pid:e,secret:t},r,n){try{C=et().i32(16).i32(80877102).i32(e).i32(t).end(16),await eL(),I.once("error",n),I.once("close",r)}catch(e){n(e)}}function eI(e){if(ev)return eF(e,d.connection("CONNECTION_DESTROYED",t));if(!e.cancelled)try{return e.state=A,eN?E.push(e):(eN=e).active=!0,function(e){let r=[],n=[],s=v(e,e.strings[0],e.args[0],r,n,t);e.tagged||e.args.forEach(e=>g(e,r,n,t)),e.prepare=t.prepare&&(!("prepare"in e.options)||e.options.prepare),e.string=s,e.signature=e.prepare&&n+s,e.onlyDescribe&&delete L[e.signature],e.parameters=e.parameters||r,e.prepared=e.prepare&&e.signature in L,e.describeFirst=e.onlyDescribe||r.length&&!e.prepared,e.statement=e.prepared?L[e.signature]:{string:s,types:n,name:e.prepare?Q+U++:""},"function"==typeof t.debug&&t.debug(N,s,r,n)}(e),ez(function(e){if(e.parameters.length>=65534)throw d.generic("MAX_PARAMETERS_EXCEEDED","Max number of parameters (65534) exceeded");return e.options.simple?et().Q().str(e.statement.string+et.N).end():e.describeFirst?Buffer.concat([eC(e),ea]):e.prepare?e.prepared?eP(e):Buffer.concat([eC(e),eP(e)]):Buffer.concat([e4(e.statement.string,e.parameters,e.statement.types),eu,eP(e)])}(e))&&!e.describeFirst&&!e.cursorFn&&E.length<S&&(!e.options.onexecute||e.options.onexecute(eO))}catch(e){return 0===E.length&&ez(ei),eB(e),!0}}function eC(e){return Buffer.concat([e4(e.statement.string,e.parameters,e.statement.types,e.statement.name),function(e,t=""){return et().D().str("S").str(t+et.N).end()}(0,e.statement.name)])}function eP(e){return Buffer.concat([function(e,r,n="",s=""){let i,a;return et().B().str(s+et.N).str(n+et.N).i16(0).i16(e.length),e.forEach((n,s)=>{if(null===n)return et.i32(4294967295);a=r[s],e[s]=n=a in t.serializers?t.serializers[a](n):""+n,i=et.i,et.inc(4).str(n).i32(et.i-i-4,i)}),et.i16(0),et.end()}(e.parameters,e.statement.types,e.statement.name,e.cursorName),e.cursorFn?e8("",e.cursorRows):el])}function ez(e,t){return(eT=eT?Buffer.concat([eT,e]):Buffer.from(e),t||eT.length>=1024)?eD(t):(null===ey&&(ey=setImmediate(eD)),!0)}function eD(e){let t=I.write(eT,e);return null!==ey&&clearImmediate(ey),eT=ey=null,t}async function eR(){if(ez(eo),!await new Promise(e=>I.once("data",t=>e(83===t[0])))&&"prefer"===a)return eU();I.removeAllListeners(),(I=K.connect({socket:I,servername:J.isIP(I.host)?void 0:I.host,..."require"===a||"allow"===a||"prefer"===a?{rejectUnauthorized:!1}:"verify-full"===a?{}:"object"==typeof a?a:{}})).on("secureConnect",eU),I.on("error",eZ),I.on("close",eK),I.on("drain",eM)}function eM(){eN||n(eO)}function eq(r){if(!eb||(eb.push(r),!((B-=r.length)>=0)))for(R=eb?Buffer.concat(eb,ee-B):0===R.length?r:Buffer.concat([R,r],R.length+r.length);R.length>4;){if((ee=R.readUInt32BE(1))>=R.length){B=ee-R.length,eb=[R];break}try{(function(r,s=r[0]){(68===s?function(e){let t,r,n,s=7,i=eN.isRaw?Array(eN.statement.columns.length):{};for(let a=0;a<eN.statement.columns.length;a++)r=eN.statement.columns[a],t=e.readInt32BE(s),s+=4,n=-1===t?null:!0===eN.isRaw?e.subarray(s,s+=t):void 0===r.parser?e.toString("utf8",s,s+=t):!0===r.parser.array?r.parser(e.toString("utf8",s+1,s+=t)):r.parser(e.toString("utf8",s,s+=t)),eN.isRaw?i[a]=!0===eN.isRaw?n:y.value.from?y.value.from(n,r):n:i[r.name]=y.value.from?y.value.from(n,r):n;eN.forEachFn?eN.forEachFn(y.row.from?y.row.from(i):i,P):P[en++]=y.row.from?y.row.from(i):i}:100===s?function(e){ex&&(ex.push(e.subarray(5))||I.pause())}:65===s?function(e){if(!_)return;let t=9;for(;0!==e[t++];);_(e.toString("utf8",9,t-1),e.toString("utf8",t,e.length-1))}:83===s?function(e){let[r,n]=e.toString("utf8",5,e.length-1).split(et.N);q[r]=n,t.parameters[r]!==n&&(t.parameters[r]=n,w&&w(r,n))}:90===s?function(r){if(eN&&eN.options.simple&&eN.resolve(e_||P),eN=e_=null,P=new H,$.cancel(),ew){if(k){var s;if(!q.in_hot_standby||!q.default_transaction_read_only)return function(){let e=new u([`
      show transaction_read_only;
      select pg_catalog.pg_is_in_recovery()
    `],[],eI,null,{simple:!0});e.resolve=([[e],[t]])=>{q.default_transaction_read_only=e.transaction_read_only,q.in_hot_standby=t.pg_is_in_recovery?"on":"off"},e.execute()}();if(s=q,"read-write"===k&&"on"===s.default_transaction_read_only||"read-only"===k&&"off"===s.default_transaction_read_only||"primary"===k&&"on"===s.in_hot_standby||"standby"===k&&"off"===s.in_hot_standby||"prefer-standby"===k&&"off"===s.in_hot_standby&&t.host[V])return eJ()}return M?(!0===ew&&(ew=null),e6()):(!0!==ew&&eI(ew),t.shared.retries=V=0,void(ew=null))}for(;E.length&&(eN=E.shift())&&(eN.active=!0,eN.cancelled);)e(t).cancel(eN.state,eN.cancelled.resolve,eN.cancelled.reject);eN||(eO.reserved?eO.reserved.release||73!==r[5]?eO.reserved():eS?eJ():(eO.reserved=null,n(eO)):eS?eJ():n(eO))}:67===s?function(e){en=0;for(let t=e.length-1;t>0;t--)if(32===e[t]&&e[t+1]<58&&null===P.count&&(P.count=+e.toString("utf8",t+1,e.length-1)),e[t-1]>=65){P.command=e.toString("utf8",5,t),P.state=A;break}return(eA&&(eA(),eA=null),"BEGIN"!==P.command||1===o||eO.reserved)?eN.options.simple?eG():void(eN.cursorFn&&(P.count&&eN.cursorFn(P),ez(ei)),eN.resolve(P)):eB(d.generic("UNSAFE_TRANSACTION","Only use sql.begin, sql.reserved or max: 1"))}:50===s?eG:49===s?function(){eN.parsing=!1}:116===s?function(e){let t=e.readUInt16BE(5);for(let r=0;r<t;++r)eN.statement.types[r]||(eN.statement.types[r]=e.readUInt32BE(7+4*r));eN.prepare&&(L[eN.signature]=eN.statement),eN.describeFirst&&!eN.onlyDescribe&&(ez(eP(eN)),eN.describeFirst=!1)}:84===s?function(e){let t;P.command&&((e_=e_||[P]).push(P=new H),P.count=null,eN.statement.columns=null);let r=e.readUInt16BE(5),n=7;eN.statement.columns=Array(r);for(let s=0;s<r;++s){for(t=n;0!==e[n++];);let r=e.readUInt32BE(n),i=e.readUInt16BE(n+4),a=e.readUInt32BE(n+6);eN.statement.columns[s]={name:y.column.from?y.column.from(e.toString("utf8",t,n-1)):e.toString("utf8",t,n-1),parser:h[a],table:r,number:i,type:a},n+=18}if(P.statement=eN.statement,eN.onlyDescribe)return eN.resolve(eN.statement),ez(ei)}:82===s?eW:110===s?function(){if(P.statement=eN.statement,P.statement.columns=[],eN.onlyDescribe)return eN.resolve(eN.statement),ez(ei)}:75===s?function(e){A.pid=e.readUInt32BE(5),A.secret=e.readUInt32BE(9)}:69===s?function(e){var t;eN&&(eN.cursorFn||eN.describeFirst)&&ez(ei);let r=d.postgres(em(e));eN&&eN.retried?eB(eN.retried):eN&&eN.prepared&&ed.has(r.routine)?(t=eN,delete L[t.signature],t.retried=r,eI(t)):eB(r)}:115===s?e2:51===s?function(){P.count&&eN.cursorFn(P),eN.resolve(P)}:71===s?function(){ex=new W.Writable({autoDestroy:!0,write(e,t,r){I.write(et().d().raw(e).end(),r)},destroy(e,t){t(e),I.write(et().f().str(e+et.N).end()),ex=null},final(e){I.write(et().c().end()),eA=e}}),eN.resolve(ex)}:78===s?function(e){b?b(em(e)):console.log(em(e))}:72===s?function(){ex=new W.Readable({read(){I.resume()}}),eN.resolve(ex)}:99===s?function(){ex&&ex.push(null),ex=null}:73===s?function(){}:86===s?function(){eB(d.notSupported("FunctionCallResponse"))}:118===s?function(){eB(d.notSupported("NegotiateProtocolVersion"))}:87===s?function(){ex=new W.Duplex({autoDestroy:!0,read(){I.resume()},write(e,t,r){I.write(et().d().raw(e).end(),r)},destroy(e,t){t(e),I.write(et().f().str(e+et.N).end()),ex=null},final(e){I.write(et().c().end()),eA=e}}),eN.resolve(ex)}:function(e){console.error("Postgres.js : Unknown Message:",e[0])})(r)})(R.subarray(0,ee+1))}catch(e){eN&&(eN.cursorFn||eN.describeFirst)&&ez(ei),eB(e)}R=R.subarray(ee+1),B=0,eb=null}}async function eL(){if(ev=!1,q={},I||(I=await ej()),I){if($.start(),t.socket)return a?eR():eU();if(I.on("connect",a?eR:eU),t.path)return I.connect(t.path);I.ssl=a,I.connect(m[F],p[F]),I.host=p[F],I.port=m[F],F=(F+1)%m.length}}function eQ(){setTimeout(eL,Z?Z+er-Y.performance.now():0)}function eU(){try{L={},M=t.fetch_types,Q=Math.random().toString(36).slice(2),U=1,j.start(),I.on("data",eq),x&&I.setKeepAlive&&I.setKeepAlive(!0,1e3*x);let e=C||et().inc(4).i16(3).z(2).str(Object.entries(Object.assign({user:c,database:f,client_encoding:"UTF8"},t.connection)).filter(([,e])=>e).map(([e,t])=>e+et.N+t).join(et.N)).z(2).end(0);ez(e)}catch(e){eZ(e)}}function eZ(e){if(eO.queue!==r.connecting||!t.host[V+1])for(eB(e);E.length;)eF(E.shift(),e)}function eB(e){ex&&(ex.destroy(e),ex=null),eN&&eF(eN,e),ew&&(eF(ew,e),ew=null)}function eF(e,r){Object.defineProperties(r,{stack:{value:r.stack+e.origin.replace(/.*\n/,"\n"),enumerable:t.debug},query:{value:e.string,enumerable:t.debug},parameters:{value:e.parameters,enumerable:t.debug},args:{value:e.args,enumerable:t.debug},types:{value:e.statement&&e.statement.types,enumerable:t.debug}}),e.reject(r)}function eV(){return eS||(eO.reserved||s(eO),eO.reserved||ew||eN||0!==E.length?eS=new Promise(e=>ek=e):(eJ(),new Promise(e=>I&&"closed"!==I.readyState?I.once("close",e):e())))}function eJ(){ev=!0,(ex||eN||ew||E.length)&&eZ(d.connection("CONNECTION_DESTROYED",t)),clearImmediate(ey),I&&(I.removeListener("data",eq),I.removeListener("connect",eU),"open"===I.readyState&&I.end(et().X().end())),ek&&(ek(),eS=ek=null)}async function eK(e){if(R=Buffer.alloc(0),B=0,eb=null,clearImmediate(ey),I.removeListener("data",eq),I.removeListener("connect",eU),O.cancel(),j.cancel(),$.cancel(),I.removeAllListeners(),I=null,ew)return eQ();!e&&(eN||E.length)&&eZ(d.connection("CONNECTION_CLOSED",t,I)),Z=Y.performance.now(),e&&t.shared.retries++,er=("function"==typeof T?T(t.shared.retries):T)*1e3,i(eO,d.connection("CONNECTION_CLOSED",t,I))}function eG(){P.statement||(P.statement=eN.statement),P.columns=eN.statement.columns}async function eW(e,t=e.readUInt32BE(5)){(3===t?eY:5===t?eH:10===t?eX:11===t?e0:12===t?function(e){e.toString("utf8",9).split(et.N,1)[0].slice(2)!==ep&&(eB(d.generic("SASL_SIGNATURE_MISMATCH","The server did not return the correct signature")),I.destroy())}:0!==t?function(e,t){console.error("Postgres.js : Unknown Auth:",t)}:ec)(e,t)}async function eY(){let e=await e1();ez(et().p().str(e).z(1).end())}async function eH(e){let t="md5"+await ef(Buffer.concat([Buffer.from(await ef(await e1()+c)),e.subarray(9)]));ez(et().p().str(t).z(1).end())}async function eX(){eE=(await G.randomBytes(18)).toString("base64"),et().p().str("SCRAM-SHA-256"+et.N);let e=et.i;ez(et.inc(4).str("n,,n=*,r="+eE).i32(et.i-e-4,e).end())}async function e0(e){let t=e.toString("utf8",9).split(",").reduce((e,t)=>(e[t[0]]=t.slice(2),e),{}),r=await G.pbkdf2Sync(await e1(),Buffer.from(t.s,"base64"),parseInt(t.i),32,"sha256"),n=await eh(r,"Client Key"),s="n=*,r="+eE+",r="+t.r+",s="+t.s+",i="+t.i+",c=biws,r="+t.r;ep=(await eh(await eh(r,"Server Key"),s)).toString("base64");let i="c=biws,r="+t.r+",p="+(function(e,t){let r=Math.max(e.length,t.length),n=Buffer.allocUnsafe(r);for(let s=0;s<r;s++)n[s]=e[s]^t[s];return n})(n,Buffer.from(await eh(await G.createHash("sha256").update(n).digest(),s))).toString("base64");ez(et().p().str(i).end())}function e1(){return Promise.resolve("function"==typeof t.pass?t.pass():t.pass)}async function e6(){M=!1,(await new u([`
      select b.oid, b.typarray
      from pg_catalog.pg_type a
      left join pg_catalog.pg_type b on b.oid = a.typelem
      where a.typcategory = 'A'
      group by b.oid, b.typarray
      order by b.oid
    `],[],eI)).forEach(({oid:e,typarray:r})=>(function(e,r){if(t.parsers[r]&&t.serializers[r])return;let n=t.parsers[e];t.shared.typeArrayMap[e]=r,t.parsers[r]=e=>(D.i=D.last=0,function e(t,r,n,s){let i=[],a=1020===s?";":",";for(;t.i<r.length;t.i++){if(t.char=r[t.i],t.quoted)"\\"===t.char?t.str+=r[++t.i]:'"'===t.char?(i.push(n?n(t.str):t.str),t.str="",t.quoted='"'===r[t.i+1],t.last=t.i+2):t.str+=t.char;else if('"'===t.char)t.quoted=!0;else if("{"===t.char)t.last=++t.i,i.push(e(t,r,n,s));else if("}"===t.char){t.quoted=!1,t.last<t.i&&i.push(n?n(r.slice(t.last,t.i)):r.slice(t.last,t.i)),t.last=t.i+1;break}else t.char===a&&"}"!==t.p&&'"'!==t.p&&(i.push(n?n(r.slice(t.last,t.i)):r.slice(t.last,t.i)),t.last=t.i+1);t.p=t.char}return t.last<t.i&&i.push(n?n(r.slice(t.last,t.i+1)):r.slice(t.last,t.i+1)),i}(D,e,n,r)),t.parsers[r].array=!0,t.serializers[r]=n=>z(n,t.serializers[e],t,r)})(e,r))}async function e2(){try{let e=await Promise.resolve(eN.cursorFn(P));en=0,e===l?ez(function(e=""){return Buffer.concat([et().C().str("P").str(e+et.N).end(),et().S().end()])}(eN.portal)):(P=new H,ez(e8("",eN.cursorRows)))}catch(e){ez(ei),eN.reject(e)}}function e4(e,t,r,n=""){return et().P().str(n+et.N).str(e+et.N).i16(t.length),t.forEach((e,t)=>et.i32(r[t]||0)),et.end()}function e8(e="",t=0){return Buffer.concat([et().E().str(e+et.N).i32(t).end(),ea])}},es=1,ei=et().S().end(),ea=et().H().end(),eo=et().i32(8).i32(80877103).end(8),el=Buffer.concat([et().E().str(et.N).i32(0).end(),ei]),eu=et().D().str("S").str(et.N).end(),ec=()=>{},ed=new Set(["FetchPreparedStatement","RevalidateCachedQuery","transformAssignedExpr"]),ep={83:"severity_local",86:"severity",67:"code",77:"message",68:"detail",72:"hint",80:"position",112:"internal_position",113:"internal_query",87:"where",115:"schema_name",116:"table_name",99:"column_name",100:"data type_name",110:"constraint_name",70:"file",76:"line",82:"routine"};function em(e){let t={},r=5;for(let n=5;n<e.length-1;n++)0===e[n]&&(t[ep[e[r]]]=e.toString("utf8",r+1,n),r=n+1);return t}function ef(e){return G.createHash("md5").update(e).digest("hex")}function eh(e,t){return G.createHmac("sha256",e).update(t).digest()}function eg(e,t){let r;if(!(t="function"==typeof t?t():t))return{cancel:ec,start:ec};return{cancel(){r&&(clearTimeout(r),r=null)},start(){r&&clearTimeout(r),r=setTimeout(n,1e3*t,arguments)}};function n(t){e.apply(null,t),r=null}}let ey=()=>{};function ev(e,t,r,n){let s,i,a;let o=n.raw?Array(t.length):{};for(let l=0;l<t.length;l++)s=e[r++],i=t[l],a=110===s?null:117===s?void 0:void 0===i.parser?e.toString("utf8",r+4,r+=4+e.readUInt32BE(r)):!0===i.parser.array?i.parser(e.toString("utf8",r+5,r+=4+e.readUInt32BE(r))):i.parser(e.toString("utf8",r+4,r+=4+e.readUInt32BE(r))),n.raw?o[l]=!0===n.raw?a:n.value.from?n.value.from(a,i):a:o[i.name]=n.value.from?n.value.from(a,i):a;return{i:r,row:n.row.from?n.row.from(o):o}}function eb(e,t,r=393216){return new Promise(async(n,s)=>{await e.begin(async e=>{let s;t||([{oid:t}]=await e`select lo_creat(-1) as oid`);let[{fd:i}]=await e`select lo_open(${t}, ${r}) as fd`,a={writable:l,readable:o,close:()=>e`select lo_close(${i})`.then(s),tell:()=>e`select lo_tell64(${i})`,read:t=>e`select loread(${i}, ${t}) as data`,write:t=>e`select lowrite(${i}, ${t})`,truncate:t=>e`select lo_truncate64(${i}, ${t})`,seek:(t,r=0)=>e`select lo_lseek64(${i}, ${t}, ${r})`,size:()=>e`
          select
            lo_lseek64(${i}, location, 0) as position,
            seek.size
          from (
            select
              lo_lseek64($1, 0, 2) as size,
              tell.location
            from (select lo_tell64($1) as location) tell
          ) seek
        `};return n(a),new Promise(async e=>s=e);async function o({highWaterMark:e=16384,start:t=0,end:r=1/0}={}){let n=r-t;return t&&await a.seek(t),new W.Readable({highWaterMark:e,async read(e){let t=e>n?e-n:e;n-=e;let[{data:r}]=await a.read(t);this.push(r),r.length<e&&this.push(null)}})}async function l({highWaterMark:e=16384,start:t=0}={}){return t&&await a.seek(t),new W.Writable({highWaterMark:e,write(e,t,r){a.write(e).then(()=>r(),r)}})}}).catch(s)})}Object.assign(ew,{PostgresError:c,toPascal:M,pascal:F,toCamel:R,camel:B,toKebab:q,kebab:V,fromPascal:Q,fromCamel:L,fromKebab:U,BigInt:{to:20,from:[20],parse:e=>BigInt(e),serialize:e=>e.toString()}});let e_=ew;function ew(e,t){let r=function(e,t){var r;if(e&&e.shared)return e;let s=process.env,i=(e&&"string"!=typeof e?e:t)||{},{url:a,multihost:o}=function(e){if(!e||"string"!=typeof e)return{url:{searchParams:new Map}};let t=e;t=decodeURIComponent((t=t.slice(t.indexOf("://")+3).split(/[?/]/)[0]).slice(t.indexOf("@")+1));let r=new URL(e.replace(t,t.split(",")[0]));return{url:{username:decodeURIComponent(r.username),password:decodeURIComponent(r.password),host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,searchParams:r.searchParams},multihost:t.indexOf(",")>-1&&t}}(e),l=[...a.searchParams].reduce((e,[t,r])=>(e[t]=r,e),{}),u=i.hostname||i.host||o||a.hostname||s.PGHOST||"localhost",c=i.port||a.port||s.PGPORT||5432,d=i.user||i.username||a.username||s.PGUSERNAME||s.PGUSER||function(){try{return n.userInfo().username}catch(e){return process.env.USERNAME||process.env.USER||process.env.LOGNAME}}();i.no_prepare&&(i.prepare=!1),l.sslmode&&(l.ssl=l.sslmode,delete l.sslmode),"timeout"in i&&(console.log("The timeout option is deprecated, use idle_timeout instead"),i.idle_timeout=i.timeout),"system"===l.sslrootcert&&(l.ssl="verify-full");let p=["idle_timeout","connect_timeout","max_lifetime","max_pipeline","backoff","keep_alive"],m={max:10,ssl:!1,idle_timeout:null,connect_timeout:30,max_lifetime:ex,max_pipeline:100,backoff:eS,keep_alive:60,prepare:!0,debug:!1,fetch_types:!0,publications:"alltables",target_session_attrs:null};return{host:Array.isArray(u)?u:u.split(",").map(e=>e.split(":")[0]),port:Array.isArray(c)?c:u.split(",").map(e=>parseInt(e.split(":")[1]||c)),path:i.path||u.indexOf("/")>-1&&u+"/.s.PGSQL."+c,database:i.database||i.db||(a.pathname||"").slice(1)||s.PGDATABASE||d,user:d,pass:i.pass||i.password||a.password||s.PGPASSWORD||"",...Object.entries(m).reduce((e,[t,r])=>{let n=t in i?i[t]:t in l?"disable"!==l[t]&&"false"!==l[t]&&l[t]:s["PG"+t.toUpperCase()]||r;return e[t]="string"==typeof n&&p.includes(t)?+n:n,e},{}),connection:{application_name:"postgres.js",...i.connection,...Object.entries(l).reduce((e,[t,r])=>(t in m||(e[t]=r),e),{})},types:i.types||{},target_session_attrs:function(e,t,r){let n=e.target_session_attrs||t.searchParams.get("target_session_attrs")||r.PGTARGETSESSIONATTRS;if(!n||["read-write","read-only","primary","standby","prefer-standby"].includes(n))return n;throw Error("target_session_attrs "+n+" is not supported")}(i,a,s),onnotice:i.onnotice,onnotify:i.onnotify,onclose:i.onclose,onparameter:i.onparameter,socket:i.socket,transform:{undefined:(r=i.transform||{undefined:void 0}).undefined,column:{from:"function"==typeof r.column?r.column:r.column&&r.column.from,to:r.column&&r.column.to},value:{from:"function"==typeof r.value?r.value:r.value&&r.value.from,to:r.value&&r.value.to},row:{from:"function"==typeof r.row?r.row:r.row&&r.row.from,to:r.row&&r.row.to}},parameters:{},shared:{retries:0,typeArrayMap:{}},...A(i.types)}}(e,t),i=r.no_subscribe||function(e,t){let r=new Map,n="postgresjs_"+Math.random().toString(36).slice(2),s={},i,a,o=!1,l=d.sql=e({...t,transform:{column:{},value:{},row:{}},max:1,fetch_types:!1,idle_timeout:null,max_lifetime:null,connection:{...t.connection,replication:"database"},onclose:async function(){o||(a=null,s.pid=s.secret=void 0,p(await m(l,n,t.publications)),r.forEach(e=>e.forEach(({onsubscribe:e})=>e())))},no_subscribe:!0}),u=l.end,c=l.close;return l.end=async()=>(o=!0,a&&await new Promise(e=>(a.once("close",e),a.end())),u()),l.close=async()=>(a&&await new Promise(e=>(a.once("close",e),a.end())),c()),d;async function d(e,o,u=ey,c=ey){e=function(e){let t=e.match(/^(\*|insert|update|delete)?:?([^.]+?\.?[^=]+)?=?(.+)?/i)||[];if(!t)throw Error("Malformed subscribe pattern: "+e);let[,r,n,s]=t;return(r||"*")+(n?":"+(-1===n.indexOf(".")?"public."+n:n):"")+(s?"="+s:"")}(e),i||(i=m(l,n,t.publications));let d={fn:o,onsubscribe:u},f=r.has(e)?r.get(e).add(d):r.set(e,new Set([d])).get(e),h=()=>{f.delete(d),0===f.size&&r.delete(e)};return i.then(e=>(p(e),u(),a&&a.on("error",c),{unsubscribe:h,state:s,sql:l}))}function p(e){a=e.stream,s.pid=e.state.pid,s.secret=e.state.secret}async function m(e,r,n){if(!n)throw Error("Missing publication names");let s=await e.unsafe(`CREATE_REPLICATION_SLOT ${r} TEMPORARY LOGICAL pgoutput NOEXPORT_SNAPSHOT`),[i]=s,a=await e.unsafe(`START_REPLICATION SLOT ${r} LOGICAL ${i.consistent_point} (proto_version '1', publication_names '${n}')`).writable(),o={lsn:Buffer.concat(i.consistent_point.split("/").map(e=>Buffer.from(("00000000"+e).slice(-8),"hex")))};return a.on("data",function(r){119===r[0]?function(e,t,r,n,s){Object.entries({R:e=>{let n=1,i=t[e.readUInt32BE(n)]={schema:e.toString("utf8",n+=4,n=e.indexOf(0,n))||"pg_catalog",table:e.toString("utf8",n+1,n=e.indexOf(0,n+1)),columns:Array(e.readUInt16BE(n+=2)),keys:[]};n+=2;let a=0,o;for(;n<e.length;)(o=i.columns[a++]={key:e[n++],name:s.column.from?s.column.from(e.toString("utf8",n,n=e.indexOf(0,n))):e.toString("utf8",n,n=e.indexOf(0,n)),type:e.readUInt32BE(n+=1),parser:r[e.readUInt32BE(n)],atttypmod:e.readUInt32BE(n+=4)}).key&&i.keys.push(o),n+=4},Y:()=>{},O:()=>{},B:e=>{var r;t.date=(r=e.readBigInt64BE(9),new Date(Date.UTC(2e3,0,1)+Number(r/BigInt(1e3)))),t.lsn=e.subarray(1,9)},I:e=>{let r=1,i=t[e.readUInt32BE(r)],{row:a}=ev(e,i.columns,r+=7,s);n(a,{command:"insert",relation:i})},D:e=>{let r=1,i=t[e.readUInt32BE(r)],a=75===e[r+=4];n(a||79===e[r]?ev(e,i.columns,r+=3,s).row:null,{command:"delete",relation:i,key:a})},U:e=>{let r=1,i=t[e.readUInt32BE(r)],a=75===e[r+=4],o=a||79===e[r]?ev(e,i.columns,r+=3,s):null;o&&(r=o.i);let{row:l}=ev(e,i.columns,r+3,s);n(l,{command:"update",relation:i,key:a,old:o&&o.row})},T:()=>{},C:()=>{}}).reduce((e,[t,r])=>(e[t.charCodeAt(0)]=r,e),{})[e[0]](e)}(r.subarray(25),o,e.options.parsers,l,t.transform):107===r[0]&&r[17]&&(o.lsn=r.subarray(1,9),function(){let e=Buffer.alloc(34);e[0]=114,e.fill(o.lsn,1),e.writeBigInt64BE(BigInt(Date.now()-Date.UTC(2e3,0,1))*BigInt(1e3),25),a.write(e)}())}),a.on("error",function(e){console.error("Unexpected error during logical streaming - reconnecting",e)}),a.on("close",e.close),{stream:a,state:s.state};function l(e,t){let r=t.relation.schema+"."+t.relation.table;f("*",e,t),f("*:"+r,e,t),t.relation.keys.length&&f("*:"+r+"="+t.relation.keys.map(t=>e[t.name]),e,t),f(t.command,e,t),f(t.command+":"+r,e,t),t.relation.keys.length&&f(t.command+":"+r+"="+t.relation.keys.map(t=>e[t.name]),e,t)}}function f(e,t,n){r.has(e)&&r.get(e).forEach(({fn:r})=>r(t,n,e))}}(ew,{...r}),a=!1,o=X(),p=X(),g=X(),y=X(),v=X(),b=X(),_=X(),w=X(),S={connecting:p,reserved:g,closed:y,ended:v,open:b,busy:_,full:w},x=[...Array(r.max)].map(()=>en(r,S,{onopen:Q,onend:L,onclose:U})),T=k(function(e){return a?e.reject(d.connection("CONNECTION_ENDED",r,r)):b.length?P(b.shift(),e):y.length?q(y.shift(),e):void(_.length?P(_.shift(),e):o.push(e))});return Object.assign(T,{get parameters(){return r.parameters},largeObject:eb.bind(null,T),subscribe:i,CLOSE:l,END:l,PostgresError:c,options:r,reserve:O,listen:E,begin:j,close:R,end:D}),T;function k(e){return e.debug=r.debug,Object.entries(r.types).reduce((e,[t,r])=>(e[t]=e=>new f(e,r.to),e),t),Object.assign(n,{types:t,typed:t,unsafe:function(t,r=[],n={}){return 2!=arguments.length||Array.isArray(r)||(n=r,r=[]),new u([t],r,e,z,{prepare:!1,...n,simple:"simple"in n?n.simple:0===r.length})},notify:N,array:function e(t,n){return Array.isArray(t)?new f(t,n||(t.length?I(t)||25:0),r.shared.typeArrayMap):e(Array.from(arguments))},json:C,file:function(t,r=[],n={}){return 2!=arguments.length||Array.isArray(r)||(n=r,r=[]),new u([],r,r=>{s.readFile(t,"utf8",(t,n)=>{if(t)return r.reject(t);r.strings=[n],e(r)})},z,{...n,simple:"simple"in n?n.simple:0===r.length})}}),n;function t(e,t){return new f(e,t)}function n(t,...s){return t&&Array.isArray(t.raw)?new u(t,s,e,z):"string"!=typeof t||s.length?new h(t,s):new m(r.transform.column.to?r.transform.column.to(t):t)}}async function E(e,t,n){let s={fn:t,onlisten:n},i=E.sql||(E.sql=ew({...r,max:1,idle_timeout:null,max_lifetime:null,fetch_types:!1,onclose(){Object.entries(E.channels).forEach(([e,{listeners:t}])=>{delete E.channels[e],Promise.all(t.map(t=>E(e,t.fn,t.onlisten).catch(()=>{})))})},onnotify(e,t){e in E.channels&&E.channels[e].listeners.forEach(e=>e.fn(t))}})),a=E.channels||(E.channels={});if(e in a){a[e].listeners.push(s);let t=await a[e].result;return s.onlisten&&s.onlisten(),{state:t.state,unlisten:l}}a[e]={result:i`listen ${i.unsafe('"'+e.replace(/"/g,'""')+'"')}`,listeners:[s]};let o=await a[e].result;return s.onlisten&&s.onlisten(),{state:o.state,unlisten:l};async function l(){if(e in a!=!1&&(a[e].listeners=a[e].listeners.filter(e=>e!==s),!a[e].listeners.length))return delete a[e],i`unlisten ${i.unsafe('"'+e.replace(/"/g,'""')+'"')}`}}async function N(e,t){return await T`select pg_notify(${e}, ${""+t})`}async function O(){let e=X(),t=b.length?b.shift():await new Promise(e=>{o.push({reserve:e}),y.length&&q(y.shift())});$(t,g),t.reserved=()=>e.length?t.execute(e.shift()):$(t,g),t.reserved.release=!0;let r=k(function(r){t.queue===w?e.push(r):t.execute(r)||$(t,w)});return r.release=()=>{t.reserved=null,Q(t)},r}async function j(e,t){t||(t=e,e="");let r=X(),n=0,s,i=null;try{return await T.unsafe("begin "+e.replace(/[^a-z ]/ig,""),[],{onexecute:function(e){s=e,$(e,g),e.reserved=()=>r.length?e.execute(r.shift()):$(e,g)}}).execute(),await Promise.race([a(s,t),new Promise((e,t)=>s.onclose=t)])}catch(e){throw e}async function a(e,t,s){let o,l;let u=k(function(t){t.catch(e=>o||(o=e)),e.queue===w?r.push(t):e.execute(t)||$(e,w)});u.savepoint=function t(r,s){return r&&Array.isArray(r.raw)?t(e=>e.apply(e,arguments)):(1==arguments.length&&(s=r,r=null),a(e,s,"s"+n+++(r?"_"+r:"")))},u.prepare=e=>i=e.replace(/[^a-z0-9$-_. ]/gi),s&&await u`savepoint ${u(s)}`;try{if(l=await new Promise((e,r)=>{let n=t(u);Promise.resolve(Array.isArray(n)?Promise.all(n):n).then(e,r)}),o)throw o}catch(e){throw await (s?u`rollback to ${u(s)}`:u`rollback`),e instanceof c&&"25P02"===e.code&&o||e}return s||(i?await u`prepare transaction '${u.unsafe(i)}'`:await u`commit`),l}}function $(e,t){return e.queue.remove(e),t.push(e),e.queue=t,t===b?e.idleTimer.start():e.idleTimer.cancel(),e}function C(e){return new f(e,3802)}function P(e,t){return e.execute(t)?$(e,_):$(e,w)}function z(e){return new Promise((t,n)=>{e.state?e.active?en(r).cancel(e.state,t,n):e.cancelled={resolve:t,reject:n}:(o.remove(e),e.cancelled=!0,e.reject(d.generic("57014","canceling statement due to user request")),t())})}async function D({timeout:e=null}={}){let t;return a||(await 1,a=Promise.race([new Promise(r=>null!==e&&(t=setTimeout(M,1e3*e,r))),Promise.all(x.map(e=>e.end()).concat(E.sql?E.sql.end({timeout:0}):[],i.sql?i.sql.end({timeout:0}):[]))]).then(()=>clearTimeout(t)))}async function R(){await Promise.all(x.map(e=>e.end()))}async function M(e){for(await Promise.all(x.map(e=>e.terminate()));o.length;)o.shift().reject(d.connection("CONNECTION_DESTROYED",r));e()}function q(e,t){return $(e,p),e.connect(t),e}function L(e){$(e,v)}function Q(e){if(0===o.length)return $(e,b);let t=Math.ceil(o.length/(p.length+1)),r=!0;for(;r&&o.length&&t-- >0;){let t=o.shift();if(t.reserve)return t.reserve(e);r=e.execute(t)}r?$(e,_):$(e,w)}function U(e,t){$(e,y),e.reserved=null,e.onclose&&(e.onclose(t),e.onclose=null),r.onclose&&r.onclose(e.id),o.length&&q(e,o.shift())}}function eS(e){return(.5+Math.random()/2)*Math.min(3**e/100,20)}function ex(){return 60*(30+30*Math.random())}},7410:(e,t,r)=>{"use strict";let n;r.d(t,{Ry:()=>eU,pA:()=>tn,z:()=>ts}),function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),n={};for(let e of r)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(e7||(e7={})),(e5||(e5={})).mergeShapes=(e,t)=>({...e,...t});let s=e7.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),i=e=>{switch(typeof e){case"undefined":return s.undefined;case"string":return s.string;case"number":return isNaN(e)?s.nan:s.number;case"boolean":return s.boolean;case"function":return s.function;case"bigint":return s.bigint;case"symbol":return s.symbol;case"object":if(Array.isArray(e))return s.array;if(null===e)return s.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return s.promise;if("undefined"!=typeof Map&&e instanceof Map)return s.map;if("undefined"!=typeof Set&&e instanceof Set)return s.set;if("undefined"!=typeof Date&&e instanceof Date)return s.date;return s.object;default:return s.unknown}},a=e7.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class o extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(let s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(n);else if("invalid_return_type"===s.code)n(s.returnTypeError);else if("invalid_arguments"===s.code)n(s.argumentsError);else if(0===s.path.length)r._errors.push(t(s));else{let e=r,n=0;for(;n<s.path.length;){let r=s.path[n];n===s.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(s))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}static assert(e){if(!(e instanceof o))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,e7.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}o.create=e=>new o(e);let l=(e,t)=>{let r;switch(e.code){case a.invalid_type:r=e.received===s.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case a.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,e7.jsonStringifyReplacer)}`;break;case a.unrecognized_keys:r=`Unrecognized key(s) in object: ${e7.joinValues(e.keys,", ")}`;break;case a.invalid_union:r="Invalid input";break;case a.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${e7.joinValues(e.options)}`;break;case a.invalid_enum_value:r=`Invalid enum value. Expected ${e7.joinValues(e.options)}, received '${e.received}'`;break;case a.invalid_arguments:r="Invalid function arguments";break;case a.invalid_return_type:r="Invalid function return type";break;case a.invalid_date:r="Invalid date";break;case a.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:e7.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case a.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case a.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case a.custom:r="Invalid input";break;case a.invalid_intersection_types:r="Intersection results could not be merged";break;case a.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case a.not_finite:r="Number must be finite";break;default:r=t.defaultError,e7.assertNever(e)}return{message:r}},u=l;function c(){return u}let d=e=>{let{data:t,path:r,errorMaps:n,issueData:s}=e,i=[...r,...s.path||[]],a={...s,path:i};if(void 0!==s.message)return{...s,path:i,message:s.message};let o="";for(let e of n.filter(e=>!!e).slice().reverse())o=e(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function p(e,t){let r=c(),n=d({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===l?void 0:l].filter(e=>!!e)});e.common.issues.push(n)}class m{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let n of t){if("aborted"===n.status)return f;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,n=await e.value;r.push({key:t,value:n})}return m.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let n of t){let{key:t,value:s}=n;if("aborted"===t.status||"aborted"===s.status)return f;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==s.value||n.alwaysSet)&&(r[t.value]=s.value)}return{status:e.value,value:r}}}let f=Object.freeze({status:"aborted"}),h=e=>({status:"dirty",value:e}),g=e=>({status:"valid",value:e}),y=e=>"aborted"===e.status,v=e=>"dirty"===e.status,b=e=>"valid"===e.status,_=e=>"undefined"!=typeof Promise&&e instanceof Promise;function w(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function S(e,t,r,n,s){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r}"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(te||(te={}));class x{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let T=(e,t)=>{if(b(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new o(e.common.issues);return this._error=t,this._error}}};function k(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:s}:{errorMap:(t,s)=>{var i,a;let{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:s.defaultError}:void 0===s.data?{message:null!==(i=null!=o?o:n)&&void 0!==i?i:s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:null!==(a=null!=o?o:r)&&void 0!==a?a:s.defaultError}},description:s}}class E{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return i(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:i(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new m,ctx:{common:e.parent.common,data:e.data,parsedType:i(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(_(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;let n={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:i(e)},s=this._parseSync({data:e,path:n.path,parent:n});return T(n,s)}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:i(e)},n=this._parse({data:e,path:r.path,parent:r});return T(r,await (_(n)?n:Promise.resolve(n)))}refine(e,t){let r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,n)=>{let s=e(t),i=()=>n.addIssue({code:a.custom,...r(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then(e=>!!e||(i(),!1)):!!s||(i(),!1)})}refinement(e,t){return this._refinement((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1))}_refinement(e){return new eg({schema:this,typeName:tn.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ey.create(this,this._def)}nullable(){return ev.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return X.create(this,this._def)}promise(){return eh.create(this,this._def)}or(e){return et.create([this,e],this._def)}and(e){return es.create(this,e,this._def)}transform(e){return new eg({...k(this._def),schema:this,typeName:tn.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new eb({...k(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:tn.ZodDefault})}brand(){return new ex({typeName:tn.ZodBranded,type:this,...k(this._def)})}catch(e){return new e_({...k(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:tn.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return eT.create(this,e)}readonly(){return ek.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let N=/^c[^\s-]{8,}$/i,A=/^[0-9a-z]+$/,O=/^[0-9A-HJKMNP-TV-Z]{26}$/,j=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$=/^[a-z0-9_-]{21}$/i,I=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,C=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,P=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,z=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,D=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,R="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",M=RegExp(`^${R}$`);function q(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function L(e){let t=`${R}T${q(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)}class Q extends E{_parse(e){var t,r;let i;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==s.string){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.string,received:t.parsedType}),f}let o=new m;for(let s of this._def.checks)if("min"===s.kind)e.data.length<s.value&&(p(i=this._getOrReturnCtx(e,i),{code:a.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),o.dirty());else if("max"===s.kind)e.data.length>s.value&&(p(i=this._getOrReturnCtx(e,i),{code:a.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),o.dirty());else if("length"===s.kind){let t=e.data.length>s.value,r=e.data.length<s.value;(t||r)&&(i=this._getOrReturnCtx(e,i),t?p(i,{code:a.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):r&&p(i,{code:a.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),o.dirty())}else if("email"===s.kind)C.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{validation:"email",code:a.invalid_string,message:s.message}),o.dirty());else if("emoji"===s.kind)n||(n=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),n.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{validation:"emoji",code:a.invalid_string,message:s.message}),o.dirty());else if("uuid"===s.kind)j.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{validation:"uuid",code:a.invalid_string,message:s.message}),o.dirty());else if("nanoid"===s.kind)$.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{validation:"nanoid",code:a.invalid_string,message:s.message}),o.dirty());else if("cuid"===s.kind)N.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{validation:"cuid",code:a.invalid_string,message:s.message}),o.dirty());else if("cuid2"===s.kind)A.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{validation:"cuid2",code:a.invalid_string,message:s.message}),o.dirty());else if("ulid"===s.kind)O.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{validation:"ulid",code:a.invalid_string,message:s.message}),o.dirty());else if("url"===s.kind)try{new URL(e.data)}catch(t){p(i=this._getOrReturnCtx(e,i),{validation:"url",code:a.invalid_string,message:s.message}),o.dirty()}else"regex"===s.kind?(s.regex.lastIndex=0,s.regex.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{validation:"regex",code:a.invalid_string,message:s.message}),o.dirty())):"trim"===s.kind?e.data=e.data.trim():"includes"===s.kind?e.data.includes(s.value,s.position)||(p(i=this._getOrReturnCtx(e,i),{code:a.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),o.dirty()):"toLowerCase"===s.kind?e.data=e.data.toLowerCase():"toUpperCase"===s.kind?e.data=e.data.toUpperCase():"startsWith"===s.kind?e.data.startsWith(s.value)||(p(i=this._getOrReturnCtx(e,i),{code:a.invalid_string,validation:{startsWith:s.value},message:s.message}),o.dirty()):"endsWith"===s.kind?e.data.endsWith(s.value)||(p(i=this._getOrReturnCtx(e,i),{code:a.invalid_string,validation:{endsWith:s.value},message:s.message}),o.dirty()):"datetime"===s.kind?L(s).test(e.data)||(p(i=this._getOrReturnCtx(e,i),{code:a.invalid_string,validation:"datetime",message:s.message}),o.dirty()):"date"===s.kind?M.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{code:a.invalid_string,validation:"date",message:s.message}),o.dirty()):"time"===s.kind?RegExp(`^${q(s)}$`).test(e.data)||(p(i=this._getOrReturnCtx(e,i),{code:a.invalid_string,validation:"time",message:s.message}),o.dirty()):"duration"===s.kind?I.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{validation:"duration",code:a.invalid_string,message:s.message}),o.dirty()):"ip"===s.kind?(t=e.data,("v4"===(r=s.version)||!r)&&P.test(t)||("v6"===r||!r)&&z.test(t)||(p(i=this._getOrReturnCtx(e,i),{validation:"ip",code:a.invalid_string,message:s.message}),o.dirty())):"base64"===s.kind?D.test(e.data)||(p(i=this._getOrReturnCtx(e,i),{validation:"base64",code:a.invalid_string,message:s.message}),o.dirty()):e7.assertNever(s);return{status:o.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:a.invalid_string,...te.errToObj(r)})}_addCheck(e){return new Q({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...te.errToObj(e)})}url(e){return this._addCheck({kind:"url",...te.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...te.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...te.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...te.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...te.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...te.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...te.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...te.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...te.errToObj(e)})}datetime(e){var t,r;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(r=null==e?void 0:e.local)&&void 0!==r&&r,...te.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...te.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...te.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...te.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...te.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...te.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...te.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...te.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...te.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...te.errToObj(t)})}nonempty(e){return this.min(1,te.errToObj(e))}trim(){return new Q({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Q({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Q({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Q.create=e=>{var t;return new Q({checks:[],typeName:tn.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...k(e)})};class U extends E{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==s.number){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.number,received:t.parsedType}),f}let r=new m;for(let n of this._def.checks)"int"===n.kind?e7.isInteger(e.data)||(p(t=this._getOrReturnCtx(e,t),{code:a.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(p(t=this._getOrReturnCtx(e,t),{code:a.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(p(t=this._getOrReturnCtx(e,t),{code:a.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"multipleOf"===n.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n;return parseInt(e.toFixed(s).replace(".",""))%parseInt(t.toFixed(s).replace(".",""))/Math.pow(10,s)}(e.data,n.value)&&(p(t=this._getOrReturnCtx(e,t),{code:a.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(p(t=this._getOrReturnCtx(e,t),{code:a.not_finite,message:n.message}),r.dirty()):e7.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,te.toString(t))}gt(e,t){return this.setLimit("min",e,!1,te.toString(t))}lte(e,t){return this.setLimit("max",e,!0,te.toString(t))}lt(e,t){return this.setLimit("max",e,!1,te.toString(t))}setLimit(e,t,r,n){return new U({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:te.toString(n)}]})}_addCheck(e){return new U({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:te.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:te.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:te.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:te.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:te.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:te.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:te.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:te.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:te.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&e7.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}U.create=e=>new U({checks:[],typeName:tn.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...k(e)});class Z extends E{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==s.bigint){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.bigint,received:t.parsedType}),f}let r=new m;for(let n of this._def.checks)"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(p(t=this._getOrReturnCtx(e,t),{code:a.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(p(t=this._getOrReturnCtx(e,t),{code:a.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(p(t=this._getOrReturnCtx(e,t),{code:a.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):e7.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,te.toString(t))}gt(e,t){return this.setLimit("min",e,!1,te.toString(t))}lte(e,t){return this.setLimit("max",e,!0,te.toString(t))}lt(e,t){return this.setLimit("max",e,!1,te.toString(t))}setLimit(e,t,r,n){return new Z({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:te.toString(n)}]})}_addCheck(e){return new Z({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:te.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:te.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:te.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:te.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:te.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Z.create=e=>{var t;return new Z({checks:[],typeName:tn.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...k(e)})};class B extends E{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==s.boolean){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.boolean,received:t.parsedType}),f}return g(e.data)}}B.create=e=>new B({typeName:tn.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...k(e)});class F extends E{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==s.date){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.date,received:t.parsedType}),f}if(isNaN(e.data.getTime()))return p(this._getOrReturnCtx(e),{code:a.invalid_date}),f;let r=new m;for(let n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(p(t=this._getOrReturnCtx(e,t),{code:a.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),r.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(p(t=this._getOrReturnCtx(e,t),{code:a.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),r.dirty()):e7.assertNever(n);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new F({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:te.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:te.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}F.create=e=>new F({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:tn.ZodDate,...k(e)});class V extends E{_parse(e){if(this._getType(e)!==s.symbol){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.symbol,received:t.parsedType}),f}return g(e.data)}}V.create=e=>new V({typeName:tn.ZodSymbol,...k(e)});class J extends E{_parse(e){if(this._getType(e)!==s.undefined){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.undefined,received:t.parsedType}),f}return g(e.data)}}J.create=e=>new J({typeName:tn.ZodUndefined,...k(e)});class K extends E{_parse(e){if(this._getType(e)!==s.null){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.null,received:t.parsedType}),f}return g(e.data)}}K.create=e=>new K({typeName:tn.ZodNull,...k(e)});class G extends E{constructor(){super(...arguments),this._any=!0}_parse(e){return g(e.data)}}G.create=e=>new G({typeName:tn.ZodAny,...k(e)});class W extends E{constructor(){super(...arguments),this._unknown=!0}_parse(e){return g(e.data)}}W.create=e=>new W({typeName:tn.ZodUnknown,...k(e)});class Y extends E{_parse(e){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.never,received:t.parsedType}),f}}Y.create=e=>new Y({typeName:tn.ZodNever,...k(e)});class H extends E{_parse(e){if(this._getType(e)!==s.undefined){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.void,received:t.parsedType}),f}return g(e.data)}}H.create=e=>new H({typeName:tn.ZodVoid,...k(e)});class X extends E{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==s.array)return p(t,{code:a.invalid_type,expected:s.array,received:t.parsedType}),f;if(null!==n.exactLength){let e=t.data.length>n.exactLength.value,s=t.data.length<n.exactLength.value;(e||s)&&(p(t,{code:e?a.too_big:a.too_small,minimum:s?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&(p(t,{code:a.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&(p(t,{code:a.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>n.type._parseAsync(new x(t,e,t.path,r)))).then(e=>m.mergeArray(r,e));let i=[...t.data].map((e,r)=>n.type._parseSync(new x(t,e,t.path,r)));return m.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new X({...this._def,minLength:{value:e,message:te.toString(t)}})}max(e,t){return new X({...this._def,maxLength:{value:e,message:te.toString(t)}})}length(e,t){return new X({...this._def,exactLength:{value:e,message:te.toString(t)}})}nonempty(e){return this.min(1,e)}}X.create=(e,t)=>new X({type:e,minLength:null,maxLength:null,exactLength:null,typeName:tn.ZodArray,...k(t)});class ee extends E{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=e7.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==s.object){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.object,received:t.parsedType}),f}let{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof Y&&"strip"===this._def.unknownKeys))for(let e in r.data)i.includes(e)||o.push(e);let l=[];for(let e of i){let t=n[e],s=r.data[e];l.push({key:{status:"valid",value:e},value:t._parse(new x(r,s,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof Y){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of o)l.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)o.length>0&&(p(r,{code:a.unrecognized_keys,keys:o}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of o){let n=r.data[t];l.push({key:{status:"valid",value:t},value:e._parse(new x(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of l){let r=await t.key,n=await t.value;e.push({key:r,value:n,alwaysSet:t.alwaysSet})}return e}).then(e=>m.mergeObjectSync(t,e)):m.mergeObjectSync(t,l)}get shape(){return this._def.shape()}strict(e){return te.errToObj,new ee({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var n,s,i,a;let o=null!==(i=null===(s=(n=this._def).errorMap)||void 0===s?void 0:s.call(n,t,r).message)&&void 0!==i?i:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(a=te.errToObj(e).message)&&void 0!==a?a:o}:{message:o}}}:{}})}strip(){return new ee({...this._def,unknownKeys:"strip"})}passthrough(){return new ee({...this._def,unknownKeys:"passthrough"})}extend(e){return new ee({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ee({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:tn.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ee({...this._def,catchall:e})}pick(e){let t={};return e7.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new ee({...this._def,shape:()=>t})}omit(e){let t={};return e7.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new ee({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof ee){let r={};for(let n in t.shape){let s=t.shape[n];r[n]=ey.create(e(s))}return new ee({...t._def,shape:()=>r})}return t instanceof X?new X({...t._def,type:e(t.element)}):t instanceof ey?ey.create(e(t.unwrap())):t instanceof ev?ev.create(e(t.unwrap())):t instanceof ei?ei.create(t.items.map(t=>e(t))):t}(this)}partial(e){let t={};return e7.objectKeys(this.shape).forEach(r=>{let n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()}),new ee({...this._def,shape:()=>t})}required(e){let t={};return e7.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof ey;)e=e._def.innerType;t[r]=e}}),new ee({...this._def,shape:()=>t})}keyof(){return ep(e7.objectKeys(this.shape))}}ee.create=(e,t)=>new ee({shape:()=>e,unknownKeys:"strip",catchall:Y.create(),typeName:tn.ZodObject,...k(t)}),ee.strictCreate=(e,t)=>new ee({shape:()=>e,unknownKeys:"strict",catchall:Y.create(),typeName:tn.ZodObject,...k(t)}),ee.lazycreate=(e,t)=>new ee({shape:e,unknownKeys:"strip",catchall:Y.create(),typeName:tn.ZodObject,...k(t)});class et extends E{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new o(e.ctx.common.issues));return p(t,{code:a.invalid_union,unionErrors:r}),f});{let e;let n=[];for(let s of r){let r={...t,common:{...t.common,issues:[]},parent:null},i=s._parseSync({data:t.data,path:t.path,parent:r});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let s=n.map(e=>new o(e));return p(t,{code:a.invalid_union,unionErrors:s}),f}}get options(){return this._def.options}}et.create=(e,t)=>new et({options:e,typeName:tn.ZodUnion,...k(t)});let er=e=>{if(e instanceof ec)return er(e.schema);if(e instanceof eg)return er(e.innerType());if(e instanceof ed)return[e.value];if(e instanceof em)return e.options;if(e instanceof ef)return e7.objectValues(e.enum);if(e instanceof eb)return er(e._def.innerType);if(e instanceof J)return[void 0];else if(e instanceof K)return[null];else if(e instanceof ey)return[void 0,...er(e.unwrap())];else if(e instanceof ev)return[null,...er(e.unwrap())];else if(e instanceof ex)return er(e.unwrap());else if(e instanceof ek)return er(e.unwrap());else if(e instanceof e_)return er(e._def.innerType);else return[]};class en extends E{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.object)return p(t,{code:a.invalid_type,expected:s.object,received:t.parsedType}),f;let r=this.discriminator,n=t.data[r],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(p(t,{code:a.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),f)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let n=new Map;for(let r of t){let t=er(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let s of t){if(n.has(s))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);n.set(s,r)}}return new en({typeName:tn.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...k(r)})}}class es extends E{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if(y(e)||y(n))return f;let o=function e(t,r){let n=i(t),a=i(r);if(t===r)return{valid:!0,data:t};if(n===s.object&&a===s.object){let n=e7.objectKeys(r),s=e7.objectKeys(t).filter(e=>-1!==n.indexOf(e)),i={...t,...r};for(let n of s){let s=e(t[n],r[n]);if(!s.valid)return{valid:!1};i[n]=s.data}return{valid:!0,data:i}}if(n===s.array&&a===s.array){if(t.length!==r.length)return{valid:!1};let n=[];for(let s=0;s<t.length;s++){let i=e(t[s],r[s]);if(!i.valid)return{valid:!1};n.push(i.data)}return{valid:!0,data:n}}return n===s.date&&a===s.date&&+t==+r?{valid:!0,data:t}:{valid:!1}}(e.value,n.value);return o.valid?((v(e)||v(n))&&t.dirty(),{status:t.value,value:o.data}):(p(r,{code:a.invalid_intersection_types}),f)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>n(e,t)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}es.create=(e,t,r)=>new es({left:e,right:t,typeName:tn.ZodIntersection,...k(r)});class ei extends E{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==s.array)return p(r,{code:a.invalid_type,expected:s.array,received:r.parsedType}),f;if(r.data.length<this._def.items.length)return p(r,{code:a.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),f;!this._def.rest&&r.data.length>this._def.items.length&&(p(r,{code:a.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let n=[...r.data].map((e,t)=>{let n=this._def.items[t]||this._def.rest;return n?n._parse(new x(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(n).then(e=>m.mergeArray(t,e)):m.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new ei({...this._def,rest:e})}}ei.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new ei({items:e,typeName:tn.ZodTuple,rest:null,...k(t)})};class ea extends E{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==s.object)return p(r,{code:a.invalid_type,expected:s.object,received:r.parsedType}),f;let n=[],i=this._def.keyType,o=this._def.valueType;for(let e in r.data)n.push({key:i._parse(new x(r,e,r.path,e)),value:o._parse(new x(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?m.mergeObjectAsync(t,n):m.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return new ea(t instanceof E?{keyType:e,valueType:t,typeName:tn.ZodRecord,...k(r)}:{keyType:Q.create(),valueType:e,typeName:tn.ZodRecord,...k(t)})}}class eo extends E{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==s.map)return p(r,{code:a.invalid_type,expected:s.map,received:r.parsedType}),f;let n=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([e,t],s)=>({key:n._parse(new x(r,e,r.path,[s,"key"])),value:i._parse(new x(r,t,r.path,[s,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of o){let n=await r.key,s=await r.value;if("aborted"===n.status||"aborted"===s.status)return f;("dirty"===n.status||"dirty"===s.status)&&t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of o){let n=r.key,s=r.value;if("aborted"===n.status||"aborted"===s.status)return f;("dirty"===n.status||"dirty"===s.status)&&t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}}}}eo.create=(e,t,r)=>new eo({valueType:t,keyType:e,typeName:tn.ZodMap,...k(r)});class el extends E{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==s.set)return p(r,{code:a.invalid_type,expected:s.set,received:r.parsedType}),f;let n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(p(r,{code:a.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(p(r,{code:a.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());let i=this._def.valueType;function o(e){let r=new Set;for(let n of e){if("aborted"===n.status)return f;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}let l=[...r.data.values()].map((e,t)=>i._parse(new x(r,e,r.path,t)));return r.common.async?Promise.all(l).then(e=>o(e)):o(l)}min(e,t){return new el({...this._def,minSize:{value:e,message:te.toString(t)}})}max(e,t){return new el({...this._def,maxSize:{value:e,message:te.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}el.create=(e,t)=>new el({valueType:e,minSize:null,maxSize:null,typeName:tn.ZodSet,...k(t)});class eu extends E{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.function)return p(t,{code:a.invalid_type,expected:s.function,received:t.parsedType}),f;function r(e,r){return d({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,c(),l].filter(e=>!!e),issueData:{code:a.invalid_arguments,argumentsError:r}})}function n(e,r){return d({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,c(),l].filter(e=>!!e),issueData:{code:a.invalid_return_type,returnTypeError:r}})}let i={errorMap:t.common.contextualErrorMap},u=t.data;if(this._def.returns instanceof eh){let e=this;return g(async function(...t){let s=new o([]),a=await e._def.args.parseAsync(t,i).catch(e=>{throw s.addIssue(r(t,e)),s}),l=await Reflect.apply(u,this,a);return await e._def.returns._def.type.parseAsync(l,i).catch(e=>{throw s.addIssue(n(l,e)),s})})}{let e=this;return g(function(...t){let s=e._def.args.safeParse(t,i);if(!s.success)throw new o([r(t,s.error)]);let a=Reflect.apply(u,this,s.data),l=e._def.returns.safeParse(a,i);if(!l.success)throw new o([n(a,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new eu({...this._def,args:ei.create(e).rest(W.create())})}returns(e){return new eu({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new eu({args:e||ei.create([]).rest(W.create()),returns:t||W.create(),typeName:tn.ZodFunction,...k(r)})}}class ec extends E{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ec.create=(e,t)=>new ec({getter:e,typeName:tn.ZodLazy,...k(t)});class ed extends E{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return p(t,{received:t.data,code:a.invalid_literal,expected:this._def.value}),f}return{status:"valid",value:e.data}}get value(){return this._def.value}}function ep(e,t){return new em({values:e,typeName:tn.ZodEnum,...k(t)})}ed.create=(e,t)=>new ed({value:e,typeName:tn.ZodLiteral,...k(t)});class em extends E{constructor(){super(...arguments),tt.set(this,void 0)}_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return p(t,{expected:e7.joinValues(r),received:t.parsedType,code:a.invalid_type}),f}if(w(this,tt,"f")||S(this,tt,new Set(this._def.values),"f"),!w(this,tt,"f").has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return p(t,{received:t.data,code:a.invalid_enum_value,options:r}),f}return g(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return em.create(e,{...this._def,...t})}exclude(e,t=this._def){return em.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}tt=new WeakMap,em.create=ep;class ef extends E{constructor(){super(...arguments),tr.set(this,void 0)}_parse(e){let t=e7.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==s.string&&r.parsedType!==s.number){let e=e7.objectValues(t);return p(r,{expected:e7.joinValues(e),received:r.parsedType,code:a.invalid_type}),f}if(w(this,tr,"f")||S(this,tr,new Set(e7.getValidEnumValues(this._def.values)),"f"),!w(this,tr,"f").has(e.data)){let e=e7.objectValues(t);return p(r,{received:r.data,code:a.invalid_enum_value,options:e}),f}return g(e.data)}get enum(){return this._def.values}}tr=new WeakMap,ef.create=(e,t)=>new ef({values:e,typeName:tn.ZodNativeEnum,...k(t)});class eh extends E{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==s.promise&&!1===t.common.async?(p(t,{code:a.invalid_type,expected:s.promise,received:t.parsedType}),f):g((t.parsedType===s.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}eh.create=(e,t)=>new eh({type:e,typeName:tn.ZodPromise,...k(t)});class eg extends E{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===tn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,s={addIssue:e=>{p(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===n.type){let e=n.transform(r.data,s);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return f;let n=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===n.status?f:"dirty"===n.status||"dirty"===t.value?h(n.value):n});{if("aborted"===t.value)return f;let n=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===n.status?f:"dirty"===n.status||"dirty"===t.value?h(n.value):n}}if("refinement"===n.type){let e=e=>{let t=n.refinement(e,s);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?f:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?f:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}}if("transform"===n.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>b(e)?Promise.resolve(n.transform(e.value,s)).then(e=>({status:t.value,value:e})):e);{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!b(e))return e;let i=n.transform(e.value,s);if(i instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}}e7.assertNever(n)}}eg.create=(e,t,r)=>new eg({schema:e,typeName:tn.ZodEffects,effect:t,...k(r)}),eg.createWithPreprocess=(e,t,r)=>new eg({schema:t,effect:{type:"preprocess",transform:e},typeName:tn.ZodEffects,...k(r)});class ey extends E{_parse(e){return this._getType(e)===s.undefined?g(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ey.create=(e,t)=>new ey({innerType:e,typeName:tn.ZodOptional,...k(t)});class ev extends E{_parse(e){return this._getType(e)===s.null?g(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ev.create=(e,t)=>new ev({innerType:e,typeName:tn.ZodNullable,...k(t)});class eb extends E{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===s.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}eb.create=(e,t)=>new eb({innerType:e,typeName:tn.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...k(t)});class e_ extends E{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return _(n)?n.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new o(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new o(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}e_.create=(e,t)=>new e_({innerType:e,typeName:tn.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...k(t)});class ew extends E{_parse(e){if(this._getType(e)!==s.nan){let t=this._getOrReturnCtx(e);return p(t,{code:a.invalid_type,expected:s.nan,received:t.parsedType}),f}return{status:"valid",value:e.data}}}ew.create=e=>new ew({typeName:tn.ZodNaN,...k(e)});let eS=Symbol("zod_brand");class ex extends E{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class eT extends E{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?f:"dirty"===e.status?(t.dirty(),h(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?f:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new eT({in:e,out:t,typeName:tn.ZodPipeline})}}class ek extends E{_parse(e){let t=this._def.innerType._parse(e),r=e=>(b(e)&&(e.value=Object.freeze(e.value)),e);return _(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}function eE(e,t={},r){return e?G.create().superRefine((n,s)=>{var i,a;if(!e(n)){let e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,o=null===(a=null!==(i=e.fatal)&&void 0!==i?i:r)||void 0===a||a;s.addIssue({code:"custom",..."string"==typeof e?{message:e}:e,fatal:o})}}):G.create()}ek.create=(e,t)=>new ek({innerType:e,typeName:tn.ZodReadonly,...k(t)});let eN={object:ee.lazycreate};!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(tn||(tn={}));let eA=Q.create,eO=U.create,ej=ew.create,e$=Z.create,eI=B.create,eC=F.create,eP=V.create,ez=J.create,eD=K.create,eR=G.create,eM=W.create,eq=Y.create,eL=H.create,eQ=X.create,eU=ee.create,eZ=ee.strictCreate,eB=et.create,eF=en.create,eV=es.create,eJ=ei.create,eK=ea.create,eG=eo.create,eW=el.create,eY=eu.create,eH=ec.create,eX=ed.create,e0=em.create,e1=ef.create,e6=eh.create,e2=eg.create,e4=ey.create,e8=ev.create,e3=eg.createWithPreprocess,e9=eT.create;var e7,e5,te,tt,tr,tn,ts=Object.freeze({__proto__:null,defaultErrorMap:l,setErrorMap:function(e){u=e},getErrorMap:c,makeIssue:d,EMPTY_PATH:[],addIssueToContext:p,ParseStatus:m,INVALID:f,DIRTY:h,OK:g,isAborted:y,isDirty:v,isValid:b,isAsync:_,get util(){return e7},get objectUtil(){return e5},ZodParsedType:s,getParsedType:i,ZodType:E,datetimeRegex:L,ZodString:Q,ZodNumber:U,ZodBigInt:Z,ZodBoolean:B,ZodDate:F,ZodSymbol:V,ZodUndefined:J,ZodNull:K,ZodAny:G,ZodUnknown:W,ZodNever:Y,ZodVoid:H,ZodArray:X,ZodObject:ee,ZodUnion:et,ZodDiscriminatedUnion:en,ZodIntersection:es,ZodTuple:ei,ZodRecord:ea,ZodMap:eo,ZodSet:el,ZodFunction:eu,ZodLazy:ec,ZodLiteral:ed,ZodEnum:em,ZodNativeEnum:ef,ZodPromise:eh,ZodEffects:eg,ZodTransformer:eg,ZodOptional:ey,ZodNullable:ev,ZodDefault:eb,ZodCatch:e_,ZodNaN:ew,BRAND:eS,ZodBranded:ex,ZodPipeline:eT,ZodReadonly:ek,custom:eE,Schema:E,ZodSchema:E,late:eN,get ZodFirstPartyTypeKind(){return tn},coerce:{string:e=>Q.create({...e,coerce:!0}),number:e=>U.create({...e,coerce:!0}),boolean:e=>B.create({...e,coerce:!0}),bigint:e=>Z.create({...e,coerce:!0}),date:e=>F.create({...e,coerce:!0})},any:eR,array:eQ,bigint:e$,boolean:eI,date:eC,discriminatedUnion:eF,effect:e2,enum:e0,function:eY,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>eE(t=>t instanceof e,t),intersection:eV,lazy:eH,literal:eX,map:eG,nan:ej,nativeEnum:e1,never:eq,null:eD,nullable:e8,number:eO,object:eU,oboolean:()=>eI().optional(),onumber:()=>eO().optional(),optional:e4,ostring:()=>eA().optional(),pipeline:e9,preprocess:e3,promise:e6,record:eK,set:eW,strictObject:eZ,string:eA,symbol:eP,transformer:e2,tuple:eJ,undefined:ez,union:eB,unknown:eM,void:eL,NEVER:f,ZodIssueCode:a,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:o})},1564:e=>{"use strict";e.exports=JSON.parse('{"name":"dotenv","version":"16.4.5","description":"Loads environment variables from .env file","main":"lib/main.js","types":"lib/main.d.ts","exports":{".":{"types":"./lib/main.d.ts","require":"./lib/main.js","default":"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},"scripts":{"dts-check":"tsc --project tests/types/tsconfig.json","lint":"standard","lint-readme":"standard-markdown","pretest":"npm run lint && npm run dts-check","test":"tap tests/*.js --100 -Rspec","test:coverage":"tap --coverage-report=lcov","prerelease":"npm test","release":"standard-version"},"repository":{"type":"git","url":"git://github.com/motdotla/dotenv.git"},"funding":"https://dotenvx.com","keywords":["dotenv","env",".env","environment","variables","config","settings"],"readmeFilename":"README.md","license":"BSD-2-Clause","devDependencies":{"@definitelytyped/dtslint":"^0.0.133","@types/node":"^18.11.3","decache":"^4.6.1","sinon":"^14.0.1","standard":"^17.0.0","standard-markdown":"^7.1.0","standard-version":"^9.5.0","tap":"^16.3.0","tar":"^6.1.11","typescript":"^4.8.4"},"engines":{"node":">=12"},"browser":{"fs":false}}')}};